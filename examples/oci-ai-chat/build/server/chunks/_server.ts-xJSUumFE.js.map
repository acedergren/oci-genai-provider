{"version":3,"file":"_server.ts-xJSUumFE.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/sessions/_id_/continue/_server.ts.js"],"sourcesContent":["import { error, json } from \"@sveltejs/kit\";\nimport { g as getRepository } from \"../../../../../../chunks/db.js\";\nimport { a as switchToSession } from \"../../../../../../chunks/session.js\";\nconst POST = async ({ params, cookies }) => {\n  const success = switchToSession(cookies, params.id);\n  if (!success) {\n    throw error(404, \"Session not found\");\n  }\n  const repository = getRepository();\n  const session = repository.getSession(params.id);\n  const turns = repository.getSessionTurns(params.id);\n  const messages = turns.flatMap((turn) => {\n    const msgs = [];\n    if (turn.userMessage) {\n      msgs.push({ role: turn.userMessage.role, content: turn.userMessage.content });\n    }\n    if (turn.assistantResponse) {\n      msgs.push({ role: turn.assistantResponse.role, content: turn.assistantResponse.content });\n    }\n    return msgs;\n  });\n  const usage = turns.reduce(\n    (acc, turn) => ({\n      tokens: acc.tokens + (turn.tokensUsed || 0),\n      cost: acc.cost + (turn.costUsd || 0)\n    }),\n    { tokens: 0, cost: 0 }\n  );\n  return json({ session, messages, usage });\n};\nexport {\n  POST\n};\n"],"names":[],"mappings":";;;;;;;;;;AAGK,MAAC,IAAI,GAAG,OAAO,EAAE,MAAM,EAAE,OAAO,EAAE,KAAK;AAC5C,EAAE,MAAM,OAAO,GAAG,eAAe,CAAC,OAAO,EAAE,MAAM,CAAC,EAAE,CAAC;AACrD,EAAE,IAAI,CAAC,OAAO,EAAE;AAChB,IAAI,MAAM,KAAK,CAAC,GAAG,EAAE,mBAAmB,CAAC;AACzC,EAAE;AACF,EAAE,MAAM,UAAU,GAAG,aAAa,EAAE;AACpC,EAAE,MAAM,OAAO,GAAG,UAAU,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE,CAAC;AAClD,EAAE,MAAM,KAAK,GAAG,UAAU,CAAC,eAAe,CAAC,MAAM,CAAC,EAAE,CAAC;AACrD,EAAE,MAAM,QAAQ,GAAG,KAAK,CAAC,OAAO,CAAC,CAAC,IAAI,KAAK;AAC3C,IAAI,MAAM,IAAI,GAAG,EAAE;AACnB,IAAI,IAAI,IAAI,CAAC,WAAW,EAAE;AAC1B,MAAM,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,OAAO,EAAE,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC;AACnF,IAAI;AACJ,IAAI,IAAI,IAAI,CAAC,iBAAiB,EAAE;AAChC,MAAM,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,iBAAiB,CAAC,IAAI,EAAE,OAAO,EAAE,IAAI,CAAC,iBAAiB,CAAC,OAAO,EAAE,CAAC;AAC/F,IAAI;AACJ,IAAI,OAAO,IAAI;AACf,EAAE,CAAC,CAAC;AACJ,EAAE,MAAM,KAAK,GAAG,KAAK,CAAC,MAAM;AAC5B,IAAI,CAAC,GAAG,EAAE,IAAI,MAAM;AACpB,MAAM,MAAM,EAAE,GAAG,CAAC,MAAM,IAAI,IAAI,CAAC,UAAU,IAAI,CAAC,CAAC;AACjD,MAAM,IAAI,EAAE,GAAG,CAAC,IAAI,IAAI,IAAI,CAAC,OAAO,IAAI,CAAC;AACzC,KAAK,CAAC;AACN,IAAI,EAAE,MAAM,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC;AACxB,GAAG;AACH,EAAE,OAAO,IAAI,CAAC,EAAE,OAAO,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC;AAC3C;;;;"}