{"version":3,"sources":["../../../node_modules/.pnpm/ws@8.19.0/node_modules/ws/lib/constants.js","../../../node_modules/.pnpm/ws@8.19.0/node_modules/ws/lib/buffer-util.js","../../../node_modules/.pnpm/ws@8.19.0/node_modules/ws/lib/limiter.js","../../../node_modules/.pnpm/ws@8.19.0/node_modules/ws/lib/permessage-deflate.js","../../../node_modules/.pnpm/ws@8.19.0/node_modules/ws/lib/validation.js","../../../node_modules/.pnpm/ws@8.19.0/node_modules/ws/lib/receiver.js","../../../node_modules/.pnpm/ws@8.19.0/node_modules/ws/lib/sender.js","../../../node_modules/.pnpm/ws@8.19.0/node_modules/ws/lib/event-target.js","../../../node_modules/.pnpm/ws@8.19.0/node_modules/ws/lib/extension.js","../../../node_modules/.pnpm/ws@8.19.0/node_modules/ws/lib/websocket.js","../../../node_modules/.pnpm/ws@8.19.0/node_modules/ws/lib/stream.js","../../../node_modules/.pnpm/ws@8.19.0/node_modules/ws/lib/subprotocol.js","../../../node_modules/.pnpm/ws@8.19.0/node_modules/ws/lib/websocket-server.js","../../../node_modules/.pnpm/ws@8.19.0/node_modules/ws/wrapper.mjs","../src/language-models/registry.ts","../src/language-models/converters/messages.ts","../src/language-models/converters/cohere-messages.ts","../src/language-models/converters/tools.ts","../src/shared/streaming/sse-parser.ts","../src/auth/index.ts","../src/shared/errors/index.ts","../src/shared/utils/retry.ts","../src/shared/utils/timeout.ts","../src/shared/schemas/provider-options.ts","../src/shared/schemas/provider-settings.ts","../src/shared/provider-options.ts","../src/shared/request-options.ts","../src/shared/oci-sdk-types.ts","../src/language-models/OCILanguageModel.ts","../src/embedding-models/registry.ts","../src/embedding-models/OCIEmbeddingModel.ts","../src/speech-models/registry.ts","../src/speech-models/OCISpeechModel.ts","../src/reranking-models/registry.ts","../src/reranking-models/OCIRerankingModel.ts","../src/transcription-models/registry.ts","../src/shared/storage/object-storage.ts","../src/transcription-models/OCITranscriptionModel.ts","../src/realtime/WebSocketAdapter.ts","../src/realtime/types.ts","../src/realtime/OCIRealtimeClient.ts","../src/realtime/OCIRealtimeTranscription.ts","../src/provider.ts","../src/index.ts"],"names":["exports","data","Receiver","Sender","URL","WebSocket","key","createWebSocketStream","err","protocol","WebSocketServer","createParser","common","AISDKError","InvalidResponseDataError","APICallError","z","ServingModeSchema","AISDKInvalidArgumentError","NoSuchModelError","GenerativeAiInferenceClient","Region","TooManyEmbeddingValuesForCallError","AIServiceSpeechClient","models","InvalidArgumentError","ObjectStorageClient","common2"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAA,iBAAA,GAAA,UAAA,CAAA;AAAA,EAAA,qEAAA,CAAAA,SAAA,EAAA,MAAA,EAAA;AAEA,IAAA,IAAM,YAAA,GAAe,CAAC,YAAA,EAAc,aAAA,EAAe,WAAW,CAAA;AAC9D,IAAA,IAAM,OAAA,GAAU,OAAO,IAAA,KAAS,WAAA;AAEhC,IAAA,IAAI,OAAA,EAAS,YAAA,CAAa,IAAA,CAAK,MAAM,CAAA;AAErC,IAAA,MAAA,CAAO,OAAA,GAAU;AAAA,MACf,YAAA;AAAA,MACA,aAAA,EAAe,GAAA;AAAA,MACf,YAAA,EAAc,MAAA,CAAO,KAAA,CAAM,CAAC,CAAA;AAAA,MAC5B,IAAA,EAAM,sCAAA;AAAA,MACN,OAAA;AAAA,MACA,oBAAA,yBAA6B,wBAAwB,CAAA;AAAA,MACrD,SAAA,yBAAkB,WAAW,CAAA;AAAA,MAC7B,WAAA,yBAAoB,aAAa,CAAA;AAAA,MACjC,UAAA,yBAAmB,WAAW,CAAA;AAAA,MAC9B,MAAM,MAAM;AAAA,MAAC;AAAA,KACf;AAAA,EAAA;AAAA,CAAA,CAAA;;;AClBA,IAAA,mBAAA,GAAA,UAAA,CAAA;AAAA,EAAA,uEAAA,CAAAA,SAAA,EAAA,MAAA,EAAA;AAEA,IAAA,IAAM,EAAE,cAAa,GAAI,iBAAA,EAAA;AAEzB,IAAA,IAAM,UAAA,GAAa,MAAA,CAAO,MAAA,CAAO,OAAO,CAAA;AAUxC,IAAA,SAAS,MAAA,CAAO,MAAM,WAAA,EAAa;AACjC,MAAA,IAAI,IAAA,CAAK,MAAA,KAAW,CAAA,EAAG,OAAO,YAAA;AAC9B,MAAA,IAAI,IAAA,CAAK,MAAA,KAAW,CAAA,EAAG,OAAO,KAAK,CAAC,CAAA;AAEpC,MAAA,MAAM,MAAA,GAAS,MAAA,CAAO,WAAA,CAAY,WAAW,CAAA;AAC7C,MAAA,IAAI,MAAA,GAAS,CAAA;AAEb,MAAA,KAAA,IAAS,CAAA,GAAI,CAAA,EAAG,CAAA,GAAI,IAAA,CAAK,QAAQ,CAAA,EAAA,EAAK;AACpC,QAAA,MAAM,GAAA,GAAM,KAAK,CAAC,CAAA;AAClB,QAAA,MAAA,CAAO,GAAA,CAAI,KAAK,MAAM,CAAA;AACtB,QAAA,MAAA,IAAU,GAAA,CAAI,MAAA;AAAA,MAChB;AAEA,MAAA,IAAI,SAAS,WAAA,EAAa;AACxB,QAAA,OAAO,IAAI,UAAA,CAAW,MAAA,CAAO,MAAA,EAAQ,MAAA,CAAO,YAAY,MAAM,CAAA;AAAA,MAChE;AAEA,MAAA,OAAO,MAAA;AAAA,IACT;AAYA,IAAA,SAAS,KAAA,CAAM,MAAA,EAAQ,IAAA,EAAM,MAAA,EAAQ,QAAQ,MAAA,EAAQ;AACnD,MAAA,KAAA,IAAS,CAAA,GAAI,CAAA,EAAG,CAAA,GAAI,MAAA,EAAQ,CAAA,EAAA,EAAK;AAC/B,QAAA,MAAA,CAAO,MAAA,GAAS,CAAC,CAAA,GAAI,MAAA,CAAO,CAAC,CAAA,GAAI,IAAA,CAAK,IAAI,CAAC,CAAA;AAAA,MAC7C;AAAA,IACF;AASA,IAAA,SAAS,OAAA,CAAQ,QAAQ,IAAA,EAAM;AAC7B,MAAA,KAAA,IAAS,CAAA,GAAI,CAAA,EAAG,CAAA,GAAI,MAAA,CAAO,QAAQ,CAAA,EAAA,EAAK;AACtC,QAAA,MAAA,CAAO,CAAC,CAAA,IAAK,IAAA,CAAK,CAAA,GAAI,CAAC,CAAA;AAAA,MACzB;AAAA,IACF;AASA,IAAA,SAAS,cAAc,GAAA,EAAK;AAC1B,MAAA,IAAI,GAAA,CAAI,MAAA,KAAW,GAAA,CAAI,MAAA,CAAO,UAAA,EAAY;AACxC,QAAA,OAAO,GAAA,CAAI,MAAA;AAAA,MACb;AAEA,MAAA,OAAO,GAAA,CAAI,OAAO,KAAA,CAAM,GAAA,CAAI,YAAY,GAAA,CAAI,UAAA,GAAa,IAAI,MAAM,CAAA;AAAA,IACrE;AAUA,IAAA,SAAS,SAAS,IAAA,EAAM;AACtB,MAAA,QAAA,CAAS,QAAA,GAAW,IAAA;AAEpB,MAAA,IAAI,MAAA,CAAO,QAAA,CAAS,IAAI,CAAA,EAAG,OAAO,IAAA;AAElC,MAAA,IAAI,GAAA;AAEJ,MAAA,IAAI,gBAAgB,WAAA,EAAa;AAC/B,QAAA,GAAA,GAAM,IAAI,WAAW,IAAI,CAAA;AAAA,MAC3B,CAAA,MAAA,IAAW,WAAA,CAAY,MAAA,CAAO,IAAI,CAAA,EAAG;AACnC,QAAA,GAAA,GAAM,IAAI,UAAA,CAAW,IAAA,CAAK,QAAQ,IAAA,CAAK,UAAA,EAAY,KAAK,UAAU,CAAA;AAAA,MACpE,CAAA,MAAO;AACL,QAAA,GAAA,GAAM,MAAA,CAAO,KAAK,IAAI,CAAA;AACtB,QAAA,QAAA,CAAS,QAAA,GAAW,KAAA;AAAA,MACtB;AAEA,MAAA,OAAO,GAAA;AAAA,IACT;AAEA,IAAA,MAAA,CAAO,OAAA,GAAU;AAAA,MACf,MAAA;AAAA,MACA,IAAA,EAAM,KAAA;AAAA,MACN,aAAA;AAAA,MACA,QAAA;AAAA,MACA,MAAA,EAAQ;AAAA,KACV;AAGA,IAAA,IAAI,CAAC,OAAA,CAAQ,GAAA,CAAI,iBAAA,EAAmB;AAClC,MAAA,IAAI;AACF,QAAA,MAAM,UAAA,GAAa,UAAQ,YAAY,CAAA;AAEvC,QAAA,MAAA,CAAO,QAAQ,IAAA,GAAO,SAAU,QAAQ,IAAA,EAAM,MAAA,EAAQ,QAAQ,MAAA,EAAQ;AACpE,UAAA,IAAI,SAAS,EAAA,EAAI,KAAA,CAAM,QAAQ,IAAA,EAAM,MAAA,EAAQ,QAAQ,MAAM,CAAA;AAAA,0BAC3C,IAAA,CAAK,MAAA,EAAQ,IAAA,EAAM,MAAA,EAAQ,QAAQ,MAAM,CAAA;AAAA,QAC3D,CAAA;AAEA,QAAA,MAAA,CAAO,OAAA,CAAQ,MAAA,GAAS,SAAU,MAAA,EAAQ,IAAA,EAAM;AAC9C,UAAA,IAAI,MAAA,CAAO,MAAA,GAAS,EAAA,EAAI,OAAA,CAAQ,QAAQ,IAAI,CAAA;AAAA,eACvC,UAAA,CAAW,MAAA,CAAO,MAAA,EAAQ,IAAI,CAAA;AAAA,QACrC,CAAA;AAAA,MACF,SAAS,CAAA,EAAG;AAAA,MAEZ;AAAA,IACF;AAAA,EAAA;AAAA,CAAA,CAAA;;;AClIA,IAAA,eAAA,GAAA,UAAA,CAAA;AAAA,EAAA,mEAAA,CAAAA,SAAA,EAAA,MAAA,EAAA;AAEA,IAAA,IAAM,KAAA,0BAAe,OAAO,CAAA;AAC5B,IAAA,IAAM,IAAA,0BAAc,MAAM,CAAA;AAM1B,IAAA,IAAM,UAAN,MAAc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAOZ,YAAY,WAAA,EAAa;AACvB,QAAA,IAAA,CAAK,KAAK,IAAI,MAAM;AAClB,UAAA,IAAA,CAAK,OAAA,EAAA;AACL,UAAA,IAAA,CAAK,IAAI,CAAA,EAAE;AAAA,QACb,CAAA;AACA,QAAA,IAAA,CAAK,cAAc,WAAA,IAAe,QAAA;AAClC,QAAA,IAAA,CAAK,OAAO,EAAC;AACb,QAAA,IAAA,CAAK,OAAA,GAAU,CAAA;AAAA,MACjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAQA,IAAI,GAAA,EAAK;AACP,QAAA,IAAA,CAAK,IAAA,CAAK,KAAK,GAAG,CAAA;AAClB,QAAA,IAAA,CAAK,IAAI,CAAA,EAAE;AAAA,MACb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAOA,CAAC,IAAI,CAAA,GAAI;AACP,QAAA,IAAI,IAAA,CAAK,OAAA,KAAY,IAAA,CAAK,WAAA,EAAa;AAEvC,QAAA,IAAI,IAAA,CAAK,KAAK,MAAA,EAAQ;AACpB,UAAA,MAAM,GAAA,GAAM,IAAA,CAAK,IAAA,CAAK,KAAA,EAAM;AAE5B,UAAA,IAAA,CAAK,OAAA,EAAA;AACL,UAAA,GAAA,CAAI,IAAA,CAAK,KAAK,CAAC,CAAA;AAAA,QACjB;AAAA,MACF;AAAA,KACF;AAEA,IAAA,MAAA,CAAO,OAAA,GAAU,OAAA;AAAA,EAAA;AAAA,CAAA,CAAA;;;ACtDjB,IAAA,0BAAA,GAAA,UAAA,CAAA;AAAA,EAAA,8EAAA,CAAAA,SAAA,EAAA,MAAA,EAAA;AAEA,IAAA,IAAM,IAAA,GAAO,UAAQ,MAAM,CAAA;AAE3B,IAAA,IAAM,UAAA,GAAa,mBAAA,EAAA;AACnB,IAAA,IAAM,OAAA,GAAU,eAAA,EAAA;AAChB,IAAA,IAAM,EAAE,aAAY,GAAI,iBAAA,EAAA;AAExB,IAAA,IAAM,UAAA,GAAa,MAAA,CAAO,MAAA,CAAO,OAAO,CAAA;AACxC,IAAA,IAAM,OAAA,GAAU,OAAO,IAAA,CAAK,CAAC,GAAM,CAAA,EAAM,GAAA,EAAM,GAAI,CAAC,CAAA;AACpD,IAAA,IAAM,kBAAA,0BAA4B,oBAAoB,CAAA;AACtD,IAAA,IAAM,YAAA,0BAAsB,cAAc,CAAA;AAC1C,IAAA,IAAM,SAAA,0BAAmB,UAAU,CAAA;AACnC,IAAA,IAAM,QAAA,0BAAkB,SAAS,CAAA;AACjC,IAAA,IAAM,MAAA,0BAAgB,OAAO,CAAA;AAS7B,IAAA,IAAI,WAAA;AAKJ,IAAA,IAAM,oBAAN,MAAwB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAyBtB,WAAA,CAAY,OAAA,EAAS,QAAA,EAAU,UAAA,EAAY;AACzC,QAAA,IAAA,CAAK,cAAc,UAAA,GAAa,CAAA;AAChC,QAAA,IAAA,CAAK,QAAA,GAAW,WAAW,EAAC;AAC5B,QAAA,IAAA,CAAK,aACH,IAAA,CAAK,QAAA,CAAS,cAAc,MAAA,GAAY,IAAA,CAAK,SAAS,SAAA,GAAY,IAAA;AACpE,QAAA,IAAA,CAAK,SAAA,GAAY,CAAC,CAAC,QAAA;AACnB,QAAA,IAAA,CAAK,QAAA,GAAW,IAAA;AAChB,QAAA,IAAA,CAAK,QAAA,GAAW,IAAA;AAEhB,QAAA,IAAA,CAAK,MAAA,GAAS,IAAA;AAEd,QAAA,IAAI,CAAC,WAAA,EAAa;AAChB,UAAA,MAAM,cACJ,IAAA,CAAK,QAAA,CAAS,qBAAqB,MAAA,GAC/B,IAAA,CAAK,SAAS,gBAAA,GACd,EAAA;AACN,UAAA,WAAA,GAAc,IAAI,QAAQ,WAAW,CAAA;AAAA,QACvC;AAAA,MACF;AAAA;AAAA;AAAA;AAAA,MAKA,WAAW,aAAA,GAAgB;AACzB,QAAA,OAAO,oBAAA;AAAA,MACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAQA,KAAA,GAAQ;AACN,QAAA,MAAM,SAAS,EAAC;AAEhB,QAAA,IAAI,IAAA,CAAK,SAAS,uBAAA,EAAyB;AACzC,UAAA,MAAA,CAAO,0BAAA,GAA6B,IAAA;AAAA,QACtC;AACA,QAAA,IAAI,IAAA,CAAK,SAAS,uBAAA,EAAyB;AACzC,UAAA,MAAA,CAAO,0BAAA,GAA6B,IAAA;AAAA,QACtC;AACA,QAAA,IAAI,IAAA,CAAK,SAAS,mBAAA,EAAqB;AACrC,UAAA,MAAA,CAAO,sBAAA,GAAyB,KAAK,QAAA,CAAS,mBAAA;AAAA,QAChD;AACA,QAAA,IAAI,IAAA,CAAK,SAAS,mBAAA,EAAqB;AACrC,UAAA,MAAA,CAAO,sBAAA,GAAyB,KAAK,QAAA,CAAS,mBAAA;AAAA,QAChD,CAAA,MAAA,IAAW,IAAA,CAAK,QAAA,CAAS,mBAAA,IAAuB,IAAA,EAAM;AACpD,UAAA,MAAA,CAAO,sBAAA,GAAyB,IAAA;AAAA,QAClC;AAEA,QAAA,OAAO,MAAA;AAAA,MACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASA,OAAO,cAAA,EAAgB;AACrB,QAAA,cAAA,GAAiB,IAAA,CAAK,gBAAgB,cAAc,CAAA;AAEpD,QAAA,IAAA,CAAK,MAAA,GAAS,KAAK,SAAA,GACf,IAAA,CAAK,eAAe,cAAc,CAAA,GAClC,IAAA,CAAK,cAAA,CAAe,cAAc,CAAA;AAEtC,QAAA,OAAO,IAAA,CAAK,MAAA;AAAA,MACd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAOA,OAAA,GAAU;AACR,QAAA,IAAI,KAAK,QAAA,EAAU;AACjB,UAAA,IAAA,CAAK,SAAS,KAAA,EAAM;AACpB,UAAA,IAAA,CAAK,QAAA,GAAW,IAAA;AAAA,QAClB;AAEA,QAAA,IAAI,KAAK,QAAA,EAAU;AACjB,UAAA,MAAM,QAAA,GAAW,IAAA,CAAK,QAAA,CAAS,SAAS,CAAA;AAExC,UAAA,IAAA,CAAK,SAAS,KAAA,EAAM;AACpB,UAAA,IAAA,CAAK,QAAA,GAAW,IAAA;AAEhB,UAAA,IAAI,QAAA,EAAU;AACZ,YAAA,QAAA;AAAA,cACE,IAAI,KAAA;AAAA,gBACF;AAAA;AACF,aACF;AAAA,UACF;AAAA,QACF;AAAA,MACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASA,eAAe,MAAA,EAAQ;AACrB,QAAA,MAAM,OAAO,IAAA,CAAK,QAAA;AAClB,QAAA,MAAM,QAAA,GAAW,MAAA,CAAO,IAAA,CAAK,CAAC,MAAA,KAAW;AACvC,UAAA,IACG,IAAA,CAAK,uBAAA,KAA4B,KAAA,IAChC,MAAA,CAAO,0BAAA,IACR,OAAO,sBAAA,KACL,IAAA,CAAK,mBAAA,KAAwB,KAAA,IAC3B,OAAO,IAAA,CAAK,wBAAwB,QAAA,IACnC,IAAA,CAAK,mBAAA,GAAsB,MAAA,CAAO,sBAAA,CAAA,IACvC,OAAO,KAAK,mBAAA,KAAwB,QAAA,IACnC,CAAC,MAAA,CAAO,sBAAA,EACV;AACA,YAAA,OAAO,KAAA;AAAA,UACT;AAEA,UAAA,OAAO,IAAA;AAAA,QACT,CAAC,CAAA;AAED,QAAA,IAAI,CAAC,QAAA,EAAU;AACb,UAAA,MAAM,IAAI,MAAM,8CAA8C,CAAA;AAAA,QAChE;AAEA,QAAA,IAAI,KAAK,uBAAA,EAAyB;AAChC,UAAA,QAAA,CAAS,0BAAA,GAA6B,IAAA;AAAA,QACxC;AACA,QAAA,IAAI,KAAK,uBAAA,EAAyB;AAChC,UAAA,QAAA,CAAS,0BAAA,GAA6B,IAAA;AAAA,QACxC;AACA,QAAA,IAAI,OAAO,IAAA,CAAK,mBAAA,KAAwB,QAAA,EAAU;AAChD,UAAA,QAAA,CAAS,yBAAyB,IAAA,CAAK,mBAAA;AAAA,QACzC;AACA,QAAA,IAAI,OAAO,IAAA,CAAK,mBAAA,KAAwB,QAAA,EAAU;AAChD,UAAA,QAAA,CAAS,yBAAyB,IAAA,CAAK,mBAAA;AAAA,QACzC,WACE,QAAA,CAAS,sBAAA,KAA2B,IAAA,IACpC,IAAA,CAAK,wBAAwB,KAAA,EAC7B;AACA,UAAA,OAAO,QAAA,CAAS,sBAAA;AAAA,QAClB;AAEA,QAAA,OAAO,QAAA;AAAA,MACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASA,eAAe,QAAA,EAAU;AACvB,QAAA,MAAM,MAAA,GAAS,SAAS,CAAC,CAAA;AAEzB,QAAA,IACE,IAAA,CAAK,QAAA,CAAS,uBAAA,KAA4B,KAAA,IAC1C,OAAO,0BAAA,EACP;AACA,UAAA,MAAM,IAAI,MAAM,mDAAmD,CAAA;AAAA,QACrE;AAEA,QAAA,IAAI,CAAC,OAAO,sBAAA,EAAwB;AAClC,UAAA,IAAI,OAAO,IAAA,CAAK,QAAA,CAAS,mBAAA,KAAwB,QAAA,EAAU;AACzD,YAAA,MAAA,CAAO,sBAAA,GAAyB,KAAK,QAAA,CAAS,mBAAA;AAAA,UAChD;AAAA,QACF,CAAA,MAAA,IACE,IAAA,CAAK,QAAA,CAAS,mBAAA,KAAwB,SACrC,OAAO,IAAA,CAAK,QAAA,CAAS,mBAAA,KAAwB,QAAA,IAC5C,MAAA,CAAO,sBAAA,GAAyB,IAAA,CAAK,SAAS,mBAAA,EAChD;AACA,UAAA,MAAM,IAAI,KAAA;AAAA,YACR;AAAA,WACF;AAAA,QACF;AAEA,QAAA,OAAO,MAAA;AAAA,MACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASA,gBAAgB,cAAA,EAAgB;AAC9B,QAAA,cAAA,CAAe,OAAA,CAAQ,CAAC,MAAA,KAAW;AACjC,UAAA,MAAA,CAAO,IAAA,CAAK,MAAM,CAAA,CAAE,OAAA,CAAQ,CAAC,GAAA,KAAQ;AACnC,YAAA,IAAI,KAAA,GAAQ,OAAO,GAAG,CAAA;AAEtB,YAAA,IAAI,KAAA,CAAM,SAAS,CAAA,EAAG;AACpB,cAAA,MAAM,IAAI,KAAA,CAAM,CAAA,WAAA,EAAc,GAAG,CAAA,+BAAA,CAAiC,CAAA;AAAA,YACpE;AAEA,YAAA,KAAA,GAAQ,MAAM,CAAC,CAAA;AAEf,YAAA,IAAI,QAAQ,wBAAA,EAA0B;AACpC,cAAA,IAAI,UAAU,IAAA,EAAM;AAClB,gBAAA,MAAM,MAAM,CAAC,KAAA;AACb,gBAAA,IAAI,CAAC,OAAO,SAAA,CAAU,GAAG,KAAK,GAAA,GAAM,CAAA,IAAK,MAAM,EAAA,EAAI;AACjD,kBAAA,MAAM,IAAI,SAAA;AAAA,oBACR,CAAA,6BAAA,EAAgC,GAAG,CAAA,GAAA,EAAM,KAAK,CAAA;AAAA,mBAChD;AAAA,gBACF;AACA,gBAAA,KAAA,GAAQ,GAAA;AAAA,cACV,CAAA,MAAA,IAAW,CAAC,IAAA,CAAK,SAAA,EAAW;AAC1B,gBAAA,MAAM,IAAI,SAAA;AAAA,kBACR,CAAA,6BAAA,EAAgC,GAAG,CAAA,GAAA,EAAM,KAAK,CAAA;AAAA,iBAChD;AAAA,cACF;AAAA,YACF,CAAA,MAAA,IAAW,QAAQ,wBAAA,EAA0B;AAC3C,cAAA,MAAM,MAAM,CAAC,KAAA;AACb,cAAA,IAAI,CAAC,OAAO,SAAA,CAAU,GAAG,KAAK,GAAA,GAAM,CAAA,IAAK,MAAM,EAAA,EAAI;AACjD,gBAAA,MAAM,IAAI,SAAA;AAAA,kBACR,CAAA,6BAAA,EAAgC,GAAG,CAAA,GAAA,EAAM,KAAK,CAAA;AAAA,iBAChD;AAAA,cACF;AACA,cAAA,KAAA,GAAQ,GAAA;AAAA,YACV,CAAA,MAAA,IACE,GAAA,KAAQ,4BAAA,IACR,GAAA,KAAQ,4BAAA,EACR;AACA,cAAA,IAAI,UAAU,IAAA,EAAM;AAClB,gBAAA,MAAM,IAAI,SAAA;AAAA,kBACR,CAAA,6BAAA,EAAgC,GAAG,CAAA,GAAA,EAAM,KAAK,CAAA;AAAA,iBAChD;AAAA,cACF;AAAA,YACF,CAAA,MAAO;AACL,cAAA,MAAM,IAAI,KAAA,CAAM,CAAA,mBAAA,EAAsB,GAAG,CAAA,CAAA,CAAG,CAAA;AAAA,YAC9C;AAEA,YAAA,MAAA,CAAO,GAAG,CAAA,GAAI,KAAA;AAAA,UAChB,CAAC,CAAA;AAAA,QACH,CAAC,CAAA;AAED,QAAA,OAAO,cAAA;AAAA,MACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAUA,UAAA,CAAW,IAAA,EAAM,GAAA,EAAK,QAAA,EAAU;AAC9B,QAAA,WAAA,CAAY,GAAA,CAAI,CAAC,IAAA,KAAS;AACxB,UAAA,IAAA,CAAK,WAAA,CAAY,IAAA,EAAM,GAAA,EAAK,CAAC,KAAK,MAAA,KAAW;AAC3C,YAAA,IAAA,EAAK;AACL,YAAA,QAAA,CAAS,KAAK,MAAM,CAAA;AAAA,UACtB,CAAC,CAAA;AAAA,QACH,CAAC,CAAA;AAAA,MACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAUA,QAAA,CAAS,IAAA,EAAM,GAAA,EAAK,QAAA,EAAU;AAC5B,QAAA,WAAA,CAAY,GAAA,CAAI,CAAC,IAAA,KAAS;AACxB,UAAA,IAAA,CAAK,SAAA,CAAU,IAAA,EAAM,GAAA,EAAK,CAAC,KAAK,MAAA,KAAW;AACzC,YAAA,IAAA,EAAK;AACL,YAAA,QAAA,CAAS,KAAK,MAAM,CAAA;AAAA,UACtB,CAAC,CAAA;AAAA,QACH,CAAC,CAAA;AAAA,MACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAUA,WAAA,CAAY,IAAA,EAAM,GAAA,EAAK,QAAA,EAAU;AAC/B,QAAA,MAAM,QAAA,GAAW,IAAA,CAAK,SAAA,GAAY,QAAA,GAAW,QAAA;AAE7C,QAAA,IAAI,CAAC,KAAK,QAAA,EAAU;AAClB,UAAA,MAAM,GAAA,GAAM,GAAG,QAAQ,CAAA,gBAAA,CAAA;AACvB,UAAA,MAAM,UAAA,GACJ,OAAO,IAAA,CAAK,MAAA,CAAO,GAAG,CAAA,KAAM,QAAA,GACxB,IAAA,CAAK,oBAAA,GACL,IAAA,CAAK,MAAA,CAAO,GAAG,CAAA;AAErB,UAAA,IAAA,CAAK,QAAA,GAAW,KAAK,gBAAA,CAAiB;AAAA,YACpC,GAAG,KAAK,QAAA,CAAS,kBAAA;AAAA,YACjB;AAAA,WACD,CAAA;AACD,UAAA,IAAA,CAAK,QAAA,CAAS,kBAAkB,CAAA,GAAI,IAAA;AACpC,UAAA,IAAA,CAAK,QAAA,CAAS,YAAY,CAAA,GAAI,CAAA;AAC9B,UAAA,IAAA,CAAK,QAAA,CAAS,QAAQ,CAAA,GAAI,EAAC;AAC3B,UAAA,IAAA,CAAK,QAAA,CAAS,EAAA,CAAG,OAAA,EAAS,cAAc,CAAA;AACxC,UAAA,IAAA,CAAK,QAAA,CAAS,EAAA,CAAG,MAAA,EAAQ,aAAa,CAAA;AAAA,QACxC;AAEA,QAAA,IAAA,CAAK,QAAA,CAAS,SAAS,CAAA,GAAI,QAAA;AAE3B,QAAA,IAAA,CAAK,QAAA,CAAS,MAAM,IAAI,CAAA;AACxB,QAAA,IAAI,GAAA,EAAK,IAAA,CAAK,QAAA,CAAS,KAAA,CAAM,OAAO,CAAA;AAEpC,QAAA,IAAA,CAAK,QAAA,CAAS,MAAM,MAAM;AACxB,UAAA,MAAM,GAAA,GAAM,IAAA,CAAK,QAAA,CAAS,MAAM,CAAA;AAEhC,UAAA,IAAI,GAAA,EAAK;AACP,YAAA,IAAA,CAAK,SAAS,KAAA,EAAM;AACpB,YAAA,IAAA,CAAK,QAAA,GAAW,IAAA;AAChB,YAAA,QAAA,CAAS,GAAG,CAAA;AACZ,YAAA;AAAA,UACF;AAEA,UAAA,MAAMC,QAAO,UAAA,CAAW,MAAA;AAAA,YACtB,IAAA,CAAK,SAAS,QAAQ,CAAA;AAAA,YACtB,IAAA,CAAK,SAAS,YAAY;AAAA,WAC5B;AAEA,UAAA,IAAI,IAAA,CAAK,QAAA,CAAS,cAAA,CAAe,UAAA,EAAY;AAC3C,YAAA,IAAA,CAAK,SAAS,KAAA,EAAM;AACpB,YAAA,IAAA,CAAK,QAAA,GAAW,IAAA;AAAA,UAClB,CAAA,MAAO;AACL,YAAA,IAAA,CAAK,QAAA,CAAS,YAAY,CAAA,GAAI,CAAA;AAC9B,YAAA,IAAA,CAAK,QAAA,CAAS,QAAQ,CAAA,GAAI,EAAC;AAE3B,YAAA,IAAI,OAAO,IAAA,CAAK,MAAA,CAAO,CAAA,EAAG,QAAQ,sBAAsB,CAAA,EAAG;AACzD,cAAA,IAAA,CAAK,SAAS,KAAA,EAAM;AAAA,YACtB;AAAA,UACF;AAEA,UAAA,QAAA,CAAS,MAAMA,KAAI,CAAA;AAAA,QACrB,CAAC,CAAA;AAAA,MACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAUA,SAAA,CAAU,IAAA,EAAM,GAAA,EAAK,QAAA,EAAU;AAC7B,QAAA,MAAM,QAAA,GAAW,IAAA,CAAK,SAAA,GAAY,QAAA,GAAW,QAAA;AAE7C,QAAA,IAAI,CAAC,KAAK,QAAA,EAAU;AAClB,UAAA,MAAM,GAAA,GAAM,GAAG,QAAQ,CAAA,gBAAA,CAAA;AACvB,UAAA,MAAM,UAAA,GACJ,OAAO,IAAA,CAAK,MAAA,CAAO,GAAG,CAAA,KAAM,QAAA,GACxB,IAAA,CAAK,oBAAA,GACL,IAAA,CAAK,MAAA,CAAO,GAAG,CAAA;AAErB,UAAA,IAAA,CAAK,QAAA,GAAW,KAAK,gBAAA,CAAiB;AAAA,YACpC,GAAG,KAAK,QAAA,CAAS,kBAAA;AAAA,YACjB;AAAA,WACD,CAAA;AAED,UAAA,IAAA,CAAK,QAAA,CAAS,YAAY,CAAA,GAAI,CAAA;AAC9B,UAAA,IAAA,CAAK,QAAA,CAAS,QAAQ,CAAA,GAAI,EAAC;AAE3B,UAAA,IAAA,CAAK,QAAA,CAAS,EAAA,CAAG,MAAA,EAAQ,aAAa,CAAA;AAAA,QACxC;AAEA,QAAA,IAAA,CAAK,QAAA,CAAS,SAAS,CAAA,GAAI,QAAA;AAE3B,QAAA,IAAA,CAAK,QAAA,CAAS,MAAM,IAAI,CAAA;AACxB,QAAA,IAAA,CAAK,QAAA,CAAS,KAAA,CAAM,IAAA,CAAK,YAAA,EAAc,MAAM;AAC3C,UAAA,IAAI,CAAC,KAAK,QAAA,EAAU;AAIlB,YAAA;AAAA,UACF;AAEA,UAAA,IAAIA,QAAO,UAAA,CAAW,MAAA;AAAA,YACpB,IAAA,CAAK,SAAS,QAAQ,CAAA;AAAA,YACtB,IAAA,CAAK,SAAS,YAAY;AAAA,WAC5B;AAEA,UAAA,IAAI,GAAA,EAAK;AACP,YAAAA,KAAAA,GAAO,IAAI,UAAA,CAAWA,KAAAA,CAAK,QAAQA,KAAAA,CAAK,UAAA,EAAYA,KAAAA,CAAK,MAAA,GAAS,CAAC,CAAA;AAAA,UACrE;AAMA,UAAA,IAAA,CAAK,QAAA,CAAS,SAAS,CAAA,GAAI,IAAA;AAE3B,UAAA,IAAA,CAAK,QAAA,CAAS,YAAY,CAAA,GAAI,CAAA;AAC9B,UAAA,IAAA,CAAK,QAAA,CAAS,QAAQ,CAAA,GAAI,EAAC;AAE3B,UAAA,IAAI,OAAO,IAAA,CAAK,MAAA,CAAO,CAAA,EAAG,QAAQ,sBAAsB,CAAA,EAAG;AACzD,YAAA,IAAA,CAAK,SAAS,KAAA,EAAM;AAAA,UACtB;AAEA,UAAA,QAAA,CAAS,MAAMA,KAAI,CAAA;AAAA,QACrB,CAAC,CAAA;AAAA,MACH;AAAA,KACF;AAEA,IAAA,MAAA,CAAO,OAAA,GAAU,iBAAA;AAQjB,IAAA,SAAS,cAAc,KAAA,EAAO;AAC5B,MAAA,IAAA,CAAK,QAAQ,CAAA,CAAE,IAAA,CAAK,KAAK,CAAA;AACzB,MAAA,IAAA,CAAK,YAAY,KAAK,KAAA,CAAM,MAAA;AAAA,IAC9B;AAQA,IAAA,SAAS,cAAc,KAAA,EAAO;AAC5B,MAAA,IAAA,CAAK,YAAY,KAAK,KAAA,CAAM,MAAA;AAE5B,MAAA,IACE,IAAA,CAAK,kBAAkB,CAAA,CAAE,WAAA,GAAc,CAAA,IACvC,IAAA,CAAK,YAAY,CAAA,IAAK,IAAA,CAAK,kBAAkB,CAAA,CAAE,WAAA,EAC/C;AACA,QAAA,IAAA,CAAK,QAAQ,CAAA,CAAE,IAAA,CAAK,KAAK,CAAA;AACzB,QAAA;AAAA,MACF;AAEA,MAAA,IAAA,CAAK,MAAM,CAAA,GAAI,IAAI,UAAA,CAAW,2BAA2B,CAAA;AACzD,MAAA,IAAA,CAAK,MAAM,EAAE,IAAA,GAAO,mCAAA;AACpB,MAAA,IAAA,CAAK,MAAM,CAAA,CAAE,WAAW,CAAA,GAAI,IAAA;AAC5B,MAAA,IAAA,CAAK,cAAA,CAAe,QAAQ,aAAa,CAAA;AASzC,MAAA,IAAA,CAAK,KAAA,EAAM;AAAA,IACb;AAQA,IAAA,SAAS,eAAe,GAAA,EAAK;AAK3B,MAAA,IAAA,CAAK,kBAAkB,EAAE,QAAA,GAAW,IAAA;AAEpC,MAAA,IAAI,IAAA,CAAK,MAAM,CAAA,EAAG;AAChB,QAAA,IAAA,CAAK,SAAS,CAAA,CAAE,IAAA,CAAK,MAAM,CAAC,CAAA;AAC5B,QAAA;AAAA,MACF;AAEA,MAAA,GAAA,CAAI,WAAW,CAAA,GAAI,IAAA;AACnB,MAAA,IAAA,CAAK,SAAS,EAAE,GAAG,CAAA;AAAA,IACrB;AAAA,EAAA;AAAA,CAAA,CAAA;;;AC/gBA,IAAA,kBAAA,GAAA,UAAA,CAAA;AAAA,EAAA,sEAAA,CAAAD,SAAA,EAAA,MAAA,EAAA;AAEA,IAAA,IAAM,EAAE,MAAA,EAAO,GAAI,SAAA,CAAQ,QAAQ,CAAA;AAEnC,IAAA,IAAM,EAAE,SAAQ,GAAI,iBAAA,EAAA;AAcpB,IAAA,IAAM,UAAA,GAAa;AAAA,MACjB,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA;AAAA,MAC7C,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA;AAAA,MAC7C,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA;AAAA,MAC7C,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA;AAAA,MAC7C,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA;AAAA,MAC7C,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,CAAA;AAAA,MAAG,C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","file":"index.js","sourcesContent":["'use strict';\n\nconst BINARY_TYPES = ['nodebuffer', 'arraybuffer', 'fragments'];\nconst hasBlob = typeof Blob !== 'undefined';\n\nif (hasBlob) BINARY_TYPES.push('blob');\n\nmodule.exports = {\n  BINARY_TYPES,\n  CLOSE_TIMEOUT: 30000,\n  EMPTY_BUFFER: Buffer.alloc(0),\n  GUID: '258EAFA5-E914-47DA-95CA-C5AB0DC85B11',\n  hasBlob,\n  kForOnEventAttribute: Symbol('kIsForOnEventAttribute'),\n  kListener: Symbol('kListener'),\n  kStatusCode: Symbol('status-code'),\n  kWebSocket: Symbol('websocket'),\n  NOOP: () => {}\n};\n","'use strict';\n\nconst { EMPTY_BUFFER } = require('./constants');\n\nconst FastBuffer = Buffer[Symbol.species];\n\n/**\n * Merges an array of buffers into a new buffer.\n *\n * @param {Buffer[]} list The array of buffers to concat\n * @param {Number} totalLength The total length of buffers in the list\n * @return {Buffer} The resulting buffer\n * @public\n */\nfunction concat(list, totalLength) {\n  if (list.length === 0) return EMPTY_BUFFER;\n  if (list.length === 1) return list[0];\n\n  const target = Buffer.allocUnsafe(totalLength);\n  let offset = 0;\n\n  for (let i = 0; i < list.length; i++) {\n    const buf = list[i];\n    target.set(buf, offset);\n    offset += buf.length;\n  }\n\n  if (offset < totalLength) {\n    return new FastBuffer(target.buffer, target.byteOffset, offset);\n  }\n\n  return target;\n}\n\n/**\n * Masks a buffer using the given mask.\n *\n * @param {Buffer} source The buffer to mask\n * @param {Buffer} mask The mask to use\n * @param {Buffer} output The buffer where to store the result\n * @param {Number} offset The offset at which to start writing\n * @param {Number} length The number of bytes to mask.\n * @public\n */\nfunction _mask(source, mask, output, offset, length) {\n  for (let i = 0; i < length; i++) {\n    output[offset + i] = source[i] ^ mask[i & 3];\n  }\n}\n\n/**\n * Unmasks a buffer using the given mask.\n *\n * @param {Buffer} buffer The buffer to unmask\n * @param {Buffer} mask The mask to use\n * @public\n */\nfunction _unmask(buffer, mask) {\n  for (let i = 0; i < buffer.length; i++) {\n    buffer[i] ^= mask[i & 3];\n  }\n}\n\n/**\n * Converts a buffer to an `ArrayBuffer`.\n *\n * @param {Buffer} buf The buffer to convert\n * @return {ArrayBuffer} Converted buffer\n * @public\n */\nfunction toArrayBuffer(buf) {\n  if (buf.length === buf.buffer.byteLength) {\n    return buf.buffer;\n  }\n\n  return buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.length);\n}\n\n/**\n * Converts `data` to a `Buffer`.\n *\n * @param {*} data The data to convert\n * @return {Buffer} The buffer\n * @throws {TypeError}\n * @public\n */\nfunction toBuffer(data) {\n  toBuffer.readOnly = true;\n\n  if (Buffer.isBuffer(data)) return data;\n\n  let buf;\n\n  if (data instanceof ArrayBuffer) {\n    buf = new FastBuffer(data);\n  } else if (ArrayBuffer.isView(data)) {\n    buf = new FastBuffer(data.buffer, data.byteOffset, data.byteLength);\n  } else {\n    buf = Buffer.from(data);\n    toBuffer.readOnly = false;\n  }\n\n  return buf;\n}\n\nmodule.exports = {\n  concat,\n  mask: _mask,\n  toArrayBuffer,\n  toBuffer,\n  unmask: _unmask\n};\n\n/* istanbul ignore else  */\nif (!process.env.WS_NO_BUFFER_UTIL) {\n  try {\n    const bufferUtil = require('bufferutil');\n\n    module.exports.mask = function (source, mask, output, offset, length) {\n      if (length < 48) _mask(source, mask, output, offset, length);\n      else bufferUtil.mask(source, mask, output, offset, length);\n    };\n\n    module.exports.unmask = function (buffer, mask) {\n      if (buffer.length < 32) _unmask(buffer, mask);\n      else bufferUtil.unmask(buffer, mask);\n    };\n  } catch (e) {\n    // Continue regardless of the error.\n  }\n}\n","'use strict';\n\nconst kDone = Symbol('kDone');\nconst kRun = Symbol('kRun');\n\n/**\n * A very simple job queue with adjustable concurrency. Adapted from\n * https://github.com/STRML/async-limiter\n */\nclass Limiter {\n  /**\n   * Creates a new `Limiter`.\n   *\n   * @param {Number} [concurrency=Infinity] The maximum number of jobs allowed\n   *     to run concurrently\n   */\n  constructor(concurrency) {\n    this[kDone] = () => {\n      this.pending--;\n      this[kRun]();\n    };\n    this.concurrency = concurrency || Infinity;\n    this.jobs = [];\n    this.pending = 0;\n  }\n\n  /**\n   * Adds a job to the queue.\n   *\n   * @param {Function} job The job to run\n   * @public\n   */\n  add(job) {\n    this.jobs.push(job);\n    this[kRun]();\n  }\n\n  /**\n   * Removes a job from the queue and runs it if possible.\n   *\n   * @private\n   */\n  [kRun]() {\n    if (this.pending === this.concurrency) return;\n\n    if (this.jobs.length) {\n      const job = this.jobs.shift();\n\n      this.pending++;\n      job(this[kDone]);\n    }\n  }\n}\n\nmodule.exports = Limiter;\n","'use strict';\n\nconst zlib = require('zlib');\n\nconst bufferUtil = require('./buffer-util');\nconst Limiter = require('./limiter');\nconst { kStatusCode } = require('./constants');\n\nconst FastBuffer = Buffer[Symbol.species];\nconst TRAILER = Buffer.from([0x00, 0x00, 0xff, 0xff]);\nconst kPerMessageDeflate = Symbol('permessage-deflate');\nconst kTotalLength = Symbol('total-length');\nconst kCallback = Symbol('callback');\nconst kBuffers = Symbol('buffers');\nconst kError = Symbol('error');\n\n//\n// We limit zlib concurrency, which prevents severe memory fragmentation\n// as documented in https://github.com/nodejs/node/issues/8871#issuecomment-250915913\n// and https://github.com/websockets/ws/issues/1202\n//\n// Intentionally global; it's the global thread pool that's an issue.\n//\nlet zlibLimiter;\n\n/**\n * permessage-deflate implementation.\n */\nclass PerMessageDeflate {\n  /**\n   * Creates a PerMessageDeflate instance.\n   *\n   * @param {Object} [options] Configuration options\n   * @param {(Boolean|Number)} [options.clientMaxWindowBits] Advertise support\n   *     for, or request, a custom client window size\n   * @param {Boolean} [options.clientNoContextTakeover=false] Advertise/\n   *     acknowledge disabling of client context takeover\n   * @param {Number} [options.concurrencyLimit=10] The number of concurrent\n   *     calls to zlib\n   * @param {(Boolean|Number)} [options.serverMaxWindowBits] Request/confirm the\n   *     use of a custom server window size\n   * @param {Boolean} [options.serverNoContextTakeover=false] Request/accept\n   *     disabling of server context takeover\n   * @param {Number} [options.threshold=1024] Size (in bytes) below which\n   *     messages should not be compressed if context takeover is disabled\n   * @param {Object} [options.zlibDeflateOptions] Options to pass to zlib on\n   *     deflate\n   * @param {Object} [options.zlibInflateOptions] Options to pass to zlib on\n   *     inflate\n   * @param {Boolean} [isServer=false] Create the instance in either server or\n   *     client mode\n   * @param {Number} [maxPayload=0] The maximum allowed message length\n   */\n  constructor(options, isServer, maxPayload) {\n    this._maxPayload = maxPayload | 0;\n    this._options = options || {};\n    this._threshold =\n      this._options.threshold !== undefined ? this._options.threshold : 1024;\n    this._isServer = !!isServer;\n    this._deflate = null;\n    this._inflate = null;\n\n    this.params = null;\n\n    if (!zlibLimiter) {\n      const concurrency =\n        this._options.concurrencyLimit !== undefined\n          ? this._options.concurrencyLimit\n          : 10;\n      zlibLimiter = new Limiter(concurrency);\n    }\n  }\n\n  /**\n   * @type {String}\n   */\n  static get extensionName() {\n    return 'permessage-deflate';\n  }\n\n  /**\n   * Create an extension negotiation offer.\n   *\n   * @return {Object} Extension parameters\n   * @public\n   */\n  offer() {\n    const params = {};\n\n    if (this._options.serverNoContextTakeover) {\n      params.server_no_context_takeover = true;\n    }\n    if (this._options.clientNoContextTakeover) {\n      params.client_no_context_takeover = true;\n    }\n    if (this._options.serverMaxWindowBits) {\n      params.server_max_window_bits = this._options.serverMaxWindowBits;\n    }\n    if (this._options.clientMaxWindowBits) {\n      params.client_max_window_bits = this._options.clientMaxWindowBits;\n    } else if (this._options.clientMaxWindowBits == null) {\n      params.client_max_window_bits = true;\n    }\n\n    return params;\n  }\n\n  /**\n   * Accept an extension negotiation offer/response.\n   *\n   * @param {Array} configurations The extension negotiation offers/reponse\n   * @return {Object} Accepted configuration\n   * @public\n   */\n  accept(configurations) {\n    configurations = this.normalizeParams(configurations);\n\n    this.params = this._isServer\n      ? this.acceptAsServer(configurations)\n      : this.acceptAsClient(configurations);\n\n    return this.params;\n  }\n\n  /**\n   * Releases all resources used by the extension.\n   *\n   * @public\n   */\n  cleanup() {\n    if (this._inflate) {\n      this._inflate.close();\n      this._inflate = null;\n    }\n\n    if (this._deflate) {\n      const callback = this._deflate[kCallback];\n\n      this._deflate.close();\n      this._deflate = null;\n\n      if (callback) {\n        callback(\n          new Error(\n            'The deflate stream was closed while data was being processed'\n          )\n        );\n      }\n    }\n  }\n\n  /**\n   *  Accept an extension negotiation offer.\n   *\n   * @param {Array} offers The extension negotiation offers\n   * @return {Object} Accepted configuration\n   * @private\n   */\n  acceptAsServer(offers) {\n    const opts = this._options;\n    const accepted = offers.find((params) => {\n      if (\n        (opts.serverNoContextTakeover === false &&\n          params.server_no_context_takeover) ||\n        (params.server_max_window_bits &&\n          (opts.serverMaxWindowBits === false ||\n            (typeof opts.serverMaxWindowBits === 'number' &&\n              opts.serverMaxWindowBits > params.server_max_window_bits))) ||\n        (typeof opts.clientMaxWindowBits === 'number' &&\n          !params.client_max_window_bits)\n      ) {\n        return false;\n      }\n\n      return true;\n    });\n\n    if (!accepted) {\n      throw new Error('None of the extension offers can be accepted');\n    }\n\n    if (opts.serverNoContextTakeover) {\n      accepted.server_no_context_takeover = true;\n    }\n    if (opts.clientNoContextTakeover) {\n      accepted.client_no_context_takeover = true;\n    }\n    if (typeof opts.serverMaxWindowBits === 'number') {\n      accepted.server_max_window_bits = opts.serverMaxWindowBits;\n    }\n    if (typeof opts.clientMaxWindowBits === 'number') {\n      accepted.client_max_window_bits = opts.clientMaxWindowBits;\n    } else if (\n      accepted.client_max_window_bits === true ||\n      opts.clientMaxWindowBits === false\n    ) {\n      delete accepted.client_max_window_bits;\n    }\n\n    return accepted;\n  }\n\n  /**\n   * Accept the extension negotiation response.\n   *\n   * @param {Array} response The extension negotiation response\n   * @return {Object} Accepted configuration\n   * @private\n   */\n  acceptAsClient(response) {\n    const params = response[0];\n\n    if (\n      this._options.clientNoContextTakeover === false &&\n      params.client_no_context_takeover\n    ) {\n      throw new Error('Unexpected parameter \"client_no_context_takeover\"');\n    }\n\n    if (!params.client_max_window_bits) {\n      if (typeof this._options.clientMaxWindowBits === 'number') {\n        params.client_max_window_bits = this._options.clientMaxWindowBits;\n      }\n    } else if (\n      this._options.clientMaxWindowBits === false ||\n      (typeof this._options.clientMaxWindowBits === 'number' &&\n        params.client_max_window_bits > this._options.clientMaxWindowBits)\n    ) {\n      throw new Error(\n        'Unexpected or invalid parameter \"client_max_window_bits\"'\n      );\n    }\n\n    return params;\n  }\n\n  /**\n   * Normalize parameters.\n   *\n   * @param {Array} configurations The extension negotiation offers/reponse\n   * @return {Array} The offers/response with normalized parameters\n   * @private\n   */\n  normalizeParams(configurations) {\n    configurations.forEach((params) => {\n      Object.keys(params).forEach((key) => {\n        let value = params[key];\n\n        if (value.length > 1) {\n          throw new Error(`Parameter \"${key}\" must have only a single value`);\n        }\n\n        value = value[0];\n\n        if (key === 'client_max_window_bits') {\n          if (value !== true) {\n            const num = +value;\n            if (!Number.isInteger(num) || num < 8 || num > 15) {\n              throw new TypeError(\n                `Invalid value for parameter \"${key}\": ${value}`\n              );\n            }\n            value = num;\n          } else if (!this._isServer) {\n            throw new TypeError(\n              `Invalid value for parameter \"${key}\": ${value}`\n            );\n          }\n        } else if (key === 'server_max_window_bits') {\n          const num = +value;\n          if (!Number.isInteger(num) || num < 8 || num > 15) {\n            throw new TypeError(\n              `Invalid value for parameter \"${key}\": ${value}`\n            );\n          }\n          value = num;\n        } else if (\n          key === 'client_no_context_takeover' ||\n          key === 'server_no_context_takeover'\n        ) {\n          if (value !== true) {\n            throw new TypeError(\n              `Invalid value for parameter \"${key}\": ${value}`\n            );\n          }\n        } else {\n          throw new Error(`Unknown parameter \"${key}\"`);\n        }\n\n        params[key] = value;\n      });\n    });\n\n    return configurations;\n  }\n\n  /**\n   * Decompress data. Concurrency limited.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @public\n   */\n  decompress(data, fin, callback) {\n    zlibLimiter.add((done) => {\n      this._decompress(data, fin, (err, result) => {\n        done();\n        callback(err, result);\n      });\n    });\n  }\n\n  /**\n   * Compress data. Concurrency limited.\n   *\n   * @param {(Buffer|String)} data Data to compress\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @public\n   */\n  compress(data, fin, callback) {\n    zlibLimiter.add((done) => {\n      this._compress(data, fin, (err, result) => {\n        done();\n        callback(err, result);\n      });\n    });\n  }\n\n  /**\n   * Decompress data.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @private\n   */\n  _decompress(data, fin, callback) {\n    const endpoint = this._isServer ? 'client' : 'server';\n\n    if (!this._inflate) {\n      const key = `${endpoint}_max_window_bits`;\n      const windowBits =\n        typeof this.params[key] !== 'number'\n          ? zlib.Z_DEFAULT_WINDOWBITS\n          : this.params[key];\n\n      this._inflate = zlib.createInflateRaw({\n        ...this._options.zlibInflateOptions,\n        windowBits\n      });\n      this._inflate[kPerMessageDeflate] = this;\n      this._inflate[kTotalLength] = 0;\n      this._inflate[kBuffers] = [];\n      this._inflate.on('error', inflateOnError);\n      this._inflate.on('data', inflateOnData);\n    }\n\n    this._inflate[kCallback] = callback;\n\n    this._inflate.write(data);\n    if (fin) this._inflate.write(TRAILER);\n\n    this._inflate.flush(() => {\n      const err = this._inflate[kError];\n\n      if (err) {\n        this._inflate.close();\n        this._inflate = null;\n        callback(err);\n        return;\n      }\n\n      const data = bufferUtil.concat(\n        this._inflate[kBuffers],\n        this._inflate[kTotalLength]\n      );\n\n      if (this._inflate._readableState.endEmitted) {\n        this._inflate.close();\n        this._inflate = null;\n      } else {\n        this._inflate[kTotalLength] = 0;\n        this._inflate[kBuffers] = [];\n\n        if (fin && this.params[`${endpoint}_no_context_takeover`]) {\n          this._inflate.reset();\n        }\n      }\n\n      callback(null, data);\n    });\n  }\n\n  /**\n   * Compress data.\n   *\n   * @param {(Buffer|String)} data Data to compress\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @private\n   */\n  _compress(data, fin, callback) {\n    const endpoint = this._isServer ? 'server' : 'client';\n\n    if (!this._deflate) {\n      const key = `${endpoint}_max_window_bits`;\n      const windowBits =\n        typeof this.params[key] !== 'number'\n          ? zlib.Z_DEFAULT_WINDOWBITS\n          : this.params[key];\n\n      this._deflate = zlib.createDeflateRaw({\n        ...this._options.zlibDeflateOptions,\n        windowBits\n      });\n\n      this._deflate[kTotalLength] = 0;\n      this._deflate[kBuffers] = [];\n\n      this._deflate.on('data', deflateOnData);\n    }\n\n    this._deflate[kCallback] = callback;\n\n    this._deflate.write(data);\n    this._deflate.flush(zlib.Z_SYNC_FLUSH, () => {\n      if (!this._deflate) {\n        //\n        // The deflate stream was closed while data was being processed.\n        //\n        return;\n      }\n\n      let data = bufferUtil.concat(\n        this._deflate[kBuffers],\n        this._deflate[kTotalLength]\n      );\n\n      if (fin) {\n        data = new FastBuffer(data.buffer, data.byteOffset, data.length - 4);\n      }\n\n      //\n      // Ensure that the callback will not be called again in\n      // `PerMessageDeflate#cleanup()`.\n      //\n      this._deflate[kCallback] = null;\n\n      this._deflate[kTotalLength] = 0;\n      this._deflate[kBuffers] = [];\n\n      if (fin && this.params[`${endpoint}_no_context_takeover`]) {\n        this._deflate.reset();\n      }\n\n      callback(null, data);\n    });\n  }\n}\n\nmodule.exports = PerMessageDeflate;\n\n/**\n * The listener of the `zlib.DeflateRaw` stream `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction deflateOnData(chunk) {\n  this[kBuffers].push(chunk);\n  this[kTotalLength] += chunk.length;\n}\n\n/**\n * The listener of the `zlib.InflateRaw` stream `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction inflateOnData(chunk) {\n  this[kTotalLength] += chunk.length;\n\n  if (\n    this[kPerMessageDeflate]._maxPayload < 1 ||\n    this[kTotalLength] <= this[kPerMessageDeflate]._maxPayload\n  ) {\n    this[kBuffers].push(chunk);\n    return;\n  }\n\n  this[kError] = new RangeError('Max payload size exceeded');\n  this[kError].code = 'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH';\n  this[kError][kStatusCode] = 1009;\n  this.removeListener('data', inflateOnData);\n\n  //\n  // The choice to employ `zlib.reset()` over `zlib.close()` is dictated by the\n  // fact that in Node.js versions prior to 13.10.0, the callback for\n  // `zlib.flush()` is not called if `zlib.close()` is used. Utilizing\n  // `zlib.reset()` ensures that either the callback is invoked or an error is\n  // emitted.\n  //\n  this.reset();\n}\n\n/**\n * The listener of the `zlib.InflateRaw` stream `'error'` event.\n *\n * @param {Error} err The emitted error\n * @private\n */\nfunction inflateOnError(err) {\n  //\n  // There is no need to call `Zlib#close()` as the handle is automatically\n  // closed when an error is emitted.\n  //\n  this[kPerMessageDeflate]._inflate = null;\n\n  if (this[kError]) {\n    this[kCallback](this[kError]);\n    return;\n  }\n\n  err[kStatusCode] = 1007;\n  this[kCallback](err);\n}\n","'use strict';\n\nconst { isUtf8 } = require('buffer');\n\nconst { hasBlob } = require('./constants');\n\n//\n// Allowed token characters:\n//\n// '!', '#', '$', '%', '&', ''', '*', '+', '-',\n// '.', 0-9, A-Z, '^', '_', '`', a-z, '|', '~'\n//\n// tokenChars[32] === 0 // ' '\n// tokenChars[33] === 1 // '!'\n// tokenChars[34] === 0 // '\"'\n// ...\n//\n// prettier-ignore\nconst tokenChars = [\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 0 - 15\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 16 - 31\n  0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, // 32 - 47\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, // 48 - 63\n  0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 64 - 79\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, // 80 - 95\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 96 - 111\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0 // 112 - 127\n];\n\n/**\n * Checks if a status code is allowed in a close frame.\n *\n * @param {Number} code The status code\n * @return {Boolean} `true` if the status code is valid, else `false`\n * @public\n */\nfunction isValidStatusCode(code) {\n  return (\n    (code >= 1000 &&\n      code <= 1014 &&\n      code !== 1004 &&\n      code !== 1005 &&\n      code !== 1006) ||\n    (code >= 3000 && code <= 4999)\n  );\n}\n\n/**\n * Checks if a given buffer contains only correct UTF-8.\n * Ported from https://www.cl.cam.ac.uk/%7Emgk25/ucs/utf8_check.c by\n * Markus Kuhn.\n *\n * @param {Buffer} buf The buffer to check\n * @return {Boolean} `true` if `buf` contains only correct UTF-8, else `false`\n * @public\n */\nfunction _isValidUTF8(buf) {\n  const len = buf.length;\n  let i = 0;\n\n  while (i < len) {\n    if ((buf[i] & 0x80) === 0) {\n      // 0xxxxxxx\n      i++;\n    } else if ((buf[i] & 0xe0) === 0xc0) {\n      // 110xxxxx 10xxxxxx\n      if (\n        i + 1 === len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i] & 0xfe) === 0xc0 // Overlong\n      ) {\n        return false;\n      }\n\n      i += 2;\n    } else if ((buf[i] & 0xf0) === 0xe0) {\n      // 1110xxxx 10xxxxxx 10xxxxxx\n      if (\n        i + 2 >= len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i + 2] & 0xc0) !== 0x80 ||\n        (buf[i] === 0xe0 && (buf[i + 1] & 0xe0) === 0x80) || // Overlong\n        (buf[i] === 0xed && (buf[i + 1] & 0xe0) === 0xa0) // Surrogate (U+D800 - U+DFFF)\n      ) {\n        return false;\n      }\n\n      i += 3;\n    } else if ((buf[i] & 0xf8) === 0xf0) {\n      // 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx\n      if (\n        i + 3 >= len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i + 2] & 0xc0) !== 0x80 ||\n        (buf[i + 3] & 0xc0) !== 0x80 ||\n        (buf[i] === 0xf0 && (buf[i + 1] & 0xf0) === 0x80) || // Overlong\n        (buf[i] === 0xf4 && buf[i + 1] > 0x8f) ||\n        buf[i] > 0xf4 // > U+10FFFF\n      ) {\n        return false;\n      }\n\n      i += 4;\n    } else {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Determines whether a value is a `Blob`.\n *\n * @param {*} value The value to be tested\n * @return {Boolean} `true` if `value` is a `Blob`, else `false`\n * @private\n */\nfunction isBlob(value) {\n  return (\n    hasBlob &&\n    typeof value === 'object' &&\n    typeof value.arrayBuffer === 'function' &&\n    typeof value.type === 'string' &&\n    typeof value.stream === 'function' &&\n    (value[Symbol.toStringTag] === 'Blob' ||\n      value[Symbol.toStringTag] === 'File')\n  );\n}\n\nmodule.exports = {\n  isBlob,\n  isValidStatusCode,\n  isValidUTF8: _isValidUTF8,\n  tokenChars\n};\n\nif (isUtf8) {\n  module.exports.isValidUTF8 = function (buf) {\n    return buf.length < 24 ? _isValidUTF8(buf) : isUtf8(buf);\n  };\n} /* istanbul ignore else  */ else if (!process.env.WS_NO_UTF_8_VALIDATE) {\n  try {\n    const isValidUTF8 = require('utf-8-validate');\n\n    module.exports.isValidUTF8 = function (buf) {\n      return buf.length < 32 ? _isValidUTF8(buf) : isValidUTF8(buf);\n    };\n  } catch (e) {\n    // Continue regardless of the error.\n  }\n}\n","'use strict';\n\nconst { Writable } = require('stream');\n\nconst PerMessageDeflate = require('./permessage-deflate');\nconst {\n  BINARY_TYPES,\n  EMPTY_BUFFER,\n  kStatusCode,\n  kWebSocket\n} = require('./constants');\nconst { concat, toArrayBuffer, unmask } = require('./buffer-util');\nconst { isValidStatusCode, isValidUTF8 } = require('./validation');\n\nconst FastBuffer = Buffer[Symbol.species];\n\nconst GET_INFO = 0;\nconst GET_PAYLOAD_LENGTH_16 = 1;\nconst GET_PAYLOAD_LENGTH_64 = 2;\nconst GET_MASK = 3;\nconst GET_DATA = 4;\nconst INFLATING = 5;\nconst DEFER_EVENT = 6;\n\n/**\n * HyBi Receiver implementation.\n *\n * @extends Writable\n */\nclass Receiver extends Writable {\n  /**\n   * Creates a Receiver instance.\n   *\n   * @param {Object} [options] Options object\n   * @param {Boolean} [options.allowSynchronousEvents=true] Specifies whether\n   *     any of the `'message'`, `'ping'`, and `'pong'` events can be emitted\n   *     multiple times in the same tick\n   * @param {String} [options.binaryType=nodebuffer] The type for binary data\n   * @param {Object} [options.extensions] An object containing the negotiated\n   *     extensions\n   * @param {Boolean} [options.isServer=false] Specifies whether to operate in\n   *     client or server mode\n   * @param {Number} [options.maxPayload=0] The maximum allowed message length\n   * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n   *     not to skip UTF-8 validation for text and close messages\n   */\n  constructor(options = {}) {\n    super();\n\n    this._allowSynchronousEvents =\n      options.allowSynchronousEvents !== undefined\n        ? options.allowSynchronousEvents\n        : true;\n    this._binaryType = options.binaryType || BINARY_TYPES[0];\n    this._extensions = options.extensions || {};\n    this._isServer = !!options.isServer;\n    this._maxPayload = options.maxPayload | 0;\n    this._skipUTF8Validation = !!options.skipUTF8Validation;\n    this[kWebSocket] = undefined;\n\n    this._bufferedBytes = 0;\n    this._buffers = [];\n\n    this._compressed = false;\n    this._payloadLength = 0;\n    this._mask = undefined;\n    this._fragmented = 0;\n    this._masked = false;\n    this._fin = false;\n    this._opcode = 0;\n\n    this._totalPayloadLength = 0;\n    this._messageLength = 0;\n    this._fragments = [];\n\n    this._errored = false;\n    this._loop = false;\n    this._state = GET_INFO;\n  }\n\n  /**\n   * Implements `Writable.prototype._write()`.\n   *\n   * @param {Buffer} chunk The chunk of data to write\n   * @param {String} encoding The character encoding of `chunk`\n   * @param {Function} cb Callback\n   * @private\n   */\n  _write(chunk, encoding, cb) {\n    if (this._opcode === 0x08 && this._state == GET_INFO) return cb();\n\n    this._bufferedBytes += chunk.length;\n    this._buffers.push(chunk);\n    this.startLoop(cb);\n  }\n\n  /**\n   * Consumes `n` bytes from the buffered data.\n   *\n   * @param {Number} n The number of bytes to consume\n   * @return {Buffer} The consumed bytes\n   * @private\n   */\n  consume(n) {\n    this._bufferedBytes -= n;\n\n    if (n === this._buffers[0].length) return this._buffers.shift();\n\n    if (n < this._buffers[0].length) {\n      const buf = this._buffers[0];\n      this._buffers[0] = new FastBuffer(\n        buf.buffer,\n        buf.byteOffset + n,\n        buf.length - n\n      );\n\n      return new FastBuffer(buf.buffer, buf.byteOffset, n);\n    }\n\n    const dst = Buffer.allocUnsafe(n);\n\n    do {\n      const buf = this._buffers[0];\n      const offset = dst.length - n;\n\n      if (n >= buf.length) {\n        dst.set(this._buffers.shift(), offset);\n      } else {\n        dst.set(new Uint8Array(buf.buffer, buf.byteOffset, n), offset);\n        this._buffers[0] = new FastBuffer(\n          buf.buffer,\n          buf.byteOffset + n,\n          buf.length - n\n        );\n      }\n\n      n -= buf.length;\n    } while (n > 0);\n\n    return dst;\n  }\n\n  /**\n   * Starts the parsing loop.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  startLoop(cb) {\n    this._loop = true;\n\n    do {\n      switch (this._state) {\n        case GET_INFO:\n          this.getInfo(cb);\n          break;\n        case GET_PAYLOAD_LENGTH_16:\n          this.getPayloadLength16(cb);\n          break;\n        case GET_PAYLOAD_LENGTH_64:\n          this.getPayloadLength64(cb);\n          break;\n        case GET_MASK:\n          this.getMask();\n          break;\n        case GET_DATA:\n          this.getData(cb);\n          break;\n        case INFLATING:\n        case DEFER_EVENT:\n          this._loop = false;\n          return;\n      }\n    } while (this._loop);\n\n    if (!this._errored) cb();\n  }\n\n  /**\n   * Reads the first two bytes of a frame.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getInfo(cb) {\n    if (this._bufferedBytes < 2) {\n      this._loop = false;\n      return;\n    }\n\n    const buf = this.consume(2);\n\n    if ((buf[0] & 0x30) !== 0x00) {\n      const error = this.createError(\n        RangeError,\n        'RSV2 and RSV3 must be clear',\n        true,\n        1002,\n        'WS_ERR_UNEXPECTED_RSV_2_3'\n      );\n\n      cb(error);\n      return;\n    }\n\n    const compressed = (buf[0] & 0x40) === 0x40;\n\n    if (compressed && !this._extensions[PerMessageDeflate.extensionName]) {\n      const error = this.createError(\n        RangeError,\n        'RSV1 must be clear',\n        true,\n        1002,\n        'WS_ERR_UNEXPECTED_RSV_1'\n      );\n\n      cb(error);\n      return;\n    }\n\n    this._fin = (buf[0] & 0x80) === 0x80;\n    this._opcode = buf[0] & 0x0f;\n    this._payloadLength = buf[1] & 0x7f;\n\n    if (this._opcode === 0x00) {\n      if (compressed) {\n        const error = this.createError(\n          RangeError,\n          'RSV1 must be clear',\n          true,\n          1002,\n          'WS_ERR_UNEXPECTED_RSV_1'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (!this._fragmented) {\n        const error = this.createError(\n          RangeError,\n          'invalid opcode 0',\n          true,\n          1002,\n          'WS_ERR_INVALID_OPCODE'\n        );\n\n        cb(error);\n        return;\n      }\n\n      this._opcode = this._fragmented;\n    } else if (this._opcode === 0x01 || this._opcode === 0x02) {\n      if (this._fragmented) {\n        const error = this.createError(\n          RangeError,\n          `invalid opcode ${this._opcode}`,\n          true,\n          1002,\n          'WS_ERR_INVALID_OPCODE'\n        );\n\n        cb(error);\n        return;\n      }\n\n      this._compressed = compressed;\n    } else if (this._opcode > 0x07 && this._opcode < 0x0b) {\n      if (!this._fin) {\n        const error = this.createError(\n          RangeError,\n          'FIN must be set',\n          true,\n          1002,\n          'WS_ERR_EXPECTED_FIN'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (compressed) {\n        const error = this.createError(\n          RangeError,\n          'RSV1 must be clear',\n          true,\n          1002,\n          'WS_ERR_UNEXPECTED_RSV_1'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (\n        this._payloadLength > 0x7d ||\n        (this._opcode === 0x08 && this._payloadLength === 1)\n      ) {\n        const error = this.createError(\n          RangeError,\n          `invalid payload length ${this._payloadLength}`,\n          true,\n          1002,\n          'WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH'\n        );\n\n        cb(error);\n        return;\n      }\n    } else {\n      const error = this.createError(\n        RangeError,\n        `invalid opcode ${this._opcode}`,\n        true,\n        1002,\n        'WS_ERR_INVALID_OPCODE'\n      );\n\n      cb(error);\n      return;\n    }\n\n    if (!this._fin && !this._fragmented) this._fragmented = this._opcode;\n    this._masked = (buf[1] & 0x80) === 0x80;\n\n    if (this._isServer) {\n      if (!this._masked) {\n        const error = this.createError(\n          RangeError,\n          'MASK must be set',\n          true,\n          1002,\n          'WS_ERR_EXPECTED_MASK'\n        );\n\n        cb(error);\n        return;\n      }\n    } else if (this._masked) {\n      const error = this.createError(\n        RangeError,\n        'MASK must be clear',\n        true,\n        1002,\n        'WS_ERR_UNEXPECTED_MASK'\n      );\n\n      cb(error);\n      return;\n    }\n\n    if (this._payloadLength === 126) this._state = GET_PAYLOAD_LENGTH_16;\n    else if (this._payloadLength === 127) this._state = GET_PAYLOAD_LENGTH_64;\n    else this.haveLength(cb);\n  }\n\n  /**\n   * Gets extended payload length (7+16).\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getPayloadLength16(cb) {\n    if (this._bufferedBytes < 2) {\n      this._loop = false;\n      return;\n    }\n\n    this._payloadLength = this.consume(2).readUInt16BE(0);\n    this.haveLength(cb);\n  }\n\n  /**\n   * Gets extended payload length (7+64).\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getPayloadLength64(cb) {\n    if (this._bufferedBytes < 8) {\n      this._loop = false;\n      return;\n    }\n\n    const buf = this.consume(8);\n    const num = buf.readUInt32BE(0);\n\n    //\n    // The maximum safe integer in JavaScript is 2^53 - 1. An error is returned\n    // if payload length is greater than this number.\n    //\n    if (num > Math.pow(2, 53 - 32) - 1) {\n      const error = this.createError(\n        RangeError,\n        'Unsupported WebSocket frame: payload length > 2^53 - 1',\n        false,\n        1009,\n        'WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH'\n      );\n\n      cb(error);\n      return;\n    }\n\n    this._payloadLength = num * Math.pow(2, 32) + buf.readUInt32BE(4);\n    this.haveLength(cb);\n  }\n\n  /**\n   * Payload length has been read.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  haveLength(cb) {\n    if (this._payloadLength && this._opcode < 0x08) {\n      this._totalPayloadLength += this._payloadLength;\n      if (this._totalPayloadLength > this._maxPayload && this._maxPayload > 0) {\n        const error = this.createError(\n          RangeError,\n          'Max payload size exceeded',\n          false,\n          1009,\n          'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH'\n        );\n\n        cb(error);\n        return;\n      }\n    }\n\n    if (this._masked) this._state = GET_MASK;\n    else this._state = GET_DATA;\n  }\n\n  /**\n   * Reads mask bytes.\n   *\n   * @private\n   */\n  getMask() {\n    if (this._bufferedBytes < 4) {\n      this._loop = false;\n      return;\n    }\n\n    this._mask = this.consume(4);\n    this._state = GET_DATA;\n  }\n\n  /**\n   * Reads data bytes.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getData(cb) {\n    let data = EMPTY_BUFFER;\n\n    if (this._payloadLength) {\n      if (this._bufferedBytes < this._payloadLength) {\n        this._loop = false;\n        return;\n      }\n\n      data = this.consume(this._payloadLength);\n\n      if (\n        this._masked &&\n        (this._mask[0] | this._mask[1] | this._mask[2] | this._mask[3]) !== 0\n      ) {\n        unmask(data, this._mask);\n      }\n    }\n\n    if (this._opcode > 0x07) {\n      this.controlMessage(data, cb);\n      return;\n    }\n\n    if (this._compressed) {\n      this._state = INFLATING;\n      this.decompress(data, cb);\n      return;\n    }\n\n    if (data.length) {\n      //\n      // This message is not compressed so its length is the sum of the payload\n      // length of all fragments.\n      //\n      this._messageLength = this._totalPayloadLength;\n      this._fragments.push(data);\n    }\n\n    this.dataMessage(cb);\n  }\n\n  /**\n   * Decompresses data.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Function} cb Callback\n   * @private\n   */\n  decompress(data, cb) {\n    const perMessageDeflate = this._extensions[PerMessageDeflate.extensionName];\n\n    perMessageDeflate.decompress(data, this._fin, (err, buf) => {\n      if (err) return cb(err);\n\n      if (buf.length) {\n        this._messageLength += buf.length;\n        if (this._messageLength > this._maxPayload && this._maxPayload > 0) {\n          const error = this.createError(\n            RangeError,\n            'Max payload size exceeded',\n            false,\n            1009,\n            'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH'\n          );\n\n          cb(error);\n          return;\n        }\n\n        this._fragments.push(buf);\n      }\n\n      this.dataMessage(cb);\n      if (this._state === GET_INFO) this.startLoop(cb);\n    });\n  }\n\n  /**\n   * Handles a data message.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  dataMessage(cb) {\n    if (!this._fin) {\n      this._state = GET_INFO;\n      return;\n    }\n\n    const messageLength = this._messageLength;\n    const fragments = this._fragments;\n\n    this._totalPayloadLength = 0;\n    this._messageLength = 0;\n    this._fragmented = 0;\n    this._fragments = [];\n\n    if (this._opcode === 2) {\n      let data;\n\n      if (this._binaryType === 'nodebuffer') {\n        data = concat(fragments, messageLength);\n      } else if (this._binaryType === 'arraybuffer') {\n        data = toArrayBuffer(concat(fragments, messageLength));\n      } else if (this._binaryType === 'blob') {\n        data = new Blob(fragments);\n      } else {\n        data = fragments;\n      }\n\n      if (this._allowSynchronousEvents) {\n        this.emit('message', data, true);\n        this._state = GET_INFO;\n      } else {\n        this._state = DEFER_EVENT;\n        setImmediate(() => {\n          this.emit('message', data, true);\n          this._state = GET_INFO;\n          this.startLoop(cb);\n        });\n      }\n    } else {\n      const buf = concat(fragments, messageLength);\n\n      if (!this._skipUTF8Validation && !isValidUTF8(buf)) {\n        const error = this.createError(\n          Error,\n          'invalid UTF-8 sequence',\n          true,\n          1007,\n          'WS_ERR_INVALID_UTF8'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (this._state === INFLATING || this._allowSynchronousEvents) {\n        this.emit('message', buf, false);\n        this._state = GET_INFO;\n      } else {\n        this._state = DEFER_EVENT;\n        setImmediate(() => {\n          this.emit('message', buf, false);\n          this._state = GET_INFO;\n          this.startLoop(cb);\n        });\n      }\n    }\n  }\n\n  /**\n   * Handles a control message.\n   *\n   * @param {Buffer} data Data to handle\n   * @return {(Error|RangeError|undefined)} A possible error\n   * @private\n   */\n  controlMessage(data, cb) {\n    if (this._opcode === 0x08) {\n      if (data.length === 0) {\n        this._loop = false;\n        this.emit('conclude', 1005, EMPTY_BUFFER);\n        this.end();\n      } else {\n        const code = data.readUInt16BE(0);\n\n        if (!isValidStatusCode(code)) {\n          const error = this.createError(\n            RangeError,\n            `invalid status code ${code}`,\n            true,\n            1002,\n            'WS_ERR_INVALID_CLOSE_CODE'\n          );\n\n          cb(error);\n          return;\n        }\n\n        const buf = new FastBuffer(\n          data.buffer,\n          data.byteOffset + 2,\n          data.length - 2\n        );\n\n        if (!this._skipUTF8Validation && !isValidUTF8(buf)) {\n          const error = this.createError(\n            Error,\n            'invalid UTF-8 sequence',\n            true,\n            1007,\n            'WS_ERR_INVALID_UTF8'\n          );\n\n          cb(error);\n          return;\n        }\n\n        this._loop = false;\n        this.emit('conclude', code, buf);\n        this.end();\n      }\n\n      this._state = GET_INFO;\n      return;\n    }\n\n    if (this._allowSynchronousEvents) {\n      this.emit(this._opcode === 0x09 ? 'ping' : 'pong', data);\n      this._state = GET_INFO;\n    } else {\n      this._state = DEFER_EVENT;\n      setImmediate(() => {\n        this.emit(this._opcode === 0x09 ? 'ping' : 'pong', data);\n        this._state = GET_INFO;\n        this.startLoop(cb);\n      });\n    }\n  }\n\n  /**\n   * Builds an error object.\n   *\n   * @param {function(new:Error|RangeError)} ErrorCtor The error constructor\n   * @param {String} message The error message\n   * @param {Boolean} prefix Specifies whether or not to add a default prefix to\n   *     `message`\n   * @param {Number} statusCode The status code\n   * @param {String} errorCode The exposed error code\n   * @return {(Error|RangeError)} The error\n   * @private\n   */\n  createError(ErrorCtor, message, prefix, statusCode, errorCode) {\n    this._loop = false;\n    this._errored = true;\n\n    const err = new ErrorCtor(\n      prefix ? `Invalid WebSocket frame: ${message}` : message\n    );\n\n    Error.captureStackTrace(err, this.createError);\n    err.code = errorCode;\n    err[kStatusCode] = statusCode;\n    return err;\n  }\n}\n\nmodule.exports = Receiver;\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^Duplex\" }] */\n\n'use strict';\n\nconst { Duplex } = require('stream');\nconst { randomFillSync } = require('crypto');\n\nconst PerMessageDeflate = require('./permessage-deflate');\nconst { EMPTY_BUFFER, kWebSocket, NOOP } = require('./constants');\nconst { isBlob, isValidStatusCode } = require('./validation');\nconst { mask: applyMask, toBuffer } = require('./buffer-util');\n\nconst kByteLength = Symbol('kByteLength');\nconst maskBuffer = Buffer.alloc(4);\nconst RANDOM_POOL_SIZE = 8 * 1024;\nlet randomPool;\nlet randomPoolPointer = RANDOM_POOL_SIZE;\n\nconst DEFAULT = 0;\nconst DEFLATING = 1;\nconst GET_BLOB_DATA = 2;\n\n/**\n * HyBi Sender implementation.\n */\nclass Sender {\n  /**\n   * Creates a Sender instance.\n   *\n   * @param {Duplex} socket The connection socket\n   * @param {Object} [extensions] An object containing the negotiated extensions\n   * @param {Function} [generateMask] The function used to generate the masking\n   *     key\n   */\n  constructor(socket, extensions, generateMask) {\n    this._extensions = extensions || {};\n\n    if (generateMask) {\n      this._generateMask = generateMask;\n      this._maskBuffer = Buffer.alloc(4);\n    }\n\n    this._socket = socket;\n\n    this._firstFragment = true;\n    this._compress = false;\n\n    this._bufferedBytes = 0;\n    this._queue = [];\n    this._state = DEFAULT;\n    this.onerror = NOOP;\n    this[kWebSocket] = undefined;\n  }\n\n  /**\n   * Frames a piece of data according to the HyBi WebSocket protocol.\n   *\n   * @param {(Buffer|String)} data The data to frame\n   * @param {Object} options Options object\n   * @param {Boolean} [options.fin=false] Specifies whether or not to set the\n   *     FIN bit\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Buffer} [options.maskBuffer] The buffer used to store the masking\n   *     key\n   * @param {Number} options.opcode The opcode\n   * @param {Boolean} [options.readOnly=false] Specifies whether `data` can be\n   *     modified\n   * @param {Boolean} [options.rsv1=false] Specifies whether or not to set the\n   *     RSV1 bit\n   * @return {(Buffer|String)[]} The framed data\n   * @public\n   */\n  static frame(data, options) {\n    let mask;\n    let merge = false;\n    let offset = 2;\n    let skipMasking = false;\n\n    if (options.mask) {\n      mask = options.maskBuffer || maskBuffer;\n\n      if (options.generateMask) {\n        options.generateMask(mask);\n      } else {\n        if (randomPoolPointer === RANDOM_POOL_SIZE) {\n          /* istanbul ignore else  */\n          if (randomPool === undefined) {\n            //\n            // This is lazily initialized because server-sent frames must not\n            // be masked so it may never be used.\n            //\n            randomPool = Buffer.alloc(RANDOM_POOL_SIZE);\n          }\n\n          randomFillSync(randomPool, 0, RANDOM_POOL_SIZE);\n          randomPoolPointer = 0;\n        }\n\n        mask[0] = randomPool[randomPoolPointer++];\n        mask[1] = randomPool[randomPoolPointer++];\n        mask[2] = randomPool[randomPoolPointer++];\n        mask[3] = randomPool[randomPoolPointer++];\n      }\n\n      skipMasking = (mask[0] | mask[1] | mask[2] | mask[3]) === 0;\n      offset = 6;\n    }\n\n    let dataLength;\n\n    if (typeof data === 'string') {\n      if (\n        (!options.mask || skipMasking) &&\n        options[kByteLength] !== undefined\n      ) {\n        dataLength = options[kByteLength];\n      } else {\n        data = Buffer.from(data);\n        dataLength = data.length;\n      }\n    } else {\n      dataLength = data.length;\n      merge = options.mask && options.readOnly && !skipMasking;\n    }\n\n    let payloadLength = dataLength;\n\n    if (dataLength >= 65536) {\n      offset += 8;\n      payloadLength = 127;\n    } else if (dataLength > 125) {\n      offset += 2;\n      payloadLength = 126;\n    }\n\n    const target = Buffer.allocUnsafe(merge ? dataLength + offset : offset);\n\n    target[0] = options.fin ? options.opcode | 0x80 : options.opcode;\n    if (options.rsv1) target[0] |= 0x40;\n\n    target[1] = payloadLength;\n\n    if (payloadLength === 126) {\n      target.writeUInt16BE(dataLength, 2);\n    } else if (payloadLength === 127) {\n      target[2] = target[3] = 0;\n      target.writeUIntBE(dataLength, 4, 6);\n    }\n\n    if (!options.mask) return [target, data];\n\n    target[1] |= 0x80;\n    target[offset - 4] = mask[0];\n    target[offset - 3] = mask[1];\n    target[offset - 2] = mask[2];\n    target[offset - 1] = mask[3];\n\n    if (skipMasking) return [target, data];\n\n    if (merge) {\n      applyMask(data, mask, target, offset, dataLength);\n      return [target];\n    }\n\n    applyMask(data, mask, data, 0, dataLength);\n    return [target, data];\n  }\n\n  /**\n   * Sends a close message to the other peer.\n   *\n   * @param {Number} [code] The status code component of the body\n   * @param {(String|Buffer)} [data] The message component of the body\n   * @param {Boolean} [mask=false] Specifies whether or not to mask the message\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  close(code, data, mask, cb) {\n    let buf;\n\n    if (code === undefined) {\n      buf = EMPTY_BUFFER;\n    } else if (typeof code !== 'number' || !isValidStatusCode(code)) {\n      throw new TypeError('First argument must be a valid error code number');\n    } else if (data === undefined || !data.length) {\n      buf = Buffer.allocUnsafe(2);\n      buf.writeUInt16BE(code, 0);\n    } else {\n      const length = Buffer.byteLength(data);\n\n      if (length > 123) {\n        throw new RangeError('The message must not be greater than 123 bytes');\n      }\n\n      buf = Buffer.allocUnsafe(2 + length);\n      buf.writeUInt16BE(code, 0);\n\n      if (typeof data === 'string') {\n        buf.write(data, 2);\n      } else {\n        buf.set(data, 2);\n      }\n    }\n\n    const options = {\n      [kByteLength]: buf.length,\n      fin: true,\n      generateMask: this._generateMask,\n      mask,\n      maskBuffer: this._maskBuffer,\n      opcode: 0x08,\n      readOnly: false,\n      rsv1: false\n    };\n\n    if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, buf, false, options, cb]);\n    } else {\n      this.sendFrame(Sender.frame(buf, options), cb);\n    }\n  }\n\n  /**\n   * Sends a ping message to the other peer.\n   *\n   * @param {*} data The message to send\n   * @param {Boolean} [mask=false] Specifies whether or not to mask `data`\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  ping(data, mask, cb) {\n    let byteLength;\n    let readOnly;\n\n    if (typeof data === 'string') {\n      byteLength = Buffer.byteLength(data);\n      readOnly = false;\n    } else if (isBlob(data)) {\n      byteLength = data.size;\n      readOnly = false;\n    } else {\n      data = toBuffer(data);\n      byteLength = data.length;\n      readOnly = toBuffer.readOnly;\n    }\n\n    if (byteLength > 125) {\n      throw new RangeError('The data size must not be greater than 125 bytes');\n    }\n\n    const options = {\n      [kByteLength]: byteLength,\n      fin: true,\n      generateMask: this._generateMask,\n      mask,\n      maskBuffer: this._maskBuffer,\n      opcode: 0x09,\n      readOnly,\n      rsv1: false\n    };\n\n    if (isBlob(data)) {\n      if (this._state !== DEFAULT) {\n        this.enqueue([this.getBlobData, data, false, options, cb]);\n      } else {\n        this.getBlobData(data, false, options, cb);\n      }\n    } else if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, data, false, options, cb]);\n    } else {\n      this.sendFrame(Sender.frame(data, options), cb);\n    }\n  }\n\n  /**\n   * Sends a pong message to the other peer.\n   *\n   * @param {*} data The message to send\n   * @param {Boolean} [mask=false] Specifies whether or not to mask `data`\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  pong(data, mask, cb) {\n    let byteLength;\n    let readOnly;\n\n    if (typeof data === 'string') {\n      byteLength = Buffer.byteLength(data);\n      readOnly = false;\n    } else if (isBlob(data)) {\n      byteLength = data.size;\n      readOnly = false;\n    } else {\n      data = toBuffer(data);\n      byteLength = data.length;\n      readOnly = toBuffer.readOnly;\n    }\n\n    if (byteLength > 125) {\n      throw new RangeError('The data size must not be greater than 125 bytes');\n    }\n\n    const options = {\n      [kByteLength]: byteLength,\n      fin: true,\n      generateMask: this._generateMask,\n      mask,\n      maskBuffer: this._maskBuffer,\n      opcode: 0x0a,\n      readOnly,\n      rsv1: false\n    };\n\n    if (isBlob(data)) {\n      if (this._state !== DEFAULT) {\n        this.enqueue([this.getBlobData, data, false, options, cb]);\n      } else {\n        this.getBlobData(data, false, options, cb);\n      }\n    } else if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, data, false, options, cb]);\n    } else {\n      this.sendFrame(Sender.frame(data, options), cb);\n    }\n  }\n\n  /**\n   * Sends a data message to the other peer.\n   *\n   * @param {*} data The message to send\n   * @param {Object} options Options object\n   * @param {Boolean} [options.binary=false] Specifies whether `data` is binary\n   *     or text\n   * @param {Boolean} [options.compress=false] Specifies whether or not to\n   *     compress `data`\n   * @param {Boolean} [options.fin=false] Specifies whether the fragment is the\n   *     last one\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  send(data, options, cb) {\n    const perMessageDeflate = this._extensions[PerMessageDeflate.extensionName];\n    let opcode = options.binary ? 2 : 1;\n    let rsv1 = options.compress;\n\n    let byteLength;\n    let readOnly;\n\n    if (typeof data === 'string') {\n      byteLength = Buffer.byteLength(data);\n      readOnly = false;\n    } else if (isBlob(data)) {\n      byteLength = data.size;\n      readOnly = false;\n    } else {\n      data = toBuffer(data);\n      byteLength = data.length;\n      readOnly = toBuffer.readOnly;\n    }\n\n    if (this._firstFragment) {\n      this._firstFragment = false;\n      if (\n        rsv1 &&\n        perMessageDeflate &&\n        perMessageDeflate.params[\n          perMessageDeflate._isServer\n            ? 'server_no_context_takeover'\n            : 'client_no_context_takeover'\n        ]\n      ) {\n        rsv1 = byteLength >= perMessageDeflate._threshold;\n      }\n      this._compress = rsv1;\n    } else {\n      rsv1 = false;\n      opcode = 0;\n    }\n\n    if (options.fin) this._firstFragment = true;\n\n    const opts = {\n      [kByteLength]: byteLength,\n      fin: options.fin,\n      generateMask: this._generateMask,\n      mask: options.mask,\n      maskBuffer: this._maskBuffer,\n      opcode,\n      readOnly,\n      rsv1\n    };\n\n    if (isBlob(data)) {\n      if (this._state !== DEFAULT) {\n        this.enqueue([this.getBlobData, data, this._compress, opts, cb]);\n      } else {\n        this.getBlobData(data, this._compress, opts, cb);\n      }\n    } else if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, data, this._compress, opts, cb]);\n    } else {\n      this.dispatch(data, this._compress, opts, cb);\n    }\n  }\n\n  /**\n   * Gets the contents of a blob as binary data.\n   *\n   * @param {Blob} blob The blob\n   * @param {Boolean} [compress=false] Specifies whether or not to compress\n   *     the data\n   * @param {Object} options Options object\n   * @param {Boolean} [options.fin=false] Specifies whether or not to set the\n   *     FIN bit\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Buffer} [options.maskBuffer] The buffer used to store the masking\n   *     key\n   * @param {Number} options.opcode The opcode\n   * @param {Boolean} [options.readOnly=false] Specifies whether `data` can be\n   *     modified\n   * @param {Boolean} [options.rsv1=false] Specifies whether or not to set the\n   *     RSV1 bit\n   * @param {Function} [cb] Callback\n   * @private\n   */\n  getBlobData(blob, compress, options, cb) {\n    this._bufferedBytes += options[kByteLength];\n    this._state = GET_BLOB_DATA;\n\n    blob\n      .arrayBuffer()\n      .then((arrayBuffer) => {\n        if (this._socket.destroyed) {\n          const err = new Error(\n            'The socket was closed while the blob was being read'\n          );\n\n          //\n          // `callCallbacks` is called in the next tick to ensure that errors\n          // that might be thrown in the callbacks behave like errors thrown\n          // outside the promise chain.\n          //\n          process.nextTick(callCallbacks, this, err, cb);\n          return;\n        }\n\n        this._bufferedBytes -= options[kByteLength];\n        const data = toBuffer(arrayBuffer);\n\n        if (!compress) {\n          this._state = DEFAULT;\n          this.sendFrame(Sender.frame(data, options), cb);\n          this.dequeue();\n        } else {\n          this.dispatch(data, compress, options, cb);\n        }\n      })\n      .catch((err) => {\n        //\n        // `onError` is called in the next tick for the same reason that\n        // `callCallbacks` above is.\n        //\n        process.nextTick(onError, this, err, cb);\n      });\n  }\n\n  /**\n   * Dispatches a message.\n   *\n   * @param {(Buffer|String)} data The message to send\n   * @param {Boolean} [compress=false] Specifies whether or not to compress\n   *     `data`\n   * @param {Object} options Options object\n   * @param {Boolean} [options.fin=false] Specifies whether or not to set the\n   *     FIN bit\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Buffer} [options.maskBuffer] The buffer used to store the masking\n   *     key\n   * @param {Number} options.opcode The opcode\n   * @param {Boolean} [options.readOnly=false] Specifies whether `data` can be\n   *     modified\n   * @param {Boolean} [options.rsv1=false] Specifies whether or not to set the\n   *     RSV1 bit\n   * @param {Function} [cb] Callback\n   * @private\n   */\n  dispatch(data, compress, options, cb) {\n    if (!compress) {\n      this.sendFrame(Sender.frame(data, options), cb);\n      return;\n    }\n\n    const perMessageDeflate = this._extensions[PerMessageDeflate.extensionName];\n\n    this._bufferedBytes += options[kByteLength];\n    this._state = DEFLATING;\n    perMessageDeflate.compress(data, options.fin, (_, buf) => {\n      if (this._socket.destroyed) {\n        const err = new Error(\n          'The socket was closed while data was being compressed'\n        );\n\n        callCallbacks(this, err, cb);\n        return;\n      }\n\n      this._bufferedBytes -= options[kByteLength];\n      this._state = DEFAULT;\n      options.readOnly = false;\n      this.sendFrame(Sender.frame(buf, options), cb);\n      this.dequeue();\n    });\n  }\n\n  /**\n   * Executes queued send operations.\n   *\n   * @private\n   */\n  dequeue() {\n    while (this._state === DEFAULT && this._queue.length) {\n      const params = this._queue.shift();\n\n      this._bufferedBytes -= params[3][kByteLength];\n      Reflect.apply(params[0], this, params.slice(1));\n    }\n  }\n\n  /**\n   * Enqueues a send operation.\n   *\n   * @param {Array} params Send operation parameters.\n   * @private\n   */\n  enqueue(params) {\n    this._bufferedBytes += params[3][kByteLength];\n    this._queue.push(params);\n  }\n\n  /**\n   * Sends a frame.\n   *\n   * @param {(Buffer | String)[]} list The frame to send\n   * @param {Function} [cb] Callback\n   * @private\n   */\n  sendFrame(list, cb) {\n    if (list.length === 2) {\n      this._socket.cork();\n      this._socket.write(list[0]);\n      this._socket.write(list[1], cb);\n      this._socket.uncork();\n    } else {\n      this._socket.write(list[0], cb);\n    }\n  }\n}\n\nmodule.exports = Sender;\n\n/**\n * Calls queued callbacks with an error.\n *\n * @param {Sender} sender The `Sender` instance\n * @param {Error} err The error to call the callbacks with\n * @param {Function} [cb] The first callback\n * @private\n */\nfunction callCallbacks(sender, err, cb) {\n  if (typeof cb === 'function') cb(err);\n\n  for (let i = 0; i < sender._queue.length; i++) {\n    const params = sender._queue[i];\n    const callback = params[params.length - 1];\n\n    if (typeof callback === 'function') callback(err);\n  }\n}\n\n/**\n * Handles a `Sender` error.\n *\n * @param {Sender} sender The `Sender` instance\n * @param {Error} err The error\n * @param {Function} [cb] The first pending callback\n * @private\n */\nfunction onError(sender, err, cb) {\n  callCallbacks(sender, err, cb);\n  sender.onerror(err);\n}\n","'use strict';\n\nconst { kForOnEventAttribute, kListener } = require('./constants');\n\nconst kCode = Symbol('kCode');\nconst kData = Symbol('kData');\nconst kError = Symbol('kError');\nconst kMessage = Symbol('kMessage');\nconst kReason = Symbol('kReason');\nconst kTarget = Symbol('kTarget');\nconst kType = Symbol('kType');\nconst kWasClean = Symbol('kWasClean');\n\n/**\n * Class representing an event.\n */\nclass Event {\n  /**\n   * Create a new `Event`.\n   *\n   * @param {String} type The name of the event\n   * @throws {TypeError} If the `type` argument is not specified\n   */\n  constructor(type) {\n    this[kTarget] = null;\n    this[kType] = type;\n  }\n\n  /**\n   * @type {*}\n   */\n  get target() {\n    return this[kTarget];\n  }\n\n  /**\n   * @type {String}\n   */\n  get type() {\n    return this[kType];\n  }\n}\n\nObject.defineProperty(Event.prototype, 'target', { enumerable: true });\nObject.defineProperty(Event.prototype, 'type', { enumerable: true });\n\n/**\n * Class representing a close event.\n *\n * @extends Event\n */\nclass CloseEvent extends Event {\n  /**\n   * Create a new `CloseEvent`.\n   *\n   * @param {String} type The name of the event\n   * @param {Object} [options] A dictionary object that allows for setting\n   *     attributes via object members of the same name\n   * @param {Number} [options.code=0] The status code explaining why the\n   *     connection was closed\n   * @param {String} [options.reason=''] A human-readable string explaining why\n   *     the connection was closed\n   * @param {Boolean} [options.wasClean=false] Indicates whether or not the\n   *     connection was cleanly closed\n   */\n  constructor(type, options = {}) {\n    super(type);\n\n    this[kCode] = options.code === undefined ? 0 : options.code;\n    this[kReason] = options.reason === undefined ? '' : options.reason;\n    this[kWasClean] = options.wasClean === undefined ? false : options.wasClean;\n  }\n\n  /**\n   * @type {Number}\n   */\n  get code() {\n    return this[kCode];\n  }\n\n  /**\n   * @type {String}\n   */\n  get reason() {\n    return this[kReason];\n  }\n\n  /**\n   * @type {Boolean}\n   */\n  get wasClean() {\n    return this[kWasClean];\n  }\n}\n\nObject.defineProperty(CloseEvent.prototype, 'code', { enumerable: true });\nObject.defineProperty(CloseEvent.prototype, 'reason', { enumerable: true });\nObject.defineProperty(CloseEvent.prototype, 'wasClean', { enumerable: true });\n\n/**\n * Class representing an error event.\n *\n * @extends Event\n */\nclass ErrorEvent extends Event {\n  /**\n   * Create a new `ErrorEvent`.\n   *\n   * @param {String} type The name of the event\n   * @param {Object} [options] A dictionary object that allows for setting\n   *     attributes via object members of the same name\n   * @param {*} [options.error=null] The error that generated this event\n   * @param {String} [options.message=''] The error message\n   */\n  constructor(type, options = {}) {\n    super(type);\n\n    this[kError] = options.error === undefined ? null : options.error;\n    this[kMessage] = options.message === undefined ? '' : options.message;\n  }\n\n  /**\n   * @type {*}\n   */\n  get error() {\n    return this[kError];\n  }\n\n  /**\n   * @type {String}\n   */\n  get message() {\n    return this[kMessage];\n  }\n}\n\nObject.defineProperty(ErrorEvent.prototype, 'error', { enumerable: true });\nObject.defineProperty(ErrorEvent.prototype, 'message', { enumerable: true });\n\n/**\n * Class representing a message event.\n *\n * @extends Event\n */\nclass MessageEvent extends Event {\n  /**\n   * Create a new `MessageEvent`.\n   *\n   * @param {String} type The name of the event\n   * @param {Object} [options] A dictionary object that allows for setting\n   *     attributes via object members of the same name\n   * @param {*} [options.data=null] The message content\n   */\n  constructor(type, options = {}) {\n    super(type);\n\n    this[kData] = options.data === undefined ? null : options.data;\n  }\n\n  /**\n   * @type {*}\n   */\n  get data() {\n    return this[kData];\n  }\n}\n\nObject.defineProperty(MessageEvent.prototype, 'data', { enumerable: true });\n\n/**\n * This provides methods for emulating the `EventTarget` interface. It's not\n * meant to be used directly.\n *\n * @mixin\n */\nconst EventTarget = {\n  /**\n   * Register an event listener.\n   *\n   * @param {String} type A string representing the event type to listen for\n   * @param {(Function|Object)} handler The listener to add\n   * @param {Object} [options] An options object specifies characteristics about\n   *     the event listener\n   * @param {Boolean} [options.once=false] A `Boolean` indicating that the\n   *     listener should be invoked at most once after being added. If `true`,\n   *     the listener would be automatically removed when invoked.\n   * @public\n   */\n  addEventListener(type, handler, options = {}) {\n    for (const listener of this.listeners(type)) {\n      if (\n        !options[kForOnEventAttribute] &&\n        listener[kListener] === handler &&\n        !listener[kForOnEventAttribute]\n      ) {\n        return;\n      }\n    }\n\n    let wrapper;\n\n    if (type === 'message') {\n      wrapper = function onMessage(data, isBinary) {\n        const event = new MessageEvent('message', {\n          data: isBinary ? data : data.toString()\n        });\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else if (type === 'close') {\n      wrapper = function onClose(code, message) {\n        const event = new CloseEvent('close', {\n          code,\n          reason: message.toString(),\n          wasClean: this._closeFrameReceived && this._closeFrameSent\n        });\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else if (type === 'error') {\n      wrapper = function onError(error) {\n        const event = new ErrorEvent('error', {\n          error,\n          message: error.message\n        });\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else if (type === 'open') {\n      wrapper = function onOpen() {\n        const event = new Event('open');\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else {\n      return;\n    }\n\n    wrapper[kForOnEventAttribute] = !!options[kForOnEventAttribute];\n    wrapper[kListener] = handler;\n\n    if (options.once) {\n      this.once(type, wrapper);\n    } else {\n      this.on(type, wrapper);\n    }\n  },\n\n  /**\n   * Remove an event listener.\n   *\n   * @param {String} type A string representing the event type to remove\n   * @param {(Function|Object)} handler The listener to remove\n   * @public\n   */\n  removeEventListener(type, handler) {\n    for (const listener of this.listeners(type)) {\n      if (listener[kListener] === handler && !listener[kForOnEventAttribute]) {\n        this.removeListener(type, listener);\n        break;\n      }\n    }\n  }\n};\n\nmodule.exports = {\n  CloseEvent,\n  ErrorEvent,\n  Event,\n  EventTarget,\n  MessageEvent\n};\n\n/**\n * Call an event listener\n *\n * @param {(Function|Object)} listener The listener to call\n * @param {*} thisArg The value to use as `this`` when calling the listener\n * @param {Event} event The event to pass to the listener\n * @private\n */\nfunction callListener(listener, thisArg, event) {\n  if (typeof listener === 'object' && listener.handleEvent) {\n    listener.handleEvent.call(listener, event);\n  } else {\n    listener.call(thisArg, event);\n  }\n}\n","'use strict';\n\nconst { tokenChars } = require('./validation');\n\n/**\n * Adds an offer to the map of extension offers or a parameter to the map of\n * parameters.\n *\n * @param {Object} dest The map of extension offers or parameters\n * @param {String} name The extension or parameter name\n * @param {(Object|Boolean|String)} elem The extension parameters or the\n *     parameter value\n * @private\n */\nfunction push(dest, name, elem) {\n  if (dest[name] === undefined) dest[name] = [elem];\n  else dest[name].push(elem);\n}\n\n/**\n * Parses the `Sec-WebSocket-Extensions` header into an object.\n *\n * @param {String} header The field value of the header\n * @return {Object} The parsed object\n * @public\n */\nfunction parse(header) {\n  const offers = Object.create(null);\n  let params = Object.create(null);\n  let mustUnescape = false;\n  let isEscaping = false;\n  let inQuotes = false;\n  let extensionName;\n  let paramName;\n  let start = -1;\n  let code = -1;\n  let end = -1;\n  let i = 0;\n\n  for (; i < header.length; i++) {\n    code = header.charCodeAt(i);\n\n    if (extensionName === undefined) {\n      if (end === -1 && tokenChars[code] === 1) {\n        if (start === -1) start = i;\n      } else if (\n        i !== 0 &&\n        (code === 0x20 /* ' ' */ || code === 0x09) /* '\\t' */\n      ) {\n        if (end === -1 && start !== -1) end = i;\n      } else if (code === 0x3b /* ';' */ || code === 0x2c /* ',' */) {\n        if (start === -1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n\n        if (end === -1) end = i;\n        const name = header.slice(start, end);\n        if (code === 0x2c) {\n          push(offers, name, params);\n          params = Object.create(null);\n        } else {\n          extensionName = name;\n        }\n\n        start = end = -1;\n      } else {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n    } else if (paramName === undefined) {\n      if (end === -1 && tokenChars[code] === 1) {\n        if (start === -1) start = i;\n      } else if (code === 0x20 || code === 0x09) {\n        if (end === -1 && start !== -1) end = i;\n      } else if (code === 0x3b || code === 0x2c) {\n        if (start === -1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n\n        if (end === -1) end = i;\n        push(params, header.slice(start, end), true);\n        if (code === 0x2c) {\n          push(offers, extensionName, params);\n          params = Object.create(null);\n          extensionName = undefined;\n        }\n\n        start = end = -1;\n      } else if (code === 0x3d /* '=' */ && start !== -1 && end === -1) {\n        paramName = header.slice(start, i);\n        start = end = -1;\n      } else {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n    } else {\n      //\n      // The value of a quoted-string after unescaping must conform to the\n      // token ABNF, so only token characters are valid.\n      // Ref: https://tools.ietf.org/html/rfc6455#section-9.1\n      //\n      if (isEscaping) {\n        if (tokenChars[code] !== 1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n        if (start === -1) start = i;\n        else if (!mustUnescape) mustUnescape = true;\n        isEscaping = false;\n      } else if (inQuotes) {\n        if (tokenChars[code] === 1) {\n          if (start === -1) start = i;\n        } else if (code === 0x22 /* '\"' */ && start !== -1) {\n          inQuotes = false;\n          end = i;\n        } else if (code === 0x5c /* '\\' */) {\n          isEscaping = true;\n        } else {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n      } else if (code === 0x22 && header.charCodeAt(i - 1) === 0x3d) {\n        inQuotes = true;\n      } else if (end === -1 && tokenChars[code] === 1) {\n        if (start === -1) start = i;\n      } else if (start !== -1 && (code === 0x20 || code === 0x09)) {\n        if (end === -1) end = i;\n      } else if (code === 0x3b || code === 0x2c) {\n        if (start === -1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n\n        if (end === -1) end = i;\n        let value = header.slice(start, end);\n        if (mustUnescape) {\n          value = value.replace(/\\\\/g, '');\n          mustUnescape = false;\n        }\n        push(params, paramName, value);\n        if (code === 0x2c) {\n          push(offers, extensionName, params);\n          params = Object.create(null);\n          extensionName = undefined;\n        }\n\n        paramName = undefined;\n        start = end = -1;\n      } else {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n    }\n  }\n\n  if (start === -1 || inQuotes || code === 0x20 || code === 0x09) {\n    throw new SyntaxError('Unexpected end of input');\n  }\n\n  if (end === -1) end = i;\n  const token = header.slice(start, end);\n  if (extensionName === undefined) {\n    push(offers, token, params);\n  } else {\n    if (paramName === undefined) {\n      push(params, token, true);\n    } else if (mustUnescape) {\n      push(params, paramName, token.replace(/\\\\/g, ''));\n    } else {\n      push(params, paramName, token);\n    }\n    push(offers, extensionName, params);\n  }\n\n  return offers;\n}\n\n/**\n * Builds the `Sec-WebSocket-Extensions` header field value.\n *\n * @param {Object} extensions The map of extensions and parameters to format\n * @return {String} A string representing the given object\n * @public\n */\nfunction format(extensions) {\n  return Object.keys(extensions)\n    .map((extension) => {\n      let configurations = extensions[extension];\n      if (!Array.isArray(configurations)) configurations = [configurations];\n      return configurations\n        .map((params) => {\n          return [extension]\n            .concat(\n              Object.keys(params).map((k) => {\n                let values = params[k];\n                if (!Array.isArray(values)) values = [values];\n                return values\n                  .map((v) => (v === true ? k : `${k}=${v}`))\n                  .join('; ');\n              })\n            )\n            .join('; ');\n        })\n        .join(', ');\n    })\n    .join(', ');\n}\n\nmodule.exports = { format, parse };\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^Duplex|Readable$\", \"caughtErrors\": \"none\" }] */\n\n'use strict';\n\nconst EventEmitter = require('events');\nconst https = require('https');\nconst http = require('http');\nconst net = require('net');\nconst tls = require('tls');\nconst { randomBytes, createHash } = require('crypto');\nconst { Duplex, Readable } = require('stream');\nconst { URL } = require('url');\n\nconst PerMessageDeflate = require('./permessage-deflate');\nconst Receiver = require('./receiver');\nconst Sender = require('./sender');\nconst { isBlob } = require('./validation');\n\nconst {\n  BINARY_TYPES,\n  CLOSE_TIMEOUT,\n  EMPTY_BUFFER,\n  GUID,\n  kForOnEventAttribute,\n  kListener,\n  kStatusCode,\n  kWebSocket,\n  NOOP\n} = require('./constants');\nconst {\n  EventTarget: { addEventListener, removeEventListener }\n} = require('./event-target');\nconst { format, parse } = require('./extension');\nconst { toBuffer } = require('./buffer-util');\n\nconst kAborted = Symbol('kAborted');\nconst protocolVersions = [8, 13];\nconst readyStates = ['CONNECTING', 'OPEN', 'CLOSING', 'CLOSED'];\nconst subprotocolRegex = /^[!#$%&'*+\\-.0-9A-Z^_`|a-z~]+$/;\n\n/**\n * Class representing a WebSocket.\n *\n * @extends EventEmitter\n */\nclass WebSocket extends EventEmitter {\n  /**\n   * Create a new `WebSocket`.\n   *\n   * @param {(String|URL)} address The URL to which to connect\n   * @param {(String|String[])} [protocols] The subprotocols\n   * @param {Object} [options] Connection options\n   */\n  constructor(address, protocols, options) {\n    super();\n\n    this._binaryType = BINARY_TYPES[0];\n    this._closeCode = 1006;\n    this._closeFrameReceived = false;\n    this._closeFrameSent = false;\n    this._closeMessage = EMPTY_BUFFER;\n    this._closeTimer = null;\n    this._errorEmitted = false;\n    this._extensions = {};\n    this._paused = false;\n    this._protocol = '';\n    this._readyState = WebSocket.CONNECTING;\n    this._receiver = null;\n    this._sender = null;\n    this._socket = null;\n\n    if (address !== null) {\n      this._bufferedAmount = 0;\n      this._isServer = false;\n      this._redirects = 0;\n\n      if (protocols === undefined) {\n        protocols = [];\n      } else if (!Array.isArray(protocols)) {\n        if (typeof protocols === 'object' && protocols !== null) {\n          options = protocols;\n          protocols = [];\n        } else {\n          protocols = [protocols];\n        }\n      }\n\n      initAsClient(this, address, protocols, options);\n    } else {\n      this._autoPong = options.autoPong;\n      this._closeTimeout = options.closeTimeout;\n      this._isServer = true;\n    }\n  }\n\n  /**\n   * For historical reasons, the custom \"nodebuffer\" type is used by the default\n   * instead of \"blob\".\n   *\n   * @type {String}\n   */\n  get binaryType() {\n    return this._binaryType;\n  }\n\n  set binaryType(type) {\n    if (!BINARY_TYPES.includes(type)) return;\n\n    this._binaryType = type;\n\n    //\n    // Allow to change `binaryType` on the fly.\n    //\n    if (this._receiver) this._receiver._binaryType = type;\n  }\n\n  /**\n   * @type {Number}\n   */\n  get bufferedAmount() {\n    if (!this._socket) return this._bufferedAmount;\n\n    return this._socket._writableState.length + this._sender._bufferedBytes;\n  }\n\n  /**\n   * @type {String}\n   */\n  get extensions() {\n    return Object.keys(this._extensions).join();\n  }\n\n  /**\n   * @type {Boolean}\n   */\n  get isPaused() {\n    return this._paused;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onclose() {\n    return null;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onerror() {\n    return null;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onopen() {\n    return null;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onmessage() {\n    return null;\n  }\n\n  /**\n   * @type {String}\n   */\n  get protocol() {\n    return this._protocol;\n  }\n\n  /**\n   * @type {Number}\n   */\n  get readyState() {\n    return this._readyState;\n  }\n\n  /**\n   * @type {String}\n   */\n  get url() {\n    return this._url;\n  }\n\n  /**\n   * Set up the socket and the internal resources.\n   *\n   * @param {Duplex} socket The network socket between the server and client\n   * @param {Buffer} head The first packet of the upgraded stream\n   * @param {Object} options Options object\n   * @param {Boolean} [options.allowSynchronousEvents=false] Specifies whether\n   *     any of the `'message'`, `'ping'`, and `'pong'` events can be emitted\n   *     multiple times in the same tick\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Number} [options.maxPayload=0] The maximum allowed message size\n   * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n   *     not to skip UTF-8 validation for text and close messages\n   * @private\n   */\n  setSocket(socket, head, options) {\n    const receiver = new Receiver({\n      allowSynchronousEvents: options.allowSynchronousEvents,\n      binaryType: this.binaryType,\n      extensions: this._extensions,\n      isServer: this._isServer,\n      maxPayload: options.maxPayload,\n      skipUTF8Validation: options.skipUTF8Validation\n    });\n\n    const sender = new Sender(socket, this._extensions, options.generateMask);\n\n    this._receiver = receiver;\n    this._sender = sender;\n    this._socket = socket;\n\n    receiver[kWebSocket] = this;\n    sender[kWebSocket] = this;\n    socket[kWebSocket] = this;\n\n    receiver.on('conclude', receiverOnConclude);\n    receiver.on('drain', receiverOnDrain);\n    receiver.on('error', receiverOnError);\n    receiver.on('message', receiverOnMessage);\n    receiver.on('ping', receiverOnPing);\n    receiver.on('pong', receiverOnPong);\n\n    sender.onerror = senderOnError;\n\n    //\n    // These methods may not be available if `socket` is just a `Duplex`.\n    //\n    if (socket.setTimeout) socket.setTimeout(0);\n    if (socket.setNoDelay) socket.setNoDelay();\n\n    if (head.length > 0) socket.unshift(head);\n\n    socket.on('close', socketOnClose);\n    socket.on('data', socketOnData);\n    socket.on('end', socketOnEnd);\n    socket.on('error', socketOnError);\n\n    this._readyState = WebSocket.OPEN;\n    this.emit('open');\n  }\n\n  /**\n   * Emit the `'close'` event.\n   *\n   * @private\n   */\n  emitClose() {\n    if (!this._socket) {\n      this._readyState = WebSocket.CLOSED;\n      this.emit('close', this._closeCode, this._closeMessage);\n      return;\n    }\n\n    if (this._extensions[PerMessageDeflate.extensionName]) {\n      this._extensions[PerMessageDeflate.extensionName].cleanup();\n    }\n\n    this._receiver.removeAllListeners();\n    this._readyState = WebSocket.CLOSED;\n    this.emit('close', this._closeCode, this._closeMessage);\n  }\n\n  /**\n   * Start a closing handshake.\n   *\n   *          +----------+   +-----------+   +----------+\n   *     - - -|ws.close()|-->|close frame|-->|ws.close()|- - -\n   *    |     +----------+   +-----------+   +----------+     |\n   *          +----------+   +-----------+         |\n   * CLOSING  |ws.close()|<--|close frame|<--+-----+       CLOSING\n   *          +----------+   +-----------+   |\n   *    |           |                        |   +---+        |\n   *                +------------------------+-->|fin| - - - -\n   *    |         +---+                      |   +---+\n   *     - - - - -|fin|<---------------------+\n   *              +---+\n   *\n   * @param {Number} [code] Status code explaining why the connection is closing\n   * @param {(String|Buffer)} [data] The reason why the connection is\n   *     closing\n   * @public\n   */\n  close(code, data) {\n    if (this.readyState === WebSocket.CLOSED) return;\n    if (this.readyState === WebSocket.CONNECTING) {\n      const msg = 'WebSocket was closed before the connection was established';\n      abortHandshake(this, this._req, msg);\n      return;\n    }\n\n    if (this.readyState === WebSocket.CLOSING) {\n      if (\n        this._closeFrameSent &&\n        (this._closeFrameReceived || this._receiver._writableState.errorEmitted)\n      ) {\n        this._socket.end();\n      }\n\n      return;\n    }\n\n    this._readyState = WebSocket.CLOSING;\n    this._sender.close(code, data, !this._isServer, (err) => {\n      //\n      // This error is handled by the `'error'` listener on the socket. We only\n      // want to know if the close frame has been sent here.\n      //\n      if (err) return;\n\n      this._closeFrameSent = true;\n\n      if (\n        this._closeFrameReceived ||\n        this._receiver._writableState.errorEmitted\n      ) {\n        this._socket.end();\n      }\n    });\n\n    setCloseTimer(this);\n  }\n\n  /**\n   * Pause the socket.\n   *\n   * @public\n   */\n  pause() {\n    if (\n      this.readyState === WebSocket.CONNECTING ||\n      this.readyState === WebSocket.CLOSED\n    ) {\n      return;\n    }\n\n    this._paused = true;\n    this._socket.pause();\n  }\n\n  /**\n   * Send a ping.\n   *\n   * @param {*} [data] The data to send\n   * @param {Boolean} [mask] Indicates whether or not to mask `data`\n   * @param {Function} [cb] Callback which is executed when the ping is sent\n   * @public\n   */\n  ping(data, mask, cb) {\n    if (this.readyState === WebSocket.CONNECTING) {\n      throw new Error('WebSocket is not open: readyState 0 (CONNECTING)');\n    }\n\n    if (typeof data === 'function') {\n      cb = data;\n      data = mask = undefined;\n    } else if (typeof mask === 'function') {\n      cb = mask;\n      mask = undefined;\n    }\n\n    if (typeof data === 'number') data = data.toString();\n\n    if (this.readyState !== WebSocket.OPEN) {\n      sendAfterClose(this, data, cb);\n      return;\n    }\n\n    if (mask === undefined) mask = !this._isServer;\n    this._sender.ping(data || EMPTY_BUFFER, mask, cb);\n  }\n\n  /**\n   * Send a pong.\n   *\n   * @param {*} [data] The data to send\n   * @param {Boolean} [mask] Indicates whether or not to mask `data`\n   * @param {Function} [cb] Callback which is executed when the pong is sent\n   * @public\n   */\n  pong(data, mask, cb) {\n    if (this.readyState === WebSocket.CONNECTING) {\n      throw new Error('WebSocket is not open: readyState 0 (CONNECTING)');\n    }\n\n    if (typeof data === 'function') {\n      cb = data;\n      data = mask = undefined;\n    } else if (typeof mask === 'function') {\n      cb = mask;\n      mask = undefined;\n    }\n\n    if (typeof data === 'number') data = data.toString();\n\n    if (this.readyState !== WebSocket.OPEN) {\n      sendAfterClose(this, data, cb);\n      return;\n    }\n\n    if (mask === undefined) mask = !this._isServer;\n    this._sender.pong(data || EMPTY_BUFFER, mask, cb);\n  }\n\n  /**\n   * Resume the socket.\n   *\n   * @public\n   */\n  resume() {\n    if (\n      this.readyState === WebSocket.CONNECTING ||\n      this.readyState === WebSocket.CLOSED\n    ) {\n      return;\n    }\n\n    this._paused = false;\n    if (!this._receiver._writableState.needDrain) this._socket.resume();\n  }\n\n  /**\n   * Send a data message.\n   *\n   * @param {*} data The message to send\n   * @param {Object} [options] Options object\n   * @param {Boolean} [options.binary] Specifies whether `data` is binary or\n   *     text\n   * @param {Boolean} [options.compress] Specifies whether or not to compress\n   *     `data`\n   * @param {Boolean} [options.fin=true] Specifies whether the fragment is the\n   *     last one\n   * @param {Boolean} [options.mask] Specifies whether or not to mask `data`\n   * @param {Function} [cb] Callback which is executed when data is written out\n   * @public\n   */\n  send(data, options, cb) {\n    if (this.readyState === WebSocket.CONNECTING) {\n      throw new Error('WebSocket is not open: readyState 0 (CONNECTING)');\n    }\n\n    if (typeof options === 'function') {\n      cb = options;\n      options = {};\n    }\n\n    if (typeof data === 'number') data = data.toString();\n\n    if (this.readyState !== WebSocket.OPEN) {\n      sendAfterClose(this, data, cb);\n      return;\n    }\n\n    const opts = {\n      binary: typeof data !== 'string',\n      mask: !this._isServer,\n      compress: true,\n      fin: true,\n      ...options\n    };\n\n    if (!this._extensions[PerMessageDeflate.extensionName]) {\n      opts.compress = false;\n    }\n\n    this._sender.send(data || EMPTY_BUFFER, opts, cb);\n  }\n\n  /**\n   * Forcibly close the connection.\n   *\n   * @public\n   */\n  terminate() {\n    if (this.readyState === WebSocket.CLOSED) return;\n    if (this.readyState === WebSocket.CONNECTING) {\n      const msg = 'WebSocket was closed before the connection was established';\n      abortHandshake(this, this._req, msg);\n      return;\n    }\n\n    if (this._socket) {\n      this._readyState = WebSocket.CLOSING;\n      this._socket.destroy();\n    }\n  }\n}\n\n/**\n * @constant {Number} CONNECTING\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'CONNECTING', {\n  enumerable: true,\n  value: readyStates.indexOf('CONNECTING')\n});\n\n/**\n * @constant {Number} CONNECTING\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'CONNECTING', {\n  enumerable: true,\n  value: readyStates.indexOf('CONNECTING')\n});\n\n/**\n * @constant {Number} OPEN\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'OPEN', {\n  enumerable: true,\n  value: readyStates.indexOf('OPEN')\n});\n\n/**\n * @constant {Number} OPEN\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'OPEN', {\n  enumerable: true,\n  value: readyStates.indexOf('OPEN')\n});\n\n/**\n * @constant {Number} CLOSING\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'CLOSING', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSING')\n});\n\n/**\n * @constant {Number} CLOSING\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'CLOSING', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSING')\n});\n\n/**\n * @constant {Number} CLOSED\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'CLOSED', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSED')\n});\n\n/**\n * @constant {Number} CLOSED\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'CLOSED', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSED')\n});\n\n[\n  'binaryType',\n  'bufferedAmount',\n  'extensions',\n  'isPaused',\n  'protocol',\n  'readyState',\n  'url'\n].forEach((property) => {\n  Object.defineProperty(WebSocket.prototype, property, { enumerable: true });\n});\n\n//\n// Add the `onopen`, `onerror`, `onclose`, and `onmessage` attributes.\n// See https://html.spec.whatwg.org/multipage/comms.html#the-websocket-interface\n//\n['open', 'error', 'close', 'message'].forEach((method) => {\n  Object.defineProperty(WebSocket.prototype, `on${method}`, {\n    enumerable: true,\n    get() {\n      for (const listener of this.listeners(method)) {\n        if (listener[kForOnEventAttribute]) return listener[kListener];\n      }\n\n      return null;\n    },\n    set(handler) {\n      for (const listener of this.listeners(method)) {\n        if (listener[kForOnEventAttribute]) {\n          this.removeListener(method, listener);\n          break;\n        }\n      }\n\n      if (typeof handler !== 'function') return;\n\n      this.addEventListener(method, handler, {\n        [kForOnEventAttribute]: true\n      });\n    }\n  });\n});\n\nWebSocket.prototype.addEventListener = addEventListener;\nWebSocket.prototype.removeEventListener = removeEventListener;\n\nmodule.exports = WebSocket;\n\n/**\n * Initialize a WebSocket client.\n *\n * @param {WebSocket} websocket The client to initialize\n * @param {(String|URL)} address The URL to which to connect\n * @param {Array} protocols The subprotocols\n * @param {Object} [options] Connection options\n * @param {Boolean} [options.allowSynchronousEvents=true] Specifies whether any\n *     of the `'message'`, `'ping'`, and `'pong'` events can be emitted multiple\n *     times in the same tick\n * @param {Boolean} [options.autoPong=true] Specifies whether or not to\n *     automatically send a pong in response to a ping\n * @param {Number} [options.closeTimeout=30000] Duration in milliseconds to wait\n *     for the closing handshake to finish after `websocket.close()` is called\n * @param {Function} [options.finishRequest] A function which can be used to\n *     customize the headers of each http request before it is sent\n * @param {Boolean} [options.followRedirects=false] Whether or not to follow\n *     redirects\n * @param {Function} [options.generateMask] The function used to generate the\n *     masking key\n * @param {Number} [options.handshakeTimeout] Timeout in milliseconds for the\n *     handshake request\n * @param {Number} [options.maxPayload=104857600] The maximum allowed message\n *     size\n * @param {Number} [options.maxRedirects=10] The maximum number of redirects\n *     allowed\n * @param {String} [options.origin] Value of the `Origin` or\n *     `Sec-WebSocket-Origin` header\n * @param {(Boolean|Object)} [options.perMessageDeflate=true] Enable/disable\n *     permessage-deflate\n * @param {Number} [options.protocolVersion=13] Value of the\n *     `Sec-WebSocket-Version` header\n * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n *     not to skip UTF-8 validation for text and close messages\n * @private\n */\nfunction initAsClient(websocket, address, protocols, options) {\n  const opts = {\n    allowSynchronousEvents: true,\n    autoPong: true,\n    closeTimeout: CLOSE_TIMEOUT,\n    protocolVersion: protocolVersions[1],\n    maxPayload: 100 * 1024 * 1024,\n    skipUTF8Validation: false,\n    perMessageDeflate: true,\n    followRedirects: false,\n    maxRedirects: 10,\n    ...options,\n    socketPath: undefined,\n    hostname: undefined,\n    protocol: undefined,\n    timeout: undefined,\n    method: 'GET',\n    host: undefined,\n    path: undefined,\n    port: undefined\n  };\n\n  websocket._autoPong = opts.autoPong;\n  websocket._closeTimeout = opts.closeTimeout;\n\n  if (!protocolVersions.includes(opts.protocolVersion)) {\n    throw new RangeError(\n      `Unsupported protocol version: ${opts.protocolVersion} ` +\n        `(supported versions: ${protocolVersions.join(', ')})`\n    );\n  }\n\n  let parsedUrl;\n\n  if (address instanceof URL) {\n    parsedUrl = address;\n  } else {\n    try {\n      parsedUrl = new URL(address);\n    } catch (e) {\n      throw new SyntaxError(`Invalid URL: ${address}`);\n    }\n  }\n\n  if (parsedUrl.protocol === 'http:') {\n    parsedUrl.protocol = 'ws:';\n  } else if (parsedUrl.protocol === 'https:') {\n    parsedUrl.protocol = 'wss:';\n  }\n\n  websocket._url = parsedUrl.href;\n\n  const isSecure = parsedUrl.protocol === 'wss:';\n  const isIpcUrl = parsedUrl.protocol === 'ws+unix:';\n  let invalidUrlMessage;\n\n  if (parsedUrl.protocol !== 'ws:' && !isSecure && !isIpcUrl) {\n    invalidUrlMessage =\n      'The URL\\'s protocol must be one of \"ws:\", \"wss:\", ' +\n      '\"http:\", \"https:\", or \"ws+unix:\"';\n  } else if (isIpcUrl && !parsedUrl.pathname) {\n    invalidUrlMessage = \"The URL's pathname is empty\";\n  } else if (parsedUrl.hash) {\n    invalidUrlMessage = 'The URL contains a fragment identifier';\n  }\n\n  if (invalidUrlMessage) {\n    const err = new SyntaxError(invalidUrlMessage);\n\n    if (websocket._redirects === 0) {\n      throw err;\n    } else {\n      emitErrorAndClose(websocket, err);\n      return;\n    }\n  }\n\n  const defaultPort = isSecure ? 443 : 80;\n  const key = randomBytes(16).toString('base64');\n  const request = isSecure ? https.request : http.request;\n  const protocolSet = new Set();\n  let perMessageDeflate;\n\n  opts.createConnection =\n    opts.createConnection || (isSecure ? tlsConnect : netConnect);\n  opts.defaultPort = opts.defaultPort || defaultPort;\n  opts.port = parsedUrl.port || defaultPort;\n  opts.host = parsedUrl.hostname.startsWith('[')\n    ? parsedUrl.hostname.slice(1, -1)\n    : parsedUrl.hostname;\n  opts.headers = {\n    ...opts.headers,\n    'Sec-WebSocket-Version': opts.protocolVersion,\n    'Sec-WebSocket-Key': key,\n    Connection: 'Upgrade',\n    Upgrade: 'websocket'\n  };\n  opts.path = parsedUrl.pathname + parsedUrl.search;\n  opts.timeout = opts.handshakeTimeout;\n\n  if (opts.perMessageDeflate) {\n    perMessageDeflate = new PerMessageDeflate(\n      opts.perMessageDeflate !== true ? opts.perMessageDeflate : {},\n      false,\n      opts.maxPayload\n    );\n    opts.headers['Sec-WebSocket-Extensions'] = format({\n      [PerMessageDeflate.extensionName]: perMessageDeflate.offer()\n    });\n  }\n  if (protocols.length) {\n    for (const protocol of protocols) {\n      if (\n        typeof protocol !== 'string' ||\n        !subprotocolRegex.test(protocol) ||\n        protocolSet.has(protocol)\n      ) {\n        throw new SyntaxError(\n          'An invalid or duplicated subprotocol was specified'\n        );\n      }\n\n      protocolSet.add(protocol);\n    }\n\n    opts.headers['Sec-WebSocket-Protocol'] = protocols.join(',');\n  }\n  if (opts.origin) {\n    if (opts.protocolVersion < 13) {\n      opts.headers['Sec-WebSocket-Origin'] = opts.origin;\n    } else {\n      opts.headers.Origin = opts.origin;\n    }\n  }\n  if (parsedUrl.username || parsedUrl.password) {\n    opts.auth = `${parsedUrl.username}:${parsedUrl.password}`;\n  }\n\n  if (isIpcUrl) {\n    const parts = opts.path.split(':');\n\n    opts.socketPath = parts[0];\n    opts.path = parts[1];\n  }\n\n  let req;\n\n  if (opts.followRedirects) {\n    if (websocket._redirects === 0) {\n      websocket._originalIpc = isIpcUrl;\n      websocket._originalSecure = isSecure;\n      websocket._originalHostOrSocketPath = isIpcUrl\n        ? opts.socketPath\n        : parsedUrl.host;\n\n      const headers = options && options.headers;\n\n      //\n      // Shallow copy the user provided options so that headers can be changed\n      // without mutating the original object.\n      //\n      options = { ...options, headers: {} };\n\n      if (headers) {\n        for (const [key, value] of Object.entries(headers)) {\n          options.headers[key.toLowerCase()] = value;\n        }\n      }\n    } else if (websocket.listenerCount('redirect') === 0) {\n      const isSameHost = isIpcUrl\n        ? websocket._originalIpc\n          ? opts.socketPath === websocket._originalHostOrSocketPath\n          : false\n        : websocket._originalIpc\n          ? false\n          : parsedUrl.host === websocket._originalHostOrSocketPath;\n\n      if (!isSameHost || (websocket._originalSecure && !isSecure)) {\n        //\n        // Match curl 7.77.0 behavior and drop the following headers. These\n        // headers are also dropped when following a redirect to a subdomain.\n        //\n        delete opts.headers.authorization;\n        delete opts.headers.cookie;\n\n        if (!isSameHost) delete opts.headers.host;\n\n        opts.auth = undefined;\n      }\n    }\n\n    //\n    // Match curl 7.77.0 behavior and make the first `Authorization` header win.\n    // If the `Authorization` header is set, then there is nothing to do as it\n    // will take precedence.\n    //\n    if (opts.auth && !options.headers.authorization) {\n      options.headers.authorization =\n        'Basic ' + Buffer.from(opts.auth).toString('base64');\n    }\n\n    req = websocket._req = request(opts);\n\n    if (websocket._redirects) {\n      //\n      // Unlike what is done for the `'upgrade'` event, no early exit is\n      // triggered here if the user calls `websocket.close()` or\n      // `websocket.terminate()` from a listener of the `'redirect'` event. This\n      // is because the user can also call `request.destroy()` with an error\n      // before calling `websocket.close()` or `websocket.terminate()` and this\n      // would result in an error being emitted on the `request` object with no\n      // `'error'` event listeners attached.\n      //\n      websocket.emit('redirect', websocket.url, req);\n    }\n  } else {\n    req = websocket._req = request(opts);\n  }\n\n  if (opts.timeout) {\n    req.on('timeout', () => {\n      abortHandshake(websocket, req, 'Opening handshake has timed out');\n    });\n  }\n\n  req.on('error', (err) => {\n    if (req === null || req[kAborted]) return;\n\n    req = websocket._req = null;\n    emitErrorAndClose(websocket, err);\n  });\n\n  req.on('response', (res) => {\n    const location = res.headers.location;\n    const statusCode = res.statusCode;\n\n    if (\n      location &&\n      opts.followRedirects &&\n      statusCode >= 300 &&\n      statusCode < 400\n    ) {\n      if (++websocket._redirects > opts.maxRedirects) {\n        abortHandshake(websocket, req, 'Maximum redirects exceeded');\n        return;\n      }\n\n      req.abort();\n\n      let addr;\n\n      try {\n        addr = new URL(location, address);\n      } catch (e) {\n        const err = new SyntaxError(`Invalid URL: ${location}`);\n        emitErrorAndClose(websocket, err);\n        return;\n      }\n\n      initAsClient(websocket, addr, protocols, options);\n    } else if (!websocket.emit('unexpected-response', req, res)) {\n      abortHandshake(\n        websocket,\n        req,\n        `Unexpected server response: ${res.statusCode}`\n      );\n    }\n  });\n\n  req.on('upgrade', (res, socket, head) => {\n    websocket.emit('upgrade', res);\n\n    //\n    // The user may have closed the connection from a listener of the\n    // `'upgrade'` event.\n    //\n    if (websocket.readyState !== WebSocket.CONNECTING) return;\n\n    req = websocket._req = null;\n\n    const upgrade = res.headers.upgrade;\n\n    if (upgrade === undefined || upgrade.toLowerCase() !== 'websocket') {\n      abortHandshake(websocket, socket, 'Invalid Upgrade header');\n      return;\n    }\n\n    const digest = createHash('sha1')\n      .update(key + GUID)\n      .digest('base64');\n\n    if (res.headers['sec-websocket-accept'] !== digest) {\n      abortHandshake(websocket, socket, 'Invalid Sec-WebSocket-Accept header');\n      return;\n    }\n\n    const serverProt = res.headers['sec-websocket-protocol'];\n    let protError;\n\n    if (serverProt !== undefined) {\n      if (!protocolSet.size) {\n        protError = 'Server sent a subprotocol but none was requested';\n      } else if (!protocolSet.has(serverProt)) {\n        protError = 'Server sent an invalid subprotocol';\n      }\n    } else if (protocolSet.size) {\n      protError = 'Server sent no subprotocol';\n    }\n\n    if (protError) {\n      abortHandshake(websocket, socket, protError);\n      return;\n    }\n\n    if (serverProt) websocket._protocol = serverProt;\n\n    const secWebSocketExtensions = res.headers['sec-websocket-extensions'];\n\n    if (secWebSocketExtensions !== undefined) {\n      if (!perMessageDeflate) {\n        const message =\n          'Server sent a Sec-WebSocket-Extensions header but no extension ' +\n          'was requested';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      let extensions;\n\n      try {\n        extensions = parse(secWebSocketExtensions);\n      } catch (err) {\n        const message = 'Invalid Sec-WebSocket-Extensions header';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      const extensionNames = Object.keys(extensions);\n\n      if (\n        extensionNames.length !== 1 ||\n        extensionNames[0] !== PerMessageDeflate.extensionName\n      ) {\n        const message = 'Server indicated an extension that was not requested';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      try {\n        perMessageDeflate.accept(extensions[PerMessageDeflate.extensionName]);\n      } catch (err) {\n        const message = 'Invalid Sec-WebSocket-Extensions header';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      websocket._extensions[PerMessageDeflate.extensionName] =\n        perMessageDeflate;\n    }\n\n    websocket.setSocket(socket, head, {\n      allowSynchronousEvents: opts.allowSynchronousEvents,\n      generateMask: opts.generateMask,\n      maxPayload: opts.maxPayload,\n      skipUTF8Validation: opts.skipUTF8Validation\n    });\n  });\n\n  if (opts.finishRequest) {\n    opts.finishRequest(req, websocket);\n  } else {\n    req.end();\n  }\n}\n\n/**\n * Emit the `'error'` and `'close'` events.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @param {Error} The error to emit\n * @private\n */\nfunction emitErrorAndClose(websocket, err) {\n  websocket._readyState = WebSocket.CLOSING;\n  //\n  // The following assignment is practically useless and is done only for\n  // consistency.\n  //\n  websocket._errorEmitted = true;\n  websocket.emit('error', err);\n  websocket.emitClose();\n}\n\n/**\n * Create a `net.Socket` and initiate a connection.\n *\n * @param {Object} options Connection options\n * @return {net.Socket} The newly created socket used to start the connection\n * @private\n */\nfunction netConnect(options) {\n  options.path = options.socketPath;\n  return net.connect(options);\n}\n\n/**\n * Create a `tls.TLSSocket` and initiate a connection.\n *\n * @param {Object} options Connection options\n * @return {tls.TLSSocket} The newly created socket used to start the connection\n * @private\n */\nfunction tlsConnect(options) {\n  options.path = undefined;\n\n  if (!options.servername && options.servername !== '') {\n    options.servername = net.isIP(options.host) ? '' : options.host;\n  }\n\n  return tls.connect(options);\n}\n\n/**\n * Abort the handshake and emit an error.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @param {(http.ClientRequest|net.Socket|tls.Socket)} stream The request to\n *     abort or the socket to destroy\n * @param {String} message The error message\n * @private\n */\nfunction abortHandshake(websocket, stream, message) {\n  websocket._readyState = WebSocket.CLOSING;\n\n  const err = new Error(message);\n  Error.captureStackTrace(err, abortHandshake);\n\n  if (stream.setHeader) {\n    stream[kAborted] = true;\n    stream.abort();\n\n    if (stream.socket && !stream.socket.destroyed) {\n      //\n      // On Node.js >= 14.3.0 `request.abort()` does not destroy the socket if\n      // called after the request completed. See\n      // https://github.com/websockets/ws/issues/1869.\n      //\n      stream.socket.destroy();\n    }\n\n    process.nextTick(emitErrorAndClose, websocket, err);\n  } else {\n    stream.destroy(err);\n    stream.once('error', websocket.emit.bind(websocket, 'error'));\n    stream.once('close', websocket.emitClose.bind(websocket));\n  }\n}\n\n/**\n * Handle cases where the `ping()`, `pong()`, or `send()` methods are called\n * when the `readyState` attribute is `CLOSING` or `CLOSED`.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @param {*} [data] The data to send\n * @param {Function} [cb] Callback\n * @private\n */\nfunction sendAfterClose(websocket, data, cb) {\n  if (data) {\n    const length = isBlob(data) ? data.size : toBuffer(data).length;\n\n    //\n    // The `_bufferedAmount` property is used only when the peer is a client and\n    // the opening handshake fails. Under these circumstances, in fact, the\n    // `setSocket()` method is not called, so the `_socket` and `_sender`\n    // properties are set to `null`.\n    //\n    if (websocket._socket) websocket._sender._bufferedBytes += length;\n    else websocket._bufferedAmount += length;\n  }\n\n  if (cb) {\n    const err = new Error(\n      `WebSocket is not open: readyState ${websocket.readyState} ` +\n        `(${readyStates[websocket.readyState]})`\n    );\n    process.nextTick(cb, err);\n  }\n}\n\n/**\n * The listener of the `Receiver` `'conclude'` event.\n *\n * @param {Number} code The status code\n * @param {Buffer} reason The reason for closing\n * @private\n */\nfunction receiverOnConclude(code, reason) {\n  const websocket = this[kWebSocket];\n\n  websocket._closeFrameReceived = true;\n  websocket._closeMessage = reason;\n  websocket._closeCode = code;\n\n  if (websocket._socket[kWebSocket] === undefined) return;\n\n  websocket._socket.removeListener('data', socketOnData);\n  process.nextTick(resume, websocket._socket);\n\n  if (code === 1005) websocket.close();\n  else websocket.close(code, reason);\n}\n\n/**\n * The listener of the `Receiver` `'drain'` event.\n *\n * @private\n */\nfunction receiverOnDrain() {\n  const websocket = this[kWebSocket];\n\n  if (!websocket.isPaused) websocket._socket.resume();\n}\n\n/**\n * The listener of the `Receiver` `'error'` event.\n *\n * @param {(RangeError|Error)} err The emitted error\n * @private\n */\nfunction receiverOnError(err) {\n  const websocket = this[kWebSocket];\n\n  if (websocket._socket[kWebSocket] !== undefined) {\n    websocket._socket.removeListener('data', socketOnData);\n\n    //\n    // On Node.js < 14.0.0 the `'error'` event is emitted synchronously. See\n    // https://github.com/websockets/ws/issues/1940.\n    //\n    process.nextTick(resume, websocket._socket);\n\n    websocket.close(err[kStatusCode]);\n  }\n\n  if (!websocket._errorEmitted) {\n    websocket._errorEmitted = true;\n    websocket.emit('error', err);\n  }\n}\n\n/**\n * The listener of the `Receiver` `'finish'` event.\n *\n * @private\n */\nfunction receiverOnFinish() {\n  this[kWebSocket].emitClose();\n}\n\n/**\n * The listener of the `Receiver` `'message'` event.\n *\n * @param {Buffer|ArrayBuffer|Buffer[])} data The message\n * @param {Boolean} isBinary Specifies whether the message is binary or not\n * @private\n */\nfunction receiverOnMessage(data, isBinary) {\n  this[kWebSocket].emit('message', data, isBinary);\n}\n\n/**\n * The listener of the `Receiver` `'ping'` event.\n *\n * @param {Buffer} data The data included in the ping frame\n * @private\n */\nfunction receiverOnPing(data) {\n  const websocket = this[kWebSocket];\n\n  if (websocket._autoPong) websocket.pong(data, !this._isServer, NOOP);\n  websocket.emit('ping', data);\n}\n\n/**\n * The listener of the `Receiver` `'pong'` event.\n *\n * @param {Buffer} data The data included in the pong frame\n * @private\n */\nfunction receiverOnPong(data) {\n  this[kWebSocket].emit('pong', data);\n}\n\n/**\n * Resume a readable stream\n *\n * @param {Readable} stream The readable stream\n * @private\n */\nfunction resume(stream) {\n  stream.resume();\n}\n\n/**\n * The `Sender` error event handler.\n *\n * @param {Error} The error\n * @private\n */\nfunction senderOnError(err) {\n  const websocket = this[kWebSocket];\n\n  if (websocket.readyState === WebSocket.CLOSED) return;\n  if (websocket.readyState === WebSocket.OPEN) {\n    websocket._readyState = WebSocket.CLOSING;\n    setCloseTimer(websocket);\n  }\n\n  //\n  // `socket.end()` is used instead of `socket.destroy()` to allow the other\n  // peer to finish sending queued data. There is no need to set a timer here\n  // because `CLOSING` means that it is already set or not needed.\n  //\n  this._socket.end();\n\n  if (!websocket._errorEmitted) {\n    websocket._errorEmitted = true;\n    websocket.emit('error', err);\n  }\n}\n\n/**\n * Set a timer to destroy the underlying raw socket of a WebSocket.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @private\n */\nfunction setCloseTimer(websocket) {\n  websocket._closeTimer = setTimeout(\n    websocket._socket.destroy.bind(websocket._socket),\n    websocket._closeTimeout\n  );\n}\n\n/**\n * The listener of the socket `'close'` event.\n *\n * @private\n */\nfunction socketOnClose() {\n  const websocket = this[kWebSocket];\n\n  this.removeListener('close', socketOnClose);\n  this.removeListener('data', socketOnData);\n  this.removeListener('end', socketOnEnd);\n\n  websocket._readyState = WebSocket.CLOSING;\n\n  //\n  // The close frame might not have been received or the `'end'` event emitted,\n  // for example, if the socket was destroyed due to an error. Ensure that the\n  // `receiver` stream is closed after writing any remaining buffered data to\n  // it. If the readable side of the socket is in flowing mode then there is no\n  // buffered data as everything has been already written. If instead, the\n  // socket is paused, any possible buffered data will be read as a single\n  // chunk.\n  //\n  if (\n    !this._readableState.endEmitted &&\n    !websocket._closeFrameReceived &&\n    !websocket._receiver._writableState.errorEmitted &&\n    this._readableState.length !== 0\n  ) {\n    const chunk = this.read(this._readableState.length);\n\n    websocket._receiver.write(chunk);\n  }\n\n  websocket._receiver.end();\n\n  this[kWebSocket] = undefined;\n\n  clearTimeout(websocket._closeTimer);\n\n  if (\n    websocket._receiver._writableState.finished ||\n    websocket._receiver._writableState.errorEmitted\n  ) {\n    websocket.emitClose();\n  } else {\n    websocket._receiver.on('error', receiverOnFinish);\n    websocket._receiver.on('finish', receiverOnFinish);\n  }\n}\n\n/**\n * The listener of the socket `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction socketOnData(chunk) {\n  if (!this[kWebSocket]._receiver.write(chunk)) {\n    this.pause();\n  }\n}\n\n/**\n * The listener of the socket `'end'` event.\n *\n * @private\n */\nfunction socketOnEnd() {\n  const websocket = this[kWebSocket];\n\n  websocket._readyState = WebSocket.CLOSING;\n  websocket._receiver.end();\n  this.end();\n}\n\n/**\n * The listener of the socket `'error'` event.\n *\n * @private\n */\nfunction socketOnError() {\n  const websocket = this[kWebSocket];\n\n  this.removeListener('error', socketOnError);\n  this.on('error', NOOP);\n\n  if (websocket) {\n    websocket._readyState = WebSocket.CLOSING;\n    this.destroy();\n  }\n}\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^WebSocket$\" }] */\n'use strict';\n\nconst WebSocket = require('./websocket');\nconst { Duplex } = require('stream');\n\n/**\n * Emits the `'close'` event on a stream.\n *\n * @param {Duplex} stream The stream.\n * @private\n */\nfunction emitClose(stream) {\n  stream.emit('close');\n}\n\n/**\n * The listener of the `'end'` event.\n *\n * @private\n */\nfunction duplexOnEnd() {\n  if (!this.destroyed && this._writableState.finished) {\n    this.destroy();\n  }\n}\n\n/**\n * The listener of the `'error'` event.\n *\n * @param {Error} err The error\n * @private\n */\nfunction duplexOnError(err) {\n  this.removeListener('error', duplexOnError);\n  this.destroy();\n  if (this.listenerCount('error') === 0) {\n    // Do not suppress the throwing behavior.\n    this.emit('error', err);\n  }\n}\n\n/**\n * Wraps a `WebSocket` in a duplex stream.\n *\n * @param {WebSocket} ws The `WebSocket` to wrap\n * @param {Object} [options] The options for the `Duplex` constructor\n * @return {Duplex} The duplex stream\n * @public\n */\nfunction createWebSocketStream(ws, options) {\n  let terminateOnDestroy = true;\n\n  const duplex = new Duplex({\n    ...options,\n    autoDestroy: false,\n    emitClose: false,\n    objectMode: false,\n    writableObjectMode: false\n  });\n\n  ws.on('message', function message(msg, isBinary) {\n    const data =\n      !isBinary && duplex._readableState.objectMode ? msg.toString() : msg;\n\n    if (!duplex.push(data)) ws.pause();\n  });\n\n  ws.once('error', function error(err) {\n    if (duplex.destroyed) return;\n\n    // Prevent `ws.terminate()` from being called by `duplex._destroy()`.\n    //\n    // - If the `'error'` event is emitted before the `'open'` event, then\n    //   `ws.terminate()` is a noop as no socket is assigned.\n    // - Otherwise, the error is re-emitted by the listener of the `'error'`\n    //   event of the `Receiver` object. The listener already closes the\n    //   connection by calling `ws.close()`. This allows a close frame to be\n    //   sent to the other peer. If `ws.terminate()` is called right after this,\n    //   then the close frame might not be sent.\n    terminateOnDestroy = false;\n    duplex.destroy(err);\n  });\n\n  ws.once('close', function close() {\n    if (duplex.destroyed) return;\n\n    duplex.push(null);\n  });\n\n  duplex._destroy = function (err, callback) {\n    if (ws.readyState === ws.CLOSED) {\n      callback(err);\n      process.nextTick(emitClose, duplex);\n      return;\n    }\n\n    let called = false;\n\n    ws.once('error', function error(err) {\n      called = true;\n      callback(err);\n    });\n\n    ws.once('close', function close() {\n      if (!called) callback(err);\n      process.nextTick(emitClose, duplex);\n    });\n\n    if (terminateOnDestroy) ws.terminate();\n  };\n\n  duplex._final = function (callback) {\n    if (ws.readyState === ws.CONNECTING) {\n      ws.once('open', function open() {\n        duplex._final(callback);\n      });\n      return;\n    }\n\n    // If the value of the `_socket` property is `null` it means that `ws` is a\n    // client websocket and the handshake failed. In fact, when this happens, a\n    // socket is never assigned to the websocket. Wait for the `'error'` event\n    // that will be emitted by the websocket.\n    if (ws._socket === null) return;\n\n    if (ws._socket._writableState.finished) {\n      callback();\n      if (duplex._readableState.endEmitted) duplex.destroy();\n    } else {\n      ws._socket.once('finish', function finish() {\n        // `duplex` is not destroyed here because the `'end'` event will be\n        // emitted on `duplex` after this `'finish'` event. The EOF signaling\n        // `null` chunk is, in fact, pushed when the websocket emits `'close'`.\n        callback();\n      });\n      ws.close();\n    }\n  };\n\n  duplex._read = function () {\n    if (ws.isPaused) ws.resume();\n  };\n\n  duplex._write = function (chunk, encoding, callback) {\n    if (ws.readyState === ws.CONNECTING) {\n      ws.once('open', function open() {\n        duplex._write(chunk, encoding, callback);\n      });\n      return;\n    }\n\n    ws.send(chunk, callback);\n  };\n\n  duplex.on('end', duplexOnEnd);\n  duplex.on('error', duplexOnError);\n  return duplex;\n}\n\nmodule.exports = createWebSocketStream;\n","'use strict';\n\nconst { tokenChars } = require('./validation');\n\n/**\n * Parses the `Sec-WebSocket-Protocol` header into a set of subprotocol names.\n *\n * @param {String} header The field value of the header\n * @return {Set} The subprotocol names\n * @public\n */\nfunction parse(header) {\n  const protocols = new Set();\n  let start = -1;\n  let end = -1;\n  let i = 0;\n\n  for (i; i < header.length; i++) {\n    const code = header.charCodeAt(i);\n\n    if (end === -1 && tokenChars[code] === 1) {\n      if (start === -1) start = i;\n    } else if (\n      i !== 0 &&\n      (code === 0x20 /* ' ' */ || code === 0x09) /* '\\t' */\n    ) {\n      if (end === -1 && start !== -1) end = i;\n    } else if (code === 0x2c /* ',' */) {\n      if (start === -1) {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n\n      if (end === -1) end = i;\n\n      const protocol = header.slice(start, end);\n\n      if (protocols.has(protocol)) {\n        throw new SyntaxError(`The \"${protocol}\" subprotocol is duplicated`);\n      }\n\n      protocols.add(protocol);\n      start = end = -1;\n    } else {\n      throw new SyntaxError(`Unexpected character at index ${i}`);\n    }\n  }\n\n  if (start === -1 || end !== -1) {\n    throw new SyntaxError('Unexpected end of input');\n  }\n\n  const protocol = header.slice(start, i);\n\n  if (protocols.has(protocol)) {\n    throw new SyntaxError(`The \"${protocol}\" subprotocol is duplicated`);\n  }\n\n  protocols.add(protocol);\n  return protocols;\n}\n\nmodule.exports = { parse };\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^Duplex$\", \"caughtErrors\": \"none\" }] */\n\n'use strict';\n\nconst EventEmitter = require('events');\nconst http = require('http');\nconst { Duplex } = require('stream');\nconst { createHash } = require('crypto');\n\nconst extension = require('./extension');\nconst PerMessageDeflate = require('./permessage-deflate');\nconst subprotocol = require('./subprotocol');\nconst WebSocket = require('./websocket');\nconst { CLOSE_TIMEOUT, GUID, kWebSocket } = require('./constants');\n\nconst keyRegex = /^[+/0-9A-Za-z]{22}==$/;\n\nconst RUNNING = 0;\nconst CLOSING = 1;\nconst CLOSED = 2;\n\n/**\n * Class representing a WebSocket server.\n *\n * @extends EventEmitter\n */\nclass WebSocketServer extends EventEmitter {\n  /**\n   * Create a `WebSocketServer` instance.\n   *\n   * @param {Object} options Configuration options\n   * @param {Boolean} [options.allowSynchronousEvents=true] Specifies whether\n   *     any of the `'message'`, `'ping'`, and `'pong'` events can be emitted\n   *     multiple times in the same tick\n   * @param {Boolean} [options.autoPong=true] Specifies whether or not to\n   *     automatically send a pong in response to a ping\n   * @param {Number} [options.backlog=511] The maximum length of the queue of\n   *     pending connections\n   * @param {Boolean} [options.clientTracking=true] Specifies whether or not to\n   *     track clients\n   * @param {Number} [options.closeTimeout=30000] Duration in milliseconds to\n   *     wait for the closing handshake to finish after `websocket.close()` is\n   *     called\n   * @param {Function} [options.handleProtocols] A hook to handle protocols\n   * @param {String} [options.host] The hostname where to bind the server\n   * @param {Number} [options.maxPayload=104857600] The maximum allowed message\n   *     size\n   * @param {Boolean} [options.noServer=false] Enable no server mode\n   * @param {String} [options.path] Accept only connections matching this path\n   * @param {(Boolean|Object)} [options.perMessageDeflate=false] Enable/disable\n   *     permessage-deflate\n   * @param {Number} [options.port] The port where to bind the server\n   * @param {(http.Server|https.Server)} [options.server] A pre-created HTTP/S\n   *     server to use\n   * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n   *     not to skip UTF-8 validation for text and close messages\n   * @param {Function} [options.verifyClient] A hook to reject connections\n   * @param {Function} [options.WebSocket=WebSocket] Specifies the `WebSocket`\n   *     class to use. It must be the `WebSocket` class or class that extends it\n   * @param {Function} [callback] A listener for the `listening` event\n   */\n  constructor(options, callback) {\n    super();\n\n    options = {\n      allowSynchronousEvents: true,\n      autoPong: true,\n      maxPayload: 100 * 1024 * 1024,\n      skipUTF8Validation: false,\n      perMessageDeflate: false,\n      handleProtocols: null,\n      clientTracking: true,\n      closeTimeout: CLOSE_TIMEOUT,\n      verifyClient: null,\n      noServer: false,\n      backlog: null, // use default (511 as implemented in net.js)\n      server: null,\n      host: null,\n      path: null,\n      port: null,\n      WebSocket,\n      ...options\n    };\n\n    if (\n      (options.port == null && !options.server && !options.noServer) ||\n      (options.port != null && (options.server || options.noServer)) ||\n      (options.server && options.noServer)\n    ) {\n      throw new TypeError(\n        'One and only one of the \"port\", \"server\", or \"noServer\" options ' +\n          'must be specified'\n      );\n    }\n\n    if (options.port != null) {\n      this._server = http.createServer((req, res) => {\n        const body = http.STATUS_CODES[426];\n\n        res.writeHead(426, {\n          'Content-Length': body.length,\n          'Content-Type': 'text/plain'\n        });\n        res.end(body);\n      });\n      this._server.listen(\n        options.port,\n        options.host,\n        options.backlog,\n        callback\n      );\n    } else if (options.server) {\n      this._server = options.server;\n    }\n\n    if (this._server) {\n      const emitConnection = this.emit.bind(this, 'connection');\n\n      this._removeListeners = addListeners(this._server, {\n        listening: this.emit.bind(this, 'listening'),\n        error: this.emit.bind(this, 'error'),\n        upgrade: (req, socket, head) => {\n          this.handleUpgrade(req, socket, head, emitConnection);\n        }\n      });\n    }\n\n    if (options.perMessageDeflate === true) options.perMessageDeflate = {};\n    if (options.clientTracking) {\n      this.clients = new Set();\n      this._shouldEmitClose = false;\n    }\n\n    this.options = options;\n    this._state = RUNNING;\n  }\n\n  /**\n   * Returns the bound address, the address family name, and port of the server\n   * as reported by the operating system if listening on an IP socket.\n   * If the server is listening on a pipe or UNIX domain socket, the name is\n   * returned as a string.\n   *\n   * @return {(Object|String|null)} The address of the server\n   * @public\n   */\n  address() {\n    if (this.options.noServer) {\n      throw new Error('The server is operating in \"noServer\" mode');\n    }\n\n    if (!this._server) return null;\n    return this._server.address();\n  }\n\n  /**\n   * Stop the server from accepting new connections and emit the `'close'` event\n   * when all existing connections are closed.\n   *\n   * @param {Function} [cb] A one-time listener for the `'close'` event\n   * @public\n   */\n  close(cb) {\n    if (this._state === CLOSED) {\n      if (cb) {\n        this.once('close', () => {\n          cb(new Error('The server is not running'));\n        });\n      }\n\n      process.nextTick(emitClose, this);\n      return;\n    }\n\n    if (cb) this.once('close', cb);\n\n    if (this._state === CLOSING) return;\n    this._state = CLOSING;\n\n    if (this.options.noServer || this.options.server) {\n      if (this._server) {\n        this._removeListeners();\n        this._removeListeners = this._server = null;\n      }\n\n      if (this.clients) {\n        if (!this.clients.size) {\n          process.nextTick(emitClose, this);\n        } else {\n          this._shouldEmitClose = true;\n        }\n      } else {\n        process.nextTick(emitClose, this);\n      }\n    } else {\n      const server = this._server;\n\n      this._removeListeners();\n      this._removeListeners = this._server = null;\n\n      //\n      // The HTTP/S server was created internally. Close it, and rely on its\n      // `'close'` event.\n      //\n      server.close(() => {\n        emitClose(this);\n      });\n    }\n  }\n\n  /**\n   * See if a given request should be handled by this server instance.\n   *\n   * @param {http.IncomingMessage} req Request object to inspect\n   * @return {Boolean} `true` if the request is valid, else `false`\n   * @public\n   */\n  shouldHandle(req) {\n    if (this.options.path) {\n      const index = req.url.indexOf('?');\n      const pathname = index !== -1 ? req.url.slice(0, index) : req.url;\n\n      if (pathname !== this.options.path) return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Handle a HTTP Upgrade request.\n   *\n   * @param {http.IncomingMessage} req The request object\n   * @param {Duplex} socket The network socket between the server and client\n   * @param {Buffer} head The first packet of the upgraded stream\n   * @param {Function} cb Callback\n   * @public\n   */\n  handleUpgrade(req, socket, head, cb) {\n    socket.on('error', socketOnError);\n\n    const key = req.headers['sec-websocket-key'];\n    const upgrade = req.headers.upgrade;\n    const version = +req.headers['sec-websocket-version'];\n\n    if (req.method !== 'GET') {\n      const message = 'Invalid HTTP method';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 405, message);\n      return;\n    }\n\n    if (upgrade === undefined || upgrade.toLowerCase() !== 'websocket') {\n      const message = 'Invalid Upgrade header';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n      return;\n    }\n\n    if (key === undefined || !keyRegex.test(key)) {\n      const message = 'Missing or invalid Sec-WebSocket-Key header';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n      return;\n    }\n\n    if (version !== 13 && version !== 8) {\n      const message = 'Missing or invalid Sec-WebSocket-Version header';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 400, message, {\n        'Sec-WebSocket-Version': '13, 8'\n      });\n      return;\n    }\n\n    if (!this.shouldHandle(req)) {\n      abortHandshake(socket, 400);\n      return;\n    }\n\n    const secWebSocketProtocol = req.headers['sec-websocket-protocol'];\n    let protocols = new Set();\n\n    if (secWebSocketProtocol !== undefined) {\n      try {\n        protocols = subprotocol.parse(secWebSocketProtocol);\n      } catch (err) {\n        const message = 'Invalid Sec-WebSocket-Protocol header';\n        abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n        return;\n      }\n    }\n\n    const secWebSocketExtensions = req.headers['sec-websocket-extensions'];\n    const extensions = {};\n\n    if (\n      this.options.perMessageDeflate &&\n      secWebSocketExtensions !== undefined\n    ) {\n      const perMessageDeflate = new PerMessageDeflate(\n        this.options.perMessageDeflate,\n        true,\n        this.options.maxPayload\n      );\n\n      try {\n        const offers = extension.parse(secWebSocketExtensions);\n\n        if (offers[PerMessageDeflate.extensionName]) {\n          perMessageDeflate.accept(offers[PerMessageDeflate.extensionName]);\n          extensions[PerMessageDeflate.extensionName] = perMessageDeflate;\n        }\n      } catch (err) {\n        const message =\n          'Invalid or unacceptable Sec-WebSocket-Extensions header';\n        abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n        return;\n      }\n    }\n\n    //\n    // Optionally call external client verification handler.\n    //\n    if (this.options.verifyClient) {\n      const info = {\n        origin:\n          req.headers[`${version === 8 ? 'sec-websocket-origin' : 'origin'}`],\n        secure: !!(req.socket.authorized || req.socket.encrypted),\n        req\n      };\n\n      if (this.options.verifyClient.length === 2) {\n        this.options.verifyClient(info, (verified, code, message, headers) => {\n          if (!verified) {\n            return abortHandshake(socket, code || 401, message, headers);\n          }\n\n          this.completeUpgrade(\n            extensions,\n            key,\n            protocols,\n            req,\n            socket,\n            head,\n            cb\n          );\n        });\n        return;\n      }\n\n      if (!this.options.verifyClient(info)) return abortHandshake(socket, 401);\n    }\n\n    this.completeUpgrade(extensions, key, protocols, req, socket, head, cb);\n  }\n\n  /**\n   * Upgrade the connection to WebSocket.\n   *\n   * @param {Object} extensions The accepted extensions\n   * @param {String} key The value of the `Sec-WebSocket-Key` header\n   * @param {Set} protocols The subprotocols\n   * @param {http.IncomingMessage} req The request object\n   * @param {Duplex} socket The network socket between the server and client\n   * @param {Buffer} head The first packet of the upgraded stream\n   * @param {Function} cb Callback\n   * @throws {Error} If called more than once with the same socket\n   * @private\n   */\n  completeUpgrade(extensions, key, protocols, req, socket, head, cb) {\n    //\n    // Destroy the socket if the client has already sent a FIN packet.\n    //\n    if (!socket.readable || !socket.writable) return socket.destroy();\n\n    if (socket[kWebSocket]) {\n      throw new Error(\n        'server.handleUpgrade() was called more than once with the same ' +\n          'socket, possibly due to a misconfiguration'\n      );\n    }\n\n    if (this._state > RUNNING) return abortHandshake(socket, 503);\n\n    const digest = createHash('sha1')\n      .update(key + GUID)\n      .digest('base64');\n\n    const headers = [\n      'HTTP/1.1 101 Switching Protocols',\n      'Upgrade: websocket',\n      'Connection: Upgrade',\n      `Sec-WebSocket-Accept: ${digest}`\n    ];\n\n    const ws = new this.options.WebSocket(null, undefined, this.options);\n\n    if (protocols.size) {\n      //\n      // Optionally call external protocol selection handler.\n      //\n      const protocol = this.options.handleProtocols\n        ? this.options.handleProtocols(protocols, req)\n        : protocols.values().next().value;\n\n      if (protocol) {\n        headers.push(`Sec-WebSocket-Protocol: ${protocol}`);\n        ws._protocol = protocol;\n      }\n    }\n\n    if (extensions[PerMessageDeflate.extensionName]) {\n      const params = extensions[PerMessageDeflate.extensionName].params;\n      const value = extension.format({\n        [PerMessageDeflate.extensionName]: [params]\n      });\n      headers.push(`Sec-WebSocket-Extensions: ${value}`);\n      ws._extensions = extensions;\n    }\n\n    //\n    // Allow external modification/inspection of handshake headers.\n    //\n    this.emit('headers', headers, req);\n\n    socket.write(headers.concat('\\r\\n').join('\\r\\n'));\n    socket.removeListener('error', socketOnError);\n\n    ws.setSocket(socket, head, {\n      allowSynchronousEvents: this.options.allowSynchronousEvents,\n      maxPayload: this.options.maxPayload,\n      skipUTF8Validation: this.options.skipUTF8Validation\n    });\n\n    if (this.clients) {\n      this.clients.add(ws);\n      ws.on('close', () => {\n        this.clients.delete(ws);\n\n        if (this._shouldEmitClose && !this.clients.size) {\n          process.nextTick(emitClose, this);\n        }\n      });\n    }\n\n    cb(ws, req);\n  }\n}\n\nmodule.exports = WebSocketServer;\n\n/**\n * Add event listeners on an `EventEmitter` using a map of <event, listener>\n * pairs.\n *\n * @param {EventEmitter} server The event emitter\n * @param {Object.<String, Function>} map The listeners to add\n * @return {Function} A function that will remove the added listeners when\n *     called\n * @private\n */\nfunction addListeners(server, map) {\n  for (const event of Object.keys(map)) server.on(event, map[event]);\n\n  return function removeListeners() {\n    for (const event of Object.keys(map)) {\n      server.removeListener(event, map[event]);\n    }\n  };\n}\n\n/**\n * Emit a `'close'` event on an `EventEmitter`.\n *\n * @param {EventEmitter} server The event emitter\n * @private\n */\nfunction emitClose(server) {\n  server._state = CLOSED;\n  server.emit('close');\n}\n\n/**\n * Handle socket errors.\n *\n * @private\n */\nfunction socketOnError() {\n  this.destroy();\n}\n\n/**\n * Close the connection when preconditions are not fulfilled.\n *\n * @param {Duplex} socket The socket of the upgrade request\n * @param {Number} code The HTTP response status code\n * @param {String} [message] The HTTP response body\n * @param {Object} [headers] Additional HTTP response headers\n * @private\n */\nfunction abortHandshake(socket, code, message, headers) {\n  //\n  // The socket is writable unless the user destroyed or ended it before calling\n  // `server.handleUpgrade()` or in the `verifyClient` function, which is a user\n  // error. Handling this does not make much sense as the worst that can happen\n  // is that some of the data written by the user might be discarded due to the\n  // call to `socket.end()` below, which triggers an `'error'` event that in\n  // turn causes the socket to be destroyed.\n  //\n  message = message || http.STATUS_CODES[code];\n  headers = {\n    Connection: 'close',\n    'Content-Type': 'text/html',\n    'Content-Length': Buffer.byteLength(message),\n    ...headers\n  };\n\n  socket.once('finish', socket.destroy);\n\n  socket.end(\n    `HTTP/1.1 ${code} ${http.STATUS_CODES[code]}\\r\\n` +\n      Object.keys(headers)\n        .map((h) => `${h}: ${headers[h]}`)\n        .join('\\r\\n') +\n      '\\r\\n\\r\\n' +\n      message\n  );\n}\n\n/**\n * Emit a `'wsClientError'` event on a `WebSocketServer` if there is at least\n * one listener for it, otherwise call `abortHandshake()`.\n *\n * @param {WebSocketServer} server The WebSocket server\n * @param {http.IncomingMessage} req The request object\n * @param {Duplex} socket The socket of the upgrade request\n * @param {Number} code The HTTP response status code\n * @param {String} message The HTTP response body\n * @param {Object} [headers] The HTTP response headers\n * @private\n */\nfunction abortHandshakeOrEmitwsClientError(\n  server,\n  req,\n  socket,\n  code,\n  message,\n  headers\n) {\n  if (server.listenerCount('wsClientError')) {\n    const err = new Error(message);\n    Error.captureStackTrace(err, abortHandshakeOrEmitwsClientError);\n\n    server.emit('wsClientError', err, socket, req);\n  } else {\n    abortHandshake(socket, code, message, headers);\n  }\n}\n","import createWebSocketStream from './lib/stream.js';\nimport Receiver from './lib/receiver.js';\nimport Sender from './lib/sender.js';\nimport WebSocket from './lib/websocket.js';\nimport WebSocketServer from './lib/websocket-server.js';\n\nexport { createWebSocketStream, Receiver, Sender, WebSocket, WebSocketServer };\nexport default WebSocket;\n","import type { ModelMetadata } from '../types';\n\n// OCI GenAI regions\nexport type OCIGenAIRegion =\n  | 'us-chicago-1'\n  | 'eu-frankfurt-1'\n  | 'ap-osaka-1'\n  | 'uk-london-1'\n  | 'us-ashburn-1'\n  | 'ap-mumbai-1'\n  | 'us-sanjose-1'\n  | 'ap-singapore-1'\n  | 'ap-seoul-1'\n  | 'sa-saopaulo-1'\n  | 'ap-sydney-1'\n  | 'ap-tokyo-1'\n  | 'ca-toronto-1';\n\n// Regions where each model family is available (based on OCI docs Jan 2026)\nconst GROK_REGIONS: OCIGenAIRegion[] = ['us-chicago-1', 'us-ashburn-1'];\nconst GEMINI_REGIONS: OCIGenAIRegion[] = ['us-chicago-1', 'eu-frankfurt-1', 'us-ashburn-1'];\nconst COHERE_REGIONS: OCIGenAIRegion[] = [\n  'us-chicago-1',\n  'eu-frankfurt-1',\n  'ap-osaka-1',\n  'uk-london-1',\n  'us-ashburn-1',\n  'ap-mumbai-1',\n  'us-sanjose-1',\n  'ap-singapore-1',\n  'ap-seoul-1',\n  'sa-saopaulo-1',\n  'ap-sydney-1',\n  'ap-tokyo-1',\n  'ca-toronto-1',\n];\nconst LLAMA_REGIONS: OCIGenAIRegion[] = [\n  'us-chicago-1',\n  'eu-frankfurt-1',\n  'ap-osaka-1',\n  'uk-london-1',\n  'us-ashburn-1',\n  'ap-mumbai-1',\n  'us-sanjose-1',\n  'ap-singapore-1',\n  'ap-seoul-1',\n  'sa-saopaulo-1',\n  'ap-sydney-1',\n  'ap-tokyo-1',\n  'ca-toronto-1',\n];\nconst OPENAI_REGIONS: OCIGenAIRegion[] = ['us-chicago-1', 'eu-frankfurt-1', 'us-ashburn-1'];\n\n// Extended metadata with region support\ninterface ExtendedModelMetadata extends ModelMetadata {\n  regions: OCIGenAIRegion[];\n  dedicatedOnly?: boolean;\n  /** Recommended for coding agents (default enabled in setup) */\n  codingRecommended?: boolean;\n  /** Why this model is good/bad for coding */\n  codingNote?: string;\n  /** Override capabilities to include reasoning */\n  capabilities: ModelMetadata['capabilities'] & {\n    reasoning?: boolean;\n  };\n}\n\nexport const MODEL_CATALOG: ExtendedModelMetadata[] = [\n  // ==========================================================================\n  // xAI Grok models (US regions only)\n  // ==========================================================================\n  {\n    id: 'xai.grok-code-fast-1',\n    name: 'Grok Code Fast 1',\n    family: 'grok',\n    capabilities: { streaming: true, tools: true, vision: false },\n    contextWindow: 131072,\n    speed: 'very-fast',\n    regions: GROK_REGIONS,\n    codingRecommended: true,\n    codingNote: 'Purpose-built for code generation and understanding',\n  },\n  {\n    id: 'xai.grok-4-1-fast-reasoning',\n    name: 'Grok 4.1 Fast Reasoning',\n    family: 'grok',\n    // Note: Grok models don't support reasoningEffort parameter despite the \"-reasoning\" name\n    // They throw: \"This model does not support `reasoning_effort`\"\n    // Reasoning is built-in but not controllable via API parameter\n    capabilities: { streaming: true, tools: true, vision: false },\n    contextWindow: 2000000,\n    speed: 'very-fast',\n    regions: GROK_REGIONS,\n    codingRecommended: true,\n    codingNote: 'Built-in reasoning always active - 2M context window ideal for large codebases',\n  },\n  {\n    id: 'xai.grok-4-1-fast-non-reasoning',\n    name: 'Grok 4.1 Fast (Non-Reasoning)',\n    family: 'grok',\n    capabilities: { streaming: true, tools: true, vision: false },\n    contextWindow: 2000000,\n    speed: 'very-fast',\n    regions: GROK_REGIONS,\n  },\n  {\n    id: 'xai.grok-4-fast-reasoning',\n    name: 'Grok 4 Fast Reasoning',\n    family: 'grok',\n    // Note: Grok models don't support reasoningEffort parameter (see xai.grok-4-1-fast-reasoning)\n    capabilities: { streaming: true, tools: true, vision: false },\n    contextWindow: 131072,\n    speed: 'very-fast',\n    regions: GROK_REGIONS,\n    codingRecommended: true,\n    codingNote: 'Built-in reasoning always active',\n  },\n  {\n    id: 'xai.grok-4-fast-non-reasoning',\n    name: 'Grok 4 Fast (Non-Reasoning)',\n    family: 'grok',\n    capabilities: { streaming: true, tools: true, vision: false },\n    contextWindow: 131072,\n    speed: 'very-fast',\n    regions: GROK_REGIONS,\n  },\n  {\n    id: 'xai.grok-4',\n    name: 'Grok 4',\n    family: 'grok',\n    capabilities: { streaming: true, tools: true, vision: false },\n    contextWindow: 131072,\n    speed: 'fast',\n    regions: GROK_REGIONS,\n  },\n  {\n    id: 'xai.grok-3',\n    name: 'Grok 3',\n    family: 'grok',\n    capabilities: { streaming: true, tools: true, vision: false },\n    contextWindow: 131072,\n    speed: 'fast',\n    regions: GROK_REGIONS,\n  },\n  {\n    id: 'xai.grok-3-fast',\n    name: 'Grok 3 Fast',\n    family: 'grok',\n    capabilities: { streaming: true, tools: true, vision: false },\n    contextWindow: 131072,\n    speed: 'very-fast',\n    regions: GROK_REGIONS,\n  },\n  {\n    id: 'xai.grok-3-mini',\n    name: 'Grok 3 Mini',\n    family: 'grok',\n    capabilities: { streaming: true, tools: false, vision: false },\n    contextWindow: 131072,\n    speed: 'very-fast',\n    regions: GROK_REGIONS,\n    codingNote: 'No tool support - not recommended for coding agents',\n  },\n  {\n    id: 'xai.grok-3-mini-fast',\n    name: 'Grok 3 Mini Fast',\n    family: 'grok',\n    capabilities: { streaming: true, tools: false, vision: false },\n    contextWindow: 131072,\n    speed: 'very-fast',\n    regions: GROK_REGIONS,\n    codingNote: 'No tool support - not recommended for coding agents',\n  },\n\n  // ==========================================================================\n  // Meta Llama models\n  // ==========================================================================\n  {\n    id: 'meta.llama-4-maverick-17b-128e-instruct-fp8',\n    name: 'Llama 4 Maverick',\n    family: 'llama',\n    capabilities: { streaming: true, tools: true, vision: false },\n    contextWindow: 131072,\n    speed: 'very-fast',\n    regions: ['us-chicago-1', 'us-ashburn-1'],\n    codingRecommended: true,\n    codingNote: 'Latest Llama with excellent code capabilities',\n  },\n  {\n    id: 'meta.llama-4-scout-17b-16e-instruct',\n    name: 'Llama 4 Scout',\n    family: 'llama',\n    capabilities: { streaming: true, tools: true, vision: false },\n    contextWindow: 131072,\n    speed: 'very-fast',\n    regions: ['us-chicago-1', 'us-ashburn-1'],\n  },\n  {\n    id: 'meta.llama-3.3-70b-instruct',\n    name: 'Llama 3.3 70B Instruct',\n    family: 'llama',\n    capabilities: { streaming: true, tools: true, vision: false },\n    contextWindow: 131072,\n    speed: 'fast',\n    regions: LLAMA_REGIONS,\n    codingRecommended: true,\n    codingNote: 'Best general-purpose coding model, widely available',\n  },\n  {\n    id: 'meta.llama-3.2-90b-vision-instruct',\n    name: 'Llama 3.2 Vision 90B',\n    family: 'llama',\n    capabilities: { streaming: true, tools: true, vision: true },\n    contextWindow: 131072,\n    speed: 'medium',\n    regions: ['us-chicago-1', 'us-ashburn-1'],\n    codingNote: 'Vision support for analyzing screenshots/diagrams',\n  },\n  {\n    id: 'meta.llama-3.2-11b-vision-instruct',\n    name: 'Llama 3.2 Vision 11B',\n    family: 'llama',\n    capabilities: { streaming: true, tools: true, vision: true },\n    contextWindow: 131072,\n    speed: 'fast',\n    regions: ['us-chicago-1', 'us-ashburn-1'],\n    codingNote: 'Lightweight vision model for screenshots',\n  },\n  {\n    id: 'meta.llama-3.1-405b-instruct',\n    name: 'Llama 3.1 405B Instruct',\n    family: 'llama',\n    capabilities: { streaming: true, tools: true, vision: false },\n    contextWindow: 131072,\n    speed: 'slow',\n    regions: LLAMA_REGIONS,\n    dedicatedOnly: true,\n    codingNote: 'Dedicated clusters only - expensive but powerful',\n  },\n  {\n    id: 'meta.llama-3.1-70b-instruct',\n    name: 'Llama 3.1 70B Instruct',\n    family: 'llama',\n    capabilities: { streaming: true, tools: true, vision: false },\n    contextWindow: 131072,\n    speed: 'fast',\n    regions: LLAMA_REGIONS,\n  },\n\n  // ==========================================================================\n  // Google Gemini models\n  // ==========================================================================\n  {\n    id: 'google.gemini-2.5-flash',\n    name: 'Gemini 2.5 Flash',\n    family: 'gemini',\n    capabilities: { streaming: true, tools: true, vision: true, reasoning: true },\n    contextWindow: 1048576,\n    speed: 'fast',\n    regions: GEMINI_REGIONS,\n    codingRecommended: true,\n    codingNote: '1M context, fast, vision for screenshots - best balance',\n  },\n  {\n    id: 'google.gemini-2.5-pro',\n    name: 'Gemini 2.5 Pro',\n    family: 'gemini',\n    capabilities: { streaming: true, tools: true, vision: true, reasoning: true },\n    contextWindow: 1048576,\n    speed: 'medium',\n    regions: GEMINI_REGIONS,\n    codingNote: '1M context, higher quality but slower than Flash',\n  },\n  {\n    id: 'google.gemini-2.5-flash-lite',\n    name: 'Gemini 2.5 Flash Lite',\n    family: 'gemini',\n    capabilities: { streaming: true, tools: false, vision: true },\n    contextWindow: 1048576,\n    speed: 'very-fast',\n    regions: GEMINI_REGIONS,\n    codingNote: 'No tool support - not recommended for coding agents',\n  },\n\n  // ==========================================================================\n  // Cohere Command models\n  // ==========================================================================\n  {\n    id: 'cohere.command-a-03-2025',\n    name: 'Command A (Mar 2025)',\n    family: 'cohere',\n    capabilities: { streaming: true, tools: true, vision: false },\n    contextWindow: 256000,\n    speed: 'fast',\n    regions: COHERE_REGIONS,\n    codingRecommended: true,\n    codingNote: '256K context, latest Cohere model with tool support',\n  },\n  {\n    id: 'cohere.command-plus-latest',\n    name: 'Command+ (Latest)',\n    family: 'cohere',\n    capabilities: { streaming: true, tools: true, vision: false },\n    contextWindow: 128000,\n    speed: 'fast',\n    regions: COHERE_REGIONS,\n  },\n  {\n    id: 'cohere.command-latest',\n    name: 'Command (Latest)',\n    family: 'cohere',\n    capabilities: { streaming: true, tools: true, vision: false },\n    contextWindow: 128000,\n    speed: 'fast',\n    regions: COHERE_REGIONS,\n  },\n  {\n    id: 'cohere.command-r-plus-08-2024',\n    name: 'Command R+ (Aug 2024)',\n    family: 'cohere',\n    capabilities: { streaming: true, tools: true, vision: false },\n    contextWindow: 128000,\n    speed: 'fast',\n    regions: COHERE_REGIONS,\n  },\n  {\n    id: 'cohere.command-r-08-2024',\n    name: 'Command R (Aug 2024)',\n    family: 'cohere',\n    capabilities: { streaming: true, tools: true, vision: false },\n    contextWindow: 128000,\n    speed: 'fast',\n    regions: COHERE_REGIONS,\n  },\n  {\n    id: 'cohere.command-a-reasoning-08-2025',\n    name: 'Command A Reasoning',\n    family: 'cohere',\n    capabilities: { streaming: true, tools: true, vision: false, reasoning: true },\n    contextWindow: 256000,\n    speed: 'medium',\n    regions: COHERE_REGIONS,\n    codingNote: 'Enhanced reasoning for complex logic',\n  },\n  {\n    id: 'cohere.command-a-vision-07-2025',\n    name: 'Command A Vision',\n    family: 'cohere',\n    capabilities: { streaming: true, tools: true, vision: true },\n    contextWindow: 128000,\n    speed: 'medium',\n    regions: COHERE_REGIONS,\n    dedicatedOnly: true,\n  },\n  {\n    id: 'cohere.command-a-reasoning',\n    name: 'Command A Reasoning (Legacy)',\n    family: 'cohere',\n    capabilities: { streaming: true, tools: true, vision: false, reasoning: true },\n    contextWindow: 256000,\n    speed: 'medium',\n    regions: COHERE_REGIONS,\n    dedicatedOnly: true,\n  },\n  {\n    id: 'cohere.command-a-vision',\n    name: 'Command A Vision (Legacy)',\n    family: 'cohere',\n    capabilities: { streaming: true, tools: true, vision: true },\n    contextWindow: 131072,\n    speed: 'medium',\n    regions: COHERE_REGIONS,\n    dedicatedOnly: true,\n  },\n  {\n    id: 'cohere.command-r-plus',\n    name: 'Command R+ (Latest)',\n    family: 'cohere',\n    capabilities: { streaming: true, tools: true, vision: false },\n    contextWindow: 128000,\n    speed: 'fast',\n    regions: COHERE_REGIONS,\n  },\n  {\n    id: 'cohere.command-r-16k',\n    name: 'Command R 16K',\n    family: 'cohere',\n    capabilities: { streaming: true, tools: true, vision: false },\n    contextWindow: 16000,\n    speed: 'fast',\n    regions: COHERE_REGIONS,\n    codingNote: 'Small context - not ideal for large codebases',\n  },\n\n  // ==========================================================================\n  // OpenAI GPT-OSS models\n  // ==========================================================================\n  {\n    id: 'openai.gpt-oss-120b',\n    name: 'GPT-OSS 120B',\n    family: 'openai',\n    capabilities: { streaming: true, tools: true, vision: false },\n    contextWindow: 131072,\n    speed: 'medium',\n    regions: OPENAI_REGIONS,\n    codingNote: 'OpenAI open-source model - less proven for code',\n  },\n  {\n    id: 'openai.gpt-oss-20b',\n    name: 'GPT-OSS 20B',\n    family: 'openai',\n    capabilities: { streaming: true, tools: true, vision: false },\n    contextWindow: 131072,\n    speed: 'fast',\n    regions: OPENAI_REGIONS,\n    codingNote: 'Lightweight OpenAI model',\n  },\n];\n\nexport function isValidModelId(modelId: string): boolean {\n  return MODEL_CATALOG.some((m) => m.id === modelId);\n}\n\nexport function getModelMetadata(modelId: string): ModelMetadata | undefined {\n  return MODEL_CATALOG.find((m) => m.id === modelId);\n}\n\nexport function getAllModels(): ModelMetadata[] {\n  return MODEL_CATALOG;\n}\n\nexport function getModelsByFamily(family: ModelMetadata['family']): ModelMetadata[] {\n  return MODEL_CATALOG.filter((m) => m.family === family);\n}\n\n/**\n * Get models available in a specific region\n * @param region - OCI region identifier (e.g., 'eu-frankfurt-1')\n * @param includeDedicatedOnly - Include models that require dedicated AI clusters (default: false)\n */\nexport function getModelsByRegion(\n  region: OCIGenAIRegion,\n  includeDedicatedOnly = false\n): ModelMetadata[] {\n  return MODEL_CATALOG.filter(\n    (m) => m.regions.includes(region) && (includeDedicatedOnly || !m.dedicatedOnly)\n  );\n}\n\n/**\n * Get models recommended for coding agents in a specific region.\n * These models have tool support, good code capabilities, and reasonable speed.\n * @param region - OCI region identifier (e.g., 'eu-frankfurt-1')\n */\nexport function getCodingRecommendedModels(region: OCIGenAIRegion): ModelMetadata[] {\n  return MODEL_CATALOG.filter(\n    (m) =>\n      m.regions.includes(region) &&\n      !m.dedicatedOnly &&\n      m.capabilities.tools &&\n      m.codingRecommended === true\n  );\n}\n\n/**\n * Check if a model is suitable for coding agents\n * @param modelId - Model ID to check\n */\nexport function isCodingSuitable(modelId: string): boolean {\n  const model = MODEL_CATALOG.find((m) => m.id === modelId);\n  if (!model) return false;\n  // Must have tool support\n  return model.capabilities.tools;\n}\n\n/**\n * Check if a model supports reasoning/thinking traces\n * @param modelId - Model ID to check\n * @returns true if the model supports reasoning capabilities\n */\nexport function supportsReasoning(modelId: string): boolean {\n  const model = MODEL_CATALOG.find((m) => m.id === modelId);\n  return model?.capabilities.reasoning ?? false;\n}\n\n/**\n * Check if a model supports vision/image inputs\n * @param modelId - Model ID to check\n * @returns true if the model supports image inputs\n */\nexport function supportsVision(modelId: string): boolean {\n  const model = MODEL_CATALOG.find((m) => m.id === modelId);\n  return model?.capabilities.vision ?? false;\n}\n\n/**\n * Get all vision-capable models\n * @returns Array of models that support image inputs\n */\nexport function getVisionModels(): ModelMetadata[] {\n  return MODEL_CATALOG.filter((m) => m.capabilities.vision);\n}\n","import type {\n  LanguageModelV3Prompt,\n  LanguageModelV3ToolCallPart,\n  LanguageModelV3ToolResultPart,\n  LanguageModelV3FilePart,\n  LanguageModelV3TextPart,\n} from '@ai-sdk/provider';\n\nexport interface OCIMessage {\n  role: 'USER' | 'ASSISTANT' | 'SYSTEM' | 'TOOL';\n  content: Array<\n    | { type: 'TEXT'; text: string; imageUrl?: never }\n    | { type: 'IMAGE'; imageUrl: { url: string }; text?: never }\n  >;\n  // OCI uses flat structure: { id, type, name, arguments } - NOT nested { function: { name, arguments } }\n  // See: oci-generativeaiinference/lib/model/function-call.d.ts\n  toolCalls?: Array<{\n    id: string;\n    type: 'FUNCTION';\n    name: string;\n    arguments: string;\n  }>;\n  toolCallId?: string;\n}\n\ntype RoleMap = {\n  user: 'USER';\n  assistant: 'ASSISTANT';\n  system: 'SYSTEM';\n  tool: 'TOOL';\n};\n\nconst ROLE_MAP: RoleMap = {\n  user: 'USER',\n  assistant: 'ASSISTANT',\n  system: 'SYSTEM',\n  tool: 'TOOL',\n};\n\nexport function convertToOCIMessages(prompt: LanguageModelV3Prompt): OCIMessage[] {\n  return prompt.map((message) => {\n    const role = message.role as keyof RoleMap;\n\n    if (!ROLE_MAP[role]) {\n      throw new Error(`Unsupported role: ${role}`);\n    }\n\n    const ociRole = ROLE_MAP[role];\n\n    // Handle string content (system messages)\n    if (typeof message.content === 'string') {\n      return {\n        role: ociRole,\n        content: [{ type: 'TEXT' as const, text: message.content }],\n      };\n    }\n\n    // Handle array content\n    if (Array.isArray(message.content)) {\n      // Handle tool messages with tool-result parts\n      if (role === 'tool') {\n        const toolResultPart = message.content.find(\n          (part): part is LanguageModelV3ToolResultPart => part.type === 'tool-result'\n        );\n\n        if (toolResultPart) {\n          const outputText = extractToolResultText(toolResultPart);\n          return {\n            role: ociRole,\n            toolCallId: toolResultPart.toolCallId,\n            content: [{ type: 'TEXT' as const, text: outputText }],\n          };\n        }\n      }\n\n      // Extract tool calls for assistant role\n      let toolCalls: OCIMessage['toolCalls'] | undefined = undefined;\n      if (role === 'assistant') {\n        const toolCallParts = message.content.filter(\n          (part): part is LanguageModelV3ToolCallPart => part.type === 'tool-call'\n        );\n        if (toolCallParts.length > 0) {\n          toolCalls = toolCallParts.map((part) => ({\n            id: part.toolCallId,\n            type: 'FUNCTION' as const,\n            name: part.toolName,\n            arguments:\n              typeof part.input === 'string' ? part.input : JSON.stringify(part.input ?? {}),\n          }));\n        }\n      }\n\n      // Convert all content parts (excluding tool-call/tool-result as they are handled above)\n      const content = message.content\n        .map((part) => {\n          if (part.type === 'text') {\n            return convertTextPartToOCIContent(part);\n          }\n          if (part.type === 'file') {\n            return convertFilePartToOCIContent(part);\n          }\n          return null;\n        })\n        .filter((part): part is NonNullable<typeof part> => part !== null);\n\n      const result: OCIMessage = {\n        role: ociRole,\n        content,\n      };\n\n      if (toolCalls) {\n        result.toolCalls = toolCalls;\n      }\n\n      return result;\n    }\n\n    return {\n      role: ociRole,\n      content: [],\n    };\n  });\n}\n\nfunction convertTextPartToOCIContent(part: LanguageModelV3TextPart): OCIMessage['content'][number] {\n  return { type: 'TEXT', text: part.text };\n}\n\nfunction convertFilePartToOCIContent(\n  part: LanguageModelV3FilePart\n): OCIMessage['content'][number] | null {\n  if (part.mediaType && part.mediaType.startsWith('image/')) {\n    let url = '';\n    if (part.data instanceof Uint8Array) {\n      const base64 = Buffer.from(part.data).toString('base64');\n      url = `data:${part.mediaType};base64,${base64}`;\n    } else if (typeof part.data === 'string') {\n      url = part.data.startsWith('data:')\n        ? part.data\n        : `data:${part.mediaType};base64,${part.data}`;\n    } else if (part.data instanceof URL) {\n      url = part.data.toString();\n    }\n\n    // Validate URL was constructed\n    if (!url) {\n      console.warn(\n        '[OCI Messages] Failed to convert image data - unsupported data type:',\n        typeof part.data\n      );\n      return null;\n    }\n\n    return { type: 'IMAGE', imageUrl: { url } };\n  }\n\n  // Log warning for unsupported file types (PDF, audio, etc.)\n  if (part.mediaType) {\n    console.warn(\n      `[OCI Messages] Unsupported file type \"${part.mediaType}\" - only images are supported. File will be ignored.`\n    );\n  }\n\n  return null;\n}\n\n/**\n * Extract text from tool result output.\n * AI SDK v3 uses { type: 'text', value: string } format.\n */\nfunction extractToolResultText(part: LanguageModelV3ToolResultPart): string {\n  const output = part.output;\n  if (output.type === 'text') {\n    return output.value;\n  }\n  // For other output types (file, base64), stringify the content\n  return JSON.stringify(output);\n}\n","/**\n * Converts AI SDK messages to Cohere chat format.\n *\n * Cohere API structure:\n * - message: string (the latest user input)\n * - chatHistory: Array of previous messages with role, message, and optional toolCalls\n * - toolResults: Array of tool execution results (when continuing after tool calls)\n * - hasToolResults: Flag indicating toolResults are present (caller uses for isForceSingleStep)\n *\n * Reference: OCI SDK CohereChatRequest documentation\n */\n\nimport type { OCIMessage } from './messages';\n\n/**\n * Tool call format for Cohere API (in chatHistory)\n */\ninterface CohereToolCall {\n  name: string;\n  parameters: Record<string, unknown>;\n}\n\n/**\n * Cohere message in chat history\n */\ninterface CohereMessage {\n  role: 'USER' | 'CHATBOT';\n  message: string;\n  toolCalls?: CohereToolCall[];\n}\n\n/**\n * Tool result format for Cohere API\n * Structure: { call: {name, parameters}, outputs: [{result}] }\n */\ninterface CohereToolResult {\n  call: {\n    name: string;\n    parameters: Record<string, unknown>;\n  };\n  outputs: Array<{ result: string } | Record<string, unknown>>;\n}\n\n/**\n * Cohere chat request format\n */\ninterface CohereChatRequest {\n  message: string;\n  chatHistory?: CohereMessage[];\n  preambleOverride?: string;\n  toolResults?: CohereToolResult[];\n  hasToolResults: boolean;\n}\n\n/**\n * Converts generic OCI messages to Cohere format.\n * Extracts the last user message as 'message', converts previous messages to 'chatHistory',\n * and extracts tool results from TOOL messages.\n */\nexport function convertToCohereFormat(messages: OCIMessage[]): CohereChatRequest {\n  if (messages.length === 0) {\n    throw new Error('At least one message is required');\n  }\n\n  // Find the last user message\n  const lastUserIndex = messages.map((m) => m.role).lastIndexOf('USER');\n\n  if (lastUserIndex === -1) {\n    throw new Error('At least one USER message is required');\n  }\n\n  // Extract system messages into preamble\n  const systemMessages = messages\n    .filter((m) => m.role === 'SYSTEM')\n    .map((m) => m.content.filter((c) => c.type === 'TEXT').map((c) => c.text))\n    .flat()\n    .join('\\n');\n\n  // Extract the current message (last user message)\n  const currentMessage = messages[lastUserIndex];\n  const messageText = currentMessage.content\n    .filter((c) => c.type === 'TEXT')\n    .map((c) => c.text)\n    .join('\\n');\n\n  // Build a map of tool calls by ID for matching with results\n  const toolCallsById = new Map<string, { name: string; parameters: Record<string, unknown> }>();\n\n  // Convert previous messages to chatHistory and collect tool results\n  const chatHistory: CohereMessage[] = [];\n  const toolResults: CohereToolResult[] = [];\n\n  for (let i = 0; i < lastUserIndex; i++) {\n    const msg = messages[i];\n\n    // Skip system messages (handled by preambleOverride)\n    if (msg.role === 'SYSTEM') {\n      continue;\n    }\n\n    // Handle TOOL messages - extract tool results\n    if (msg.role === 'TOOL') {\n      const resultText = msg.content\n        .filter((c) => c.type === 'TEXT')\n        .map((c) => c.text)\n        .join('\\n');\n\n      // Find the matching tool call\n      const toolCallId = msg.toolCallId;\n      if (toolCallId) {\n        const toolCall = toolCallsById.get(toolCallId);\n        if (toolCall) {\n          toolResults.push({\n            call: {\n              name: toolCall.name,\n              parameters: toolCall.parameters,\n            },\n            outputs: [{ result: resultText }],\n          });\n        }\n      }\n      continue;\n    }\n\n    // Extract text content\n    const text = msg.content\n      .filter((c) => c.type === 'TEXT')\n      .map((c) => c.text)\n      .join('\\n');\n\n    // Handle ASSISTANT messages - may have tool calls\n    if (msg.role === 'ASSISTANT') {\n      const cohereMessage: CohereMessage = {\n        role: 'CHATBOT',\n        message: text,\n      };\n\n      // Convert tool calls to Cohere format and store for later matching\n      if (msg.toolCalls && msg.toolCalls.length > 0) {\n        const cohereToolCalls: CohereToolCall[] = msg.toolCalls.map((tc) => {\n          // Parse arguments from JSON string to object\n          let parameters: Record<string, unknown> = {};\n          try {\n            if (tc.arguments) {\n              parameters = JSON.parse(tc.arguments) as Record<string, unknown>;\n            }\n          } catch {\n            parameters = {};\n          }\n\n          // Store for matching with tool results\n          toolCallsById.set(tc.id, {\n            name: tc.name,\n            parameters,\n          });\n\n          return {\n            name: tc.name,\n            parameters,\n          };\n        });\n\n        cohereMessage.toolCalls = cohereToolCalls;\n      }\n\n      chatHistory.push(cohereMessage);\n      continue;\n    }\n\n    // Handle USER messages\n    if (msg.role === 'USER') {\n      chatHistory.push({\n        role: 'USER',\n        message: text,\n      });\n    }\n  }\n\n  const hasToolResults = toolResults.length > 0;\n\n  return {\n    message: messageText,\n    ...(chatHistory.length > 0 ? { chatHistory } : {}),\n    ...(systemMessages ? { preambleOverride: systemMessages } : {}),\n    ...(hasToolResults ? { toolResults } : {}),\n    hasToolResults,\n  };\n}\n","import type {\n  LanguageModelV3FunctionTool,\n  LanguageModelV3ToolChoice,\n  LanguageModelV3ToolCall,\n} from '@ai-sdk/provider';\nimport type { OCIApiFormat } from '../../shared/oci-sdk-types';\n\n/**\n * OCI GENERIC format tool definition (FunctionDefinition)\n */\nexport interface OCIFunctionDefinition {\n  type: 'FUNCTION';\n  name: string;\n  description: string;\n  parameters: Record<string, unknown>;\n}\n\n/**\n * OCI COHERE format tool definition (CohereTool)\n */\nexport interface OCICohereTool {\n  name: string;\n  description: string;\n  parameterDefinitions?: Record<string, OCICohereParameterDefinition>;\n}\n\ninterface OCICohereParameterDefinition {\n  type: string;\n  description?: string;\n  /** Cohere uses isRequired, not required (learned from opencode-oci-provider V2) */\n  isRequired?: boolean;\n}\n\n/**\n * OCI tool choice types\n */\ninterface OCIToolChoiceAuto {\n  type: 'AUTO';\n}\n\ninterface OCIToolChoiceRequired {\n  type: 'REQUIRED';\n}\n\ninterface OCIToolChoiceNone {\n  type: 'NONE';\n}\n\ninterface OCIToolChoiceFunction {\n  type: 'FUNCTION';\n  function: { name: string };\n}\n\nexport type OCIToolChoice =\n  | OCIToolChoiceAuto\n  | OCIToolChoiceRequired\n  | OCIToolChoiceNone\n  | OCIToolChoiceFunction;\n\n/**\n * OCI GENERIC format tool call (from response)\n */\nexport interface OCIFunctionCall {\n  id: string;\n  type: 'FUNCTION';\n  function: {\n    name: string;\n    arguments: string; // JSON string\n  };\n}\n\n/**\n * OCI COHERE format tool call (from response)\n */\nexport interface OCICohereToolCall {\n  name: string;\n  parameters: Record<string, unknown>;\n}\n\nexport type OCIToolDefinition = OCIFunctionDefinition | OCICohereTool;\nexport type OCIToolCall = OCIFunctionCall | OCICohereToolCall;\n\n/**\n * Converts AI SDK v3 function tools to OCI format.\n * AI SDK v3 uses `inputSchema` for the JSON schema, which maps to OCI's `parameters`.\n */\nexport function convertToOCITools(\n  tools: LanguageModelV3FunctionTool[],\n  apiFormat: OCIApiFormat\n): OCIToolDefinition[] {\n  if (apiFormat === 'COHERE' || apiFormat === 'COHEREV2') {\n    return tools.map((tool) => convertToCohereToolFormat(tool));\n  }\n  return tools.map((tool) => convertToGenericToolFormat(tool));\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction sanitizeSchema(schema: any): any {\n  if (!schema || typeof schema !== 'object') {\n    return schema;\n  }\n\n  if (Array.isArray(schema)) {\n    return schema.map(sanitizeSchema);\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n  const sanitized = { ...schema };\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n  delete sanitized.$schema;\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n  delete sanitized['$ref'];\n\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n  for (const [key, value] of Object.entries(sanitized)) {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment, @typescript-eslint/no-unsafe-member-access\n    sanitized[key] = sanitizeSchema(value);\n  }\n\n  return sanitized;\n}\n\nfunction convertToGenericToolFormat(tool: LanguageModelV3FunctionTool): OCIFunctionDefinition {\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n  const parameters = sanitizeSchema(tool.inputSchema as Record<string, unknown>) || {};\n\n  // Ensure the schema has a type 'object'\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n  if (!parameters.type) {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    parameters.type = 'object';\n  }\n\n  return {\n    type: 'FUNCTION',\n    name: tool.name,\n    description: tool.description ?? '',\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n    parameters,\n  };\n}\n\nfunction convertToCohereToolFormat(tool: LanguageModelV3FunctionTool): OCICohereTool {\n  const schema = tool.inputSchema as {\n    type?: string;\n    properties?: Record<string, { type: string; description?: string }>;\n    required?: string[];\n  };\n\n  const parameterDefinitions: Record<string, OCICohereParameterDefinition> = {};\n\n  if (schema?.properties) {\n    const required = schema.required ?? [];\n    for (const [key, value] of Object.entries(schema.properties)) {\n      parameterDefinitions[key] = {\n        type: value.type || 'string', // Default to string if type is missing\n        description: value.description,\n        isRequired: required.includes(key), // Cohere uses isRequired, not required\n      };\n    }\n  }\n\n  return {\n    name: tool.name,\n    description: tool.description ?? '',\n    parameterDefinitions:\n      Object.keys(parameterDefinitions).length > 0 ? parameterDefinitions : undefined,\n  };\n}\n\n/**\n * Converts AI SDK v3 tool choice to OCI format.\n */\nexport function convertToOCIToolChoice(choice: LanguageModelV3ToolChoice): OCIToolChoice {\n  switch (choice.type) {\n    case 'auto':\n      return { type: 'AUTO' };\n    case 'required':\n      return { type: 'REQUIRED' };\n    case 'none':\n      return { type: 'NONE' };\n    case 'tool':\n      return {\n        type: 'FUNCTION',\n        function: { name: choice.toolName },\n      };\n    default:\n      return { type: 'AUTO' };\n  }\n}\n\n/**\n * Converts OCI tool calls from response to AI SDK v3 format.\n */\nexport function convertFromOCIToolCalls(\n  toolCalls: OCIToolCall[],\n  apiFormat: OCIApiFormat\n): LanguageModelV3ToolCall[] {\n  if (apiFormat === 'COHERE' || apiFormat === 'COHEREV2') {\n    return toolCalls.map((call, index) =>\n      convertFromCohereToolCall(call as OCICohereToolCall, index)\n    );\n  }\n  return toolCalls.map((call) => convertFromGenericToolCall(call as OCIFunctionCall));\n}\n\nfunction convertFromGenericToolCall(call: OCIFunctionCall): LanguageModelV3ToolCall {\n  // AI SDK v3 uses 'input' as a stringified JSON, not 'args' as an object\n  return {\n    type: 'tool-call',\n    toolCallId: call.id,\n    toolName: call.function.name,\n    input: call.function.arguments,\n  };\n}\n\nfunction convertFromCohereToolCall(\n  call: OCICohereToolCall,\n  index: number\n): LanguageModelV3ToolCall {\n  // Cohere doesn't provide tool call IDs, generate one\n  const toolCallId = `tool-call-${Date.now()}-${index}`;\n\n  // AI SDK v3 uses 'input' as a stringified JSON\n  return {\n    type: 'tool-call',\n    toolCallId,\n    toolName: call.name,\n    input: JSON.stringify(call.parameters ?? {}),\n  };\n}\n\n/**\n * Check if a model supports tool calling.\n * Currently supported: Llama 3.1+, Grok, Gemini, Cohere Command R/R+\n */\nexport function supportsToolCalling(modelId: string): boolean {\n  const supportedPatterns = [\n    /^meta\\.llama-3\\.[1-9]/, // Llama 3.1+\n    /^cohere\\.command-r/, // Cohere Command R and R+\n    /^xai\\.grok/, // Grok models\n    /^google\\.gemini/, // Gemini models\n  ];\n\n  return supportedPatterns.some((pattern) => pattern.test(modelId));\n}\n","import { createParser, type EventSourceMessage } from 'eventsource-parser';\nimport type { LanguageModelV3FinishReason } from '@ai-sdk/provider';\nimport type { StreamPart, UnifiedFinishReason, FinishPart } from './types';\n\nconst FINISH_REASON_MAP: Record<string, UnifiedFinishReason> = {\n  STOP: 'stop',\n  LENGTH: 'length',\n  CONTENT_FILTER: 'content-filter',\n  TOOL_CALLS: 'tool-calls',\n  ERROR: 'error',\n};\n\n/**\n * Maps OCI GenAI finish reasons to AI SDK v3 LanguageModelV3FinishReason structure.\n */\nexport function mapFinishReason(reason: string): LanguageModelV3FinishReason {\n  return {\n    unified: FINISH_REASON_MAP[reason] ?? 'other',\n    raw: reason,\n  };\n}\n\n/**\n * OCI streaming format (2025+):\n * Text chunk:  {\"index\":0,\"message\":{\"role\":\"ASSISTANT\",\"content\":[{\"type\":\"TEXT\",\"text\":\"...\"}]},\"pad\":\"...\"}\n * Tool call:   {\"message\":{\"role\":\"ASSISTANT\",\"toolCalls\":[{\"id\":\"...\",\"type\":\"FUNCTION\",\"function\":{\"name\":\"...\",\"arguments\":\"...\"}}]},...}\n * Finish:      {\"message\":{\"role\":\"ASSISTANT\"},\"finishReason\":\"stop\",\"pad\":\"...\"}\n */\ninterface OCIStreamToolCall {\n  id?: string;\n  type?: string;\n  function?: {\n    name?: string;\n    arguments?: string;\n  };\n  // Cohere format\n  name?: string;\n  parameters?: Record<string, unknown>;\n}\n\ninterface OCIStreamChunk {\n  index?: number;\n  message?: {\n    role?: string;\n    content?: Array<{ type?: string; text?: string; thinking?: string }>;\n    toolCalls?: OCIStreamToolCall[];\n    reasoningContent?: string;\n  };\n  // Cohere format: tool calls at top level\n  toolCalls?: OCIStreamToolCall[];\n  finishReason?: string;\n  pad?: string;\n  usage?: {\n    promptTokens?: number;\n    completionTokens?: number;\n    completionTokensDetails?: {\n      reasoningTokens?: number;\n      acceptedPredictionTokens?: number;\n      rejectedPredictionTokens?: number;\n    };\n  };\n}\n\n/**\n * Parses an OCI GenAI streaming response.\n * Accepts either a ReadableStream directly (new OCI SDK behavior) or a Response object.\n */\nexport async function* parseSSEStream(\n  input: ReadableStream<Uint8Array> | Response,\n  options?: { includeRawChunks?: boolean; apiFormat?: 'GENERIC' | 'COHERE' | 'COHEREV2' }\n): AsyncGenerator<StreamPart> {\n  // Handle both ReadableStream and Response objects\n  const stream = input instanceof ReadableStream ? input : input.body;\n  if (!stream) {\n    throw new Error('Response body is not readable');\n  }\n\n  const reader = stream.getReader();\n  const decoder = new TextDecoder();\n  const parts: StreamPart[] = [];\n  let yieldedIndex = 0;\n\n  // Buffer for finish event to combine reason and usage\n  let lastFinishReason: UnifiedFinishReason = 'stop';\n  let lastRawFinishReason = 'STOP';\n  let lastUsage: FinishPart['usage'] = { promptTokens: 0, completionTokens: 0 };\n  let hasFinishOrUsage = false;\n\n  const includeRawChunks = options?.includeRawChunks ?? false;\n\n  const parser = createParser({\n    onEvent: (event: EventSourceMessage) => {\n      const data = event.data;\n      if (data === '[DONE]') return;\n\n      try {\n        const parsed = JSON.parse(data) as OCIStreamChunk;\n\n        if (includeRawChunks) {\n          parts.push({\n            type: 'raw',\n            rawValue: parsed,\n          });\n        }\n\n        // Check for reasoning delta (Generic or CohereV2 format)\n        if (parsed.message?.reasoningContent) {\n          parts.push({\n            type: 'reasoning-delta',\n            reasoningDelta: parsed.message.reasoningContent,\n          });\n        }\n\n        // Support for top-level text or content[0].text (Older Cohere format)\n        const topLevelText = (parsed as any).text || (parsed as any).textDelta;\n        if (topLevelText) {\n          parts.push({\n            type: 'text-delta',\n            textDelta: topLevelText,\n          });\n        }\n\n        if (parsed.message?.content) {\n          for (const part of parsed.message.content) {\n            if (part.type === 'THINKING' && part.thinking) {\n              parts.push({\n                type: 'reasoning-delta',\n                reasoningDelta: part.thinking,\n              });\n            }\n          }\n        }\n\n        // Check for text delta in message content\n        const contentParts = parsed.message?.content;\n        if (contentParts) {\n          for (const part of contentParts) {\n            if ((part.type === 'TEXT' || !part.type) && part.text) {\n              parts.push({\n                type: 'text-delta',\n                textDelta: part.text,\n              });\n            }\n          }\n        }\n\n        // Check for tool calls (GENERIC or COHERE format)\n        const toolCalls = parsed.message?.toolCalls ?? parsed.toolCalls;\n        if (toolCalls && toolCalls.length > 0) {\n          for (const toolCall of toolCalls) {\n            if (toolCall.function?.name) {\n              parts.push({\n                type: 'tool-call',\n                toolCallId: toolCall.id ?? `tool-call-${Date.now()}`,\n                toolName: toolCall.function.name,\n                input: toolCall.function.arguments ?? '{}',\n              });\n            } else if (toolCall.name) {\n              parts.push({\n                type: 'tool-call',\n                toolCallId: `tool-call-${Date.now()}`,\n                toolName: toolCall.name,\n                input: JSON.stringify(toolCall.parameters ?? {}),\n              });\n            }\n          }\n        }\n\n        // Buffer finish and usage\n        if (parsed.finishReason || parsed.usage) {\n          hasFinishOrUsage = true;\n          if (parsed.finishReason) {\n            lastRawFinishReason = parsed.finishReason.toUpperCase();\n            lastFinishReason = FINISH_REASON_MAP[lastRawFinishReason] ?? 'stop';\n          }\n          if (parsed.usage) {\n            const usage = parsed.usage;\n            const tokenDetails = usage.completionTokensDetails;\n            lastUsage = {\n              promptTokens:\n                usage.promptTokens ?? (usage as any).promptTokenCount ?? lastUsage.promptTokens,\n              completionTokens:\n                usage.completionTokens ??\n                (usage as any).completionTokenCount ??\n                lastUsage.completionTokens,\n              reasoningTokens: tokenDetails?.reasoningTokens ?? lastUsage.reasoningTokens,\n              acceptedPredictionTokens:\n                tokenDetails?.acceptedPredictionTokens ?? lastUsage.acceptedPredictionTokens,\n              rejectedPredictionTokens:\n                tokenDetails?.rejectedPredictionTokens ?? lastUsage.rejectedPredictionTokens,\n            };\n          }\n        }\n      } catch (error) {\n        // Log parsing errors - silent failures here cause major debugging issues\n        console.error('[OCI SSE Parser] Failed to parse chunk:', {\n          data: data.length > 200 ? data.substring(0, 200) + '...' : data,\n          error: error instanceof Error ? error.message : String(error),\n        });\n\n        if (includeRawChunks) {\n          parts.push({\n            type: 'raw',\n            rawValue: data,\n          });\n        }\n      }\n    },\n  });\n\n  while (true) {\n    const result = await reader.read();\n\n    if (result.done) break;\n\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n    parser.feed(decoder.decode(result.value, { stream: true }));\n\n    // Yield any parts that were parsed\n    while (yieldedIndex < parts.length) {\n      yield parts[yieldedIndex++];\n    }\n  }\n\n  // Always yield a finish event - use defaults if none received from API\n  yield {\n    type: 'finish',\n    finishReason: hasFinishOrUsage\n      ? { unified: lastFinishReason, raw: lastRawFinishReason }\n      : { unified: 'other', raw: 'INCOMPLETE' },\n    usage: lastUsage,\n  };\n\n  // Yield any remaining parts\n  while (yieldedIndex < parts.length) {\n    yield parts[yieldedIndex++];\n  }\n}\n","import * as common from 'oci-common';\nimport type { OCIConfig } from '../types';\n\n/**\n * Create OCI authentication provider based on configuration\n */\nexport async function createAuthProvider(\n  config: OCIConfig\n): Promise<common.AuthenticationDetailsProvider> {\n  const authMethod = config.auth || 'config_file';\n\n  switch (authMethod) {\n    case 'config_file': {\n      const configPath = config.configPath || undefined;\n      const profile = config.profile || 'DEFAULT';\n\n      return new common.ConfigFileAuthenticationDetailsProvider(configPath, profile);\n    }\n\n    case 'instance_principal': {\n      const builder = new common.InstancePrincipalsAuthenticationDetailsProviderBuilder();\n      return await builder.build();\n    }\n\n    case 'resource_principal': {\n      return common.ResourcePrincipalAuthenticationDetailsProvider.builder();\n    }\n\n    default:\n      throw new Error(\n        `Unsupported authentication method: ${authMethod as string}. ` +\n          `Supported methods: config_file, instance_principal, resource_principal`\n      );\n  }\n}\n\n/**\n * Get compartment ID from config, environment, or config file\n */\nexport function getCompartmentId(config: OCIConfig): string {\n  // Priority: config > environment > error\n  const compartmentId = config.compartmentId || process.env.OCI_COMPARTMENT_ID;\n\n  if (!compartmentId) {\n    throw new Error(\n      'Compartment ID not found. Provide via config.compartmentId or OCI_COMPARTMENT_ID environment variable.'\n    );\n  }\n\n  return compartmentId;\n}\n\n/**\n * Get region from config or environment\n */\nexport function getRegion(config: OCIConfig): string {\n  return config.region || process.env.OCI_REGION || 'eu-frankfurt-1';\n}\n","/**\n * Error types for OCI GenAI Provider.\n * Provides specific error classes for different failure scenarios.\n */\n\nimport { APICallError, AISDKError, InvalidResponseDataError } from '@ai-sdk/provider';\n\nexport interface OCIGenAIErrorOptions {\n  cause?: Error;\n}\n\n/**\n * Base error class for all OCI GenAI errors.\n */\nexport class OCIGenAIError extends Error {\n  override readonly name: string = 'OCIGenAIError';\n  readonly cause?: Error;\n  readonly retryable: boolean;\n  readonly statusCode?: number;\n\n  constructor(\n    message: string,\n    statusCodeOrOptions?: number | OCIGenAIErrorOptions,\n    retryable: boolean = false\n  ) {\n    super(message);\n\n    // Support both old API (statusCode, retryable) and new API (options object)\n    if (typeof statusCodeOrOptions === 'number') {\n      this.statusCode = statusCodeOrOptions;\n      this.retryable = retryable;\n    } else {\n      this.cause = statusCodeOrOptions?.cause;\n      this.retryable = retryable;\n    }\n\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, this.constructor);\n    }\n  }\n}\n\nexport interface NetworkErrorOptions extends OCIGenAIErrorOptions {\n  code?: string;\n}\n\n/**\n * Error thrown for network-related failures (connection reset, timeout, DNS, etc.).\n * These errors are typically retryable.\n */\nexport class NetworkError extends OCIGenAIError {\n  override readonly name: string = 'NetworkError';\n  override readonly retryable = true;\n  readonly code?: string;\n\n  constructor(message: string, options?: NetworkErrorOptions) {\n    super(message, options, true);\n    this.code = options?.code;\n  }\n}\n\nexport interface RateLimitErrorOptions extends OCIGenAIErrorOptions {\n  retryAfterMs?: number;\n}\n\n/**\n * Error thrown when rate limit (429) is exceeded.\n * These errors are retryable after waiting the specified time.\n */\nexport class RateLimitError extends OCIGenAIError {\n  override readonly name: string = 'RateLimitError';\n  override readonly retryable = true;\n  readonly retryAfterMs?: number;\n\n  constructor(message: string, options?: RateLimitErrorOptions) {\n    super(message, options, true);\n    this.retryAfterMs = options?.retryAfterMs;\n  }\n}\n\nexport interface AuthenticationErrorOptions extends OCIGenAIErrorOptions {\n  authType?: 'api_key' | 'instance_principal' | 'resource_principal' | 'session_token';\n}\n\n/**\n * Error thrown for authentication failures (invalid credentials, expired tokens, etc.).\n * These errors are NOT retryable - credentials need to be fixed.\n */\nexport class AuthenticationError extends OCIGenAIError {\n  override readonly name: string = 'AuthenticationError';\n  override readonly retryable = false;\n  readonly authType?: string;\n\n  constructor(message: string, options?: AuthenticationErrorOptions) {\n    super(message, options, false);\n    this.authType = options?.authType;\n  }\n}\n\n/**\n * Error thrown when a requested model is not found or not available.\n * These errors are NOT retryable - model ID needs to be corrected.\n */\nexport class ModelNotFoundError extends OCIGenAIError {\n  override readonly name: string = 'ModelNotFoundError';\n  override readonly retryable = false;\n  readonly modelId: string;\n\n  constructor(modelId: string, options?: OCIGenAIErrorOptions) {\n    super(\n      `Model not found: ${modelId}. Check that the model ID is correct and available in your region.`,\n      options,\n      false\n    );\n    this.modelId = modelId;\n  }\n}\n\nexport interface ValidationErrorOptions extends OCIGenAIErrorOptions {\n  issues?: unknown[];\n}\n\n/**\n * Error thrown when validation of user-provided input fails.\n * These errors are NOT retryable - input needs to be corrected.\n */\nexport class OCIValidationError extends OCIGenAIError {\n  override readonly name: string = 'OCIValidationError';\n  override readonly retryable = false;\n  readonly details?: Record<string, unknown>;\n\n  constructor(message: string, details?: Record<string, unknown>) {\n    super(message, undefined, false);\n    this.details = details;\n  }\n}\n\n/**\n * Check if an HTTP status code indicates a retryable error.\n */\nexport function isRetryableStatusCode(statusCode: number): boolean {\n  return statusCode === 429 || statusCode >= 500;\n}\n\n/**\n * Handle and wrap OCI errors with additional context.\n */\nexport function handleOCIError(error: unknown): AISDKError {\n  if (AISDKError.isInstance(error)) {\n    return error;\n  }\n\n  if (error instanceof OCIGenAIError) {\n    if (error instanceof OCIValidationError) {\n      return new InvalidResponseDataError({\n        message: error.message,\n        data: error.details,\n      });\n    }\n\n    return new APICallError({\n      message: error.message,\n      url: 'oci-genai',\n      requestBodyValues: undefined,\n      statusCode: error.statusCode,\n      responseHeaders: error.statusCode ? { status: String(error.statusCode) } : undefined,\n      responseBody: undefined,\n      cause: error.cause,\n      isRetryable: error.retryable,\n    });\n  }\n\n  const statusCode =\n    (error as { statusCode?: number })?.statusCode ?? (error as { status?: number })?.status;\n  const retryable = statusCode ? isRetryableStatusCode(statusCode) : false;\n  const responseHeaders = (error as { responseHeaders?: Record<string, string> })?.responseHeaders;\n  const opcRequestId = (error as { opcRequestId?: string })?.opcRequestId;\n  const responseBody = (error as { responseBody?: string })?.responseBody;\n  const url = (error as { url?: string })?.url ?? 'oci-genai';\n\n  let message = error instanceof Error ? error.message : String(error);\n\n  if (statusCode === 401) {\n    message += '\\nCheck OCI authentication configuration.';\n  } else if (statusCode === 403) {\n    message += '\\nCheck IAM policies and compartment access.';\n  } else if (statusCode === 404) {\n    message += '\\nCheck model ID and regional availability.';\n  } else if (statusCode === 429) {\n    message += '\\nRate limit exceeded. Implement retry with backoff.';\n  }\n\n  return new APICallError({\n    message,\n    url,\n    requestBodyValues: undefined,\n    statusCode,\n    responseHeaders:\n      responseHeaders ?? (opcRequestId ? { 'opc-request-id': opcRequestId } : undefined),\n    responseBody,\n    cause: error,\n    isRetryable: retryable,\n  });\n}\n","/**\n * Retry utility with exponential backoff for transient failures.\n */\n\nexport interface RetryOptions {\n  /** Maximum number of retry attempts (default: 3) */\n  maxRetries?: number;\n  /** Base delay in milliseconds (default: 100) */\n  baseDelayMs?: number;\n  /** Maximum delay in milliseconds (default: 10000) */\n  maxDelayMs?: number;\n  /** Custom function to determine if error is retryable */\n  isRetryable?: (error: unknown) => boolean;\n}\n\nconst DEFAULT_OPTIONS: Required<Omit<RetryOptions, 'isRetryable'>> = {\n  maxRetries: 3,\n  baseDelayMs: 100,\n  maxDelayMs: 10000,\n};\n\nconst RETRYABLE_ERROR_CODES = ['ECONNRESET', 'ETIMEDOUT', 'ENOTFOUND', 'ECONNREFUSED', 'EAI_AGAIN'];\n\nconst RETRYABLE_ERROR_MESSAGES = ['socket hang up', 'network error', 'fetch failed'];\n\n/**\n * Determines if an error is retryable based on its properties.\n */\nexport function isRetryableError(error: unknown): boolean {\n  if (!(error instanceof Error)) {\n    return false;\n  }\n\n  // Check HTTP status codes\n  const status =\n    (error as { status?: number }).status ?? (error as { statusCode?: number }).statusCode;\n  if (typeof status === 'number') {\n    // Retry on 429 (rate limit) and 5xx (server errors)\n    if (status === 429 || (status >= 500 && status < 600)) {\n      return true;\n    }\n    // Don't retry on other status codes (4xx client errors)\n    if (status >= 400 && status < 500) {\n      return false;\n    }\n  }\n\n  // Check error codes (Node.js network errors)\n  const code = (error as { code?: string }).code;\n  if (code && RETRYABLE_ERROR_CODES.includes(code)) {\n    return true;\n  }\n\n  // Check error messages for common patterns\n  const message = error.message.toLowerCase();\n  for (const pattern of RETRYABLE_ERROR_MESSAGES) {\n    if (message.includes(pattern.toLowerCase())) {\n      return true;\n    }\n  }\n\n  // Check for specific error code patterns in message\n  for (const errorCode of RETRYABLE_ERROR_CODES) {\n    if (error.message.includes(errorCode)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/**\n * Calculates delay with exponential backoff and jitter.\n */\nfunction calculateDelay(attempt: number, baseDelayMs: number, maxDelayMs: number): number {\n  // Exponential backoff: base * 2^attempt\n  const exponentialDelay = baseDelayMs * Math.pow(2, attempt);\n\n  // Add jitter (25%)\n  const jitter = exponentialDelay * 0.25 * (Math.random() * 2 - 1);\n\n  // Clamp to max delay\n  return Math.min(exponentialDelay + jitter, maxDelayMs);\n}\n\n/**\n * Executes a function with automatic retry on transient failures.\n */\nexport async function withRetry<T>(fn: () => Promise<T>, options?: RetryOptions): Promise<T> {\n  const {\n    maxRetries = DEFAULT_OPTIONS.maxRetries,\n    baseDelayMs = DEFAULT_OPTIONS.baseDelayMs,\n    maxDelayMs = DEFAULT_OPTIONS.maxDelayMs,\n    isRetryable = isRetryableError,\n  } = options ?? {};\n\n  let lastError: unknown;\n\n  for (let attempt = 0; attempt <= maxRetries; attempt++) {\n    try {\n      return await fn();\n    } catch (error) {\n      lastError = error;\n\n      // Don't retry if this is the last attempt or error is not retryable\n      if (attempt === maxRetries || !isRetryable(error)) {\n        throw error;\n      }\n\n      // Calculate delay and wait before retry\n      const delay = calculateDelay(attempt, baseDelayMs, maxDelayMs);\n      await new Promise((resolve) => setTimeout(resolve, delay));\n    }\n  }\n\n  // Should never reach here, but TypeScript needs this\n  throw lastError;\n}\n","/**\n * Timeout utility for wrapping async operations with time limits.\n */\n\n/**\n * Error thrown when an operation exceeds its timeout.\n */\nexport class TimeoutError extends Error {\n  readonly name = 'TimeoutError';\n  readonly timeoutMs: number;\n  readonly operation?: string;\n\n  constructor(timeoutMs: number, operation?: string) {\n    const message = operation\n      ? `${operation} timed out after ${timeoutMs}ms`\n      : `Operation timed out after ${timeoutMs}ms`;\n    super(message);\n    this.timeoutMs = timeoutMs;\n    this.operation = operation;\n\n    // Maintains proper stack trace for where our error was thrown\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, TimeoutError);\n    }\n  }\n}\n\n/**\n * Wraps a promise with a timeout.\n *\n * @param promise - The promise to wrap\n * @param timeoutMs - Maximum time to wait in milliseconds\n * @param operation - Optional name for the operation (for error messages)\n * @returns The result of the promise if it completes in time\n * @throws TimeoutError if the timeout is exceeded\n * @throws The original error if the promise rejects\n *\n * @example\n * ```typescript\n * // Basic usage\n * const result = await withTimeout(fetch(url), 5000);\n *\n * // With operation name\n * const result = await withTimeout(\n *   fetchFromOCI(params),\n *   10000,\n *   'OCI API request'\n * );\n * ```\n */\nexport function withTimeout<T>(\n  promise: Promise<T>,\n  timeoutMs: number,\n  operation?: string\n): Promise<T> {\n  let timeoutId: ReturnType<typeof setTimeout>;\n\n  const timeoutPromise = new Promise<never>((_, reject) => {\n    timeoutId = setTimeout(() => {\n      reject(new TimeoutError(timeoutMs, operation));\n    }, timeoutMs);\n  });\n\n  return Promise.race([promise, timeoutPromise]).finally(() => {\n    clearTimeout(timeoutId);\n  });\n}\n","import { z } from 'zod';\nimport { OCIValidationError } from '../errors';\n\n/**\n * Discriminated union for on-demand serving mode\n * Requires modelId when type is ON_DEMAND\n */\nconst OnDemandServingModeSchema = z.object({\n  type: z.literal('ON_DEMAND'),\n  modelId: z.string().min(1, { message: 'modelId is required for ON_DEMAND serving' }),\n  endpointId: z.string().optional(),\n});\n\n/**\n * Discriminated union for dedicated serving mode\n * Requires endpointId when type is DEDICATED\n */\nconst DedicatedServingModeSchema = z.object({\n  type: z.literal('DEDICATED'),\n  modelId: z.string().optional(),\n  endpointId: z.string().min(1, { message: 'endpointId is required for DEDICATED serving' }),\n});\n\n/**\n * Serving mode schema using discriminated union\n * Provides better type narrowing and enforces required fields per mode\n */\nconst ServingModeSchema = z\n  .discriminatedUnion('type', [OnDemandServingModeSchema, DedicatedServingModeSchema])\n  .describe('Model serving mode configuration');\n\n/**\n * Zod schema for OCI provider options.\n *\n * Validates user-provided configuration at runtime, ensuring\n * type safety for options passed through providerOptions.oci.\n *\n * Best practices implemented:\n * - object-discriminated-unions: ServingMode uses discriminated union\n * - object-strict-vs-strip: .strict() rejects unknown keys at API boundary\n * - refine-vs-superrefine: Cross-field validation for tokenBudget/thinking\n *\n * @example\n * ```typescript\n * const result = OCIProviderOptionsSchema.safeParse(userInput);\n * if (!result.success) {\n *   // Handle validation errors\n * }\n * ```\n */\nexport const OCIProviderOptionsSchema = z\n  .object({\n    /**\n     * Reasoning effort level for models that support extended thinking.\n     * Only applies to Generic API format models (e.g., Grok, Gemini).\n     */\n    reasoningEffort: z\n      .enum(['none', 'minimal', 'low', 'medium', 'high'])\n      .optional()\n      .describe('Reasoning effort level for Generic API format models'),\n\n    /**\n     * Enable thinking/reasoning for Cohere models.\n     */\n    thinking: z.boolean().optional().describe('Enable thinking mode for Cohere models'),\n\n    /**\n     * Token budget for thinking/reasoning.\n     * Limits the number of tokens used for extended reasoning.\n     * Requires thinking: true to be set.\n     */\n    tokenBudget: z\n      .number()\n      .int()\n      .positive()\n      .optional()\n      .describe('Maximum tokens for reasoning (must be positive integer)'),\n\n    /**\n     * Serving mode for the model using discriminated union.\n     * ON_DEMAND requires modelId, DEDICATED requires endpointId.\n     */\n    servingMode: ServingModeSchema.optional(),\n\n    /**\n     * Custom compartment ID to use for this request.\n     * Overrides the default compartment from config.\n     */\n    compartmentId: z.string().optional().describe('Compartment ID override'),\n\n    /**\n     * Custom endpoint URL to use for this request.\n     * Overrides the default endpoint from config.\n     */\n    endpoint: z.string().url().optional().describe('Endpoint URL override'),\n\n    /**\n     * Per-request options for timeout and retry configuration.\n     */\n    requestOptions: z\n      .object({\n        timeoutMs: z.number().int().positive().optional(),\n        retry: z\n          .object({\n            enabled: z.boolean().optional(),\n            maxRetries: z.number().int().nonnegative().optional(),\n            baseDelayMs: z.number().int().positive().optional(),\n            maxDelayMs: z.number().int().positive().optional(),\n          })\n          .strict()\n          .optional(),\n      })\n      .strict()\n      .optional()\n      .describe('Per-request timeout and retry configuration'),\n  })\n  .strict()\n  .refine((data) => !data.tokenBudget || data.thinking === true, {\n    message: 'tokenBudget requires thinking to be enabled',\n    path: ['tokenBudget'],\n  });\n\n/**\n * Inferred TypeScript type from the Zod schema.\n * Use this instead of manually defining the interface.\n */\nexport type OCIProviderOptions = z.infer<typeof OCIProviderOptionsSchema>;\n\n/**\n * Input type (before validation/transformation).\n * Useful for accepting looser input types.\n */\nexport type OCIProviderOptionsInput = z.input<typeof OCIProviderOptionsSchema>;\n\n/**\n * Parses and validates provider options, throwing on invalid input.\n *\n * @param options - Raw options from providerOptions.oci\n * @returns Validated OCIProviderOptions\n * @throws OCIValidationError if validation fails\n */\nexport function parseProviderOptions(options: unknown): OCIProviderOptions {\n  if (options === undefined || options === null) {\n    return {};\n  }\n\n  const result = OCIProviderOptionsSchema.safeParse(options);\n\n  if (!result.success) {\n    const issues = result.error.issues\n      .map((issue) => `${issue.path.join('.')}: ${issue.message}`)\n      .join('; ');\n\n    throw new OCIValidationError(`Invalid OCI provider options: ${issues}`, {\n      issues: result.error.issues,\n    });\n  }\n\n  return result.data;\n}\n","/**\n * Zod schemas for OCI GenAI Provider settings validation\n *\n * Following Zod best practices:\n * - schema-use-enums: Using z.enum for fixed string values\n * - type-use-z-infer: Using z.infer for type derivation\n * - error-custom-messages: Providing custom error messages\n * - parse-use-safeparse: Exposing safeParse for user input\n * - compose-shared-schemas: Hardcoded OCID patterns for each resource type\n *\n * OCI OCID Format Reference:\n * - Format: ocid1.<resource-type>.<realm>.[region.]<unique-id>\n * - Example: ocid1.compartment.oc1..aaaaaaaxxxxxxx\n */\nimport { z } from 'zod';\nimport { OCIValidationError } from '../errors';\n\n/**\n * OCI region identifier pattern\n * Format: <geo>-<city>-<number> (e.g., us-chicago-1, eu-frankfurt-1)\n * See: https://docs.oracle.com/en-us/iaas/Content/General/Concepts/regions.htm\n */\nconst regionPattern = /^[a-z]{2,3}-[a-z]+-\\d+$/;\n\n/**\n * Hardcoded OCID patterns for specific resource types\n * Using literal regexes to avoid ReDoS vulnerabilities (CWE-1333)\n */\nconst OCID_PATTERNS = {\n  /** Pattern for compartment OCIDs */\n  compartment: /^ocid1\\.compartment\\.[a-z0-9]+\\.[a-z0-9-]*\\.[a-z0-9]+$/i,\n  /** Pattern for generative AI endpoint OCIDs */\n  generativeaiendpoint: /^ocid1\\.generativeaiendpoint\\.[a-z0-9]+\\.[a-z0-9-]*\\.[a-z0-9]+$/i,\n  /** Pattern for any OCI resource OCID */\n  generic: /^ocid1\\.[a-z0-9]+\\.[a-z0-9]+\\.[a-z0-9-]*\\.[a-z0-9]+$/i,\n} as const;\n\n/**\n * Generic OCID schema for any OCI resource\n * Use specific schemas (CompartmentIdSchema, EndpointIdSchema) when the resource type is known\n */\nexport const OcidSchema = z\n  .string()\n  .regex(OCID_PATTERNS.generic, {\n    message: 'Invalid OCID format. Expected format: ocid1.<resource-type>.<realm>.[region.]<id>',\n  })\n  .describe('An OCI resource identifier (OCID)');\n\n/**\n * Schema for OCI compartment ID\n */\nexport const CompartmentIdSchema = z\n  .string()\n  .regex(OCID_PATTERNS.compartment, {\n    message: 'Invalid compartment ID format. Expected OCID format: ocid1.compartment.oc1..xxxxx',\n  })\n  .describe('The compartment OCID for OCI GenAI requests');\n\n/**\n * Schema for OCI region identifier\n */\nexport const RegionSchema = z\n  .string()\n  .regex(regionPattern, {\n    message: 'Invalid region format. Expected format: <geo>-<city>-<number> (e.g., us-chicago-1)',\n  })\n  .describe('The OCI region identifier');\n\n/**\n * Schema for OCI config profile name\n */\nexport const ConfigProfileSchema = z\n  .string()\n  .min(1, { message: 'Config profile cannot be empty' })\n  .default('DEFAULT')\n  .describe('The OCI config profile name from ~/.oci/config');\n\n/**\n * Schema for serving mode\n * OCI GenAI supports on-demand (shared) and dedicated AI clusters\n */\nexport const ServingModeSchema = z\n  .enum(['on-demand', 'dedicated'], {\n    errorMap: () => ({ message: \"Serving mode must be either 'on-demand' or 'dedicated'\" }),\n  })\n  .default('on-demand')\n  .describe('The serving mode for model inference');\n\n/**\n * Schema for endpoint ID (used with dedicated serving mode)\n */\nexport const EndpointIdSchema = z\n  .string()\n  .regex(OCID_PATTERNS.generativeaiendpoint, {\n    message:\n      'Invalid endpoint ID format. Expected OCID format: ocid1.generativeaiendpoint.oc1..xxxxx',\n  })\n  .describe('The endpoint OCID for dedicated serving mode');\n\n/**\n * Schema for OCI GenAI provider settings\n */\nexport const OCIProviderSettingsSchema = z\n  .object({\n    compartmentId: CompartmentIdSchema.optional(),\n    region: RegionSchema.optional(),\n    configProfile: ConfigProfileSchema.optional(),\n    servingMode: ServingModeSchema.optional(),\n    endpointId: EndpointIdSchema.optional(),\n  })\n  .refine(\n    (data) => {\n      // If servingMode is 'dedicated', endpointId should be provided\n      if (data.servingMode === 'dedicated' && !data.endpointId) {\n        return false;\n      }\n      return true;\n    },\n    {\n      message: \"endpointId is required when servingMode is 'dedicated'\",\n      path: ['endpointId'],\n    }\n  )\n  .describe('Configuration settings for the OCI GenAI provider');\n\n/**\n * Type inferred from the schema (input - before transforms)\n */\nexport type OCIProviderSettingsInput = z.input<typeof OCIProviderSettingsSchema>;\n\n/**\n * Type inferred from the schema (output - after transforms/defaults)\n */\nexport type OCIProviderSettingsValidated = z.output<typeof OCIProviderSettingsSchema>;\n\n/**\n * Validate provider settings with safeParse (returns success/error, doesn't throw)\n */\nexport function validateProviderSettings(settings: unknown) {\n  return OCIProviderSettingsSchema.safeParse(settings);\n}\n\n/**\n * Parse provider settings (throws OCIValidationError on failure)\n * Consistent error wrapping with parseProviderOptions\n */\nexport function parseProviderSettings(settings: unknown): OCIProviderSettingsValidated {\n  const result = OCIProviderSettingsSchema.safeParse(settings);\n\n  if (!result.success) {\n    const issues = result.error.issues\n      .map((issue) => `${issue.path.join('.')}: ${issue.message}`)\n      .join('; ');\n\n    throw new OCIValidationError(`Invalid OCI provider settings: ${issues}`, {\n      issues: result.error.issues,\n    });\n  }\n\n  return result.data;\n}\n\n/**\n * Schema for model ID validation\n * Supports both on-demand model IDs and dedicated endpoint OCIDs\n */\nexport const ModelIdSchema = z\n  .string()\n  .min(1, { message: 'Model ID cannot be empty' })\n  .describe('The model ID or endpoint OCID');\n\n/**\n * Schema for chat model options\n */\nexport const OCIChatModelIdSchema = z.object({\n  modelId: ModelIdSchema,\n  isDedicatedEndpoint: z.boolean().optional().default(false),\n});\n\nexport type OCIChatModelId = z.infer<typeof OCIChatModelIdSchema>;\n","import type { JSONObject } from '@ai-sdk/provider';\nimport { InvalidArgumentError as AISDKInvalidArgumentError } from '@ai-sdk/provider';\nimport type { OCIServingMode } from '../types';\nimport { parseProviderOptions, type OCIProviderOptions } from './schemas';\n\ntype ProviderOptions = Record<string, JSONObject> | undefined;\n\nexport type ResolvedServingMode =\n  | {\n      servingType: 'ON_DEMAND';\n      modelId: string;\n    }\n  | {\n      servingType: 'DEDICATED';\n      endpointId: string;\n    };\n\n/**\n * Extracts and validates OCI provider options from the providerOptions object.\n * Uses Zod schema for runtime validation of user-provided options.\n *\n * @throws OCIValidationError if options are invalid\n */\nexport function getOCIProviderOptions(\n  providerOptions?: ProviderOptions\n): OCIProviderOptions | undefined {\n  if (!providerOptions) {\n    return undefined;\n  }\n\n  const raw = providerOptions.oci;\n  if (!raw || typeof raw !== 'object') {\n    return undefined;\n  }\n\n  // Validate with Zod schema - throws OCIValidationError on invalid input\n  return parseProviderOptions(raw);\n}\n\n// Re-export for convenience\nexport type { OCIProviderOptions } from './schemas';\n\nexport function resolveServingMode(\n  modelId: string,\n  configMode?: OCIServingMode,\n  overrideMode?: OCIServingMode\n): ResolvedServingMode {\n  const mode = overrideMode ?? configMode;\n\n  if (!mode || mode.type === 'ON_DEMAND') {\n    return {\n      servingType: 'ON_DEMAND',\n      modelId: mode?.modelId ?? modelId,\n    };\n  }\n\n  if (!mode.endpointId) {\n    throw new AISDKInvalidArgumentError({\n      argument: 'providerOptions.oci.servingMode.endpointId',\n      message: 'Dedicated serving requires an endpointId.',\n    });\n  }\n\n  return {\n    servingType: 'DEDICATED',\n    endpointId: mode.endpointId,\n  };\n}\n\nexport function resolveCompartmentId(\n  configCompartmentId: string,\n  overrideCompartmentId?: string\n): string {\n  return overrideCompartmentId ?? configCompartmentId;\n}\n\nexport function resolveEndpoint(\n  configEndpoint: string | undefined,\n  overrideEndpoint?: string\n): string | undefined {\n  return overrideEndpoint ?? configEndpoint;\n}\n","import type { RequestOptions } from '../types';\n\n/**\n * Default request options for retry and timeout behavior.\n */\nexport const DEFAULT_REQUEST_OPTIONS: Required<RequestOptions> = {\n  timeoutMs: 30000,\n  retry: {\n    enabled: true,\n    maxRetries: 3,\n    baseDelayMs: 100,\n    maxDelayMs: 10000,\n  },\n};\n\n/**\n * Merge config and per-request options with defaults.\n */\nexport function resolveRequestOptions(\n  configOptions?: RequestOptions,\n  perRequestOptions?: RequestOptions\n): Required<RequestOptions> {\n  return {\n    timeoutMs:\n      perRequestOptions?.timeoutMs ?? configOptions?.timeoutMs ?? DEFAULT_REQUEST_OPTIONS.timeoutMs,\n    retry: {\n      ...DEFAULT_REQUEST_OPTIONS.retry,\n      ...configOptions?.retry,\n      ...perRequestOptions?.retry,\n    },\n  };\n}\n","/**\n * OCI SDK Type Definitions\n *\n * Provides strict TypeScript types for OCI GenAI SDK constructs\n * that are not fully typed in the SDK itself. These types ensure\n * 100% type safety without relying on `as any` casts.\n *\n * Note: We use string literals that match OCI SDK enum values rather than\n * importing the SDK enums directly. This ensures compatibility with test mocks\n * and avoids runtime dependencies on the SDK's enum implementation.\n */\n\n// =============================================================================\n// API Format Types\n// =============================================================================\n\n/**\n * API format for OCI GenAI chat requests.\n * Determines the message structure and capabilities available.\n */\nexport type OCIApiFormat = 'GENERIC' | 'COHERE' | 'COHEREV2';\n\n// =============================================================================\n// Reasoning Types (Generic API Format)\n// =============================================================================\n\n/**\n * Reasoning effort level for Generic API format models.\n * These string values match OCI SDK's GenericChatRequest.ReasoningEffort enum.\n */\nexport type OCIReasoningEffort = 'NONE' | 'MINIMAL' | 'LOW' | 'MEDIUM' | 'HIGH';\n\n/**\n * Maps provider-level reasoning effort string to OCI ReasoningEffort.\n * Returns a string that is compatible with the SDK's ReasoningEffort enum.\n */\nexport function toOCIReasoningEffort(effort: string): OCIReasoningEffort {\n  const upper = effort.toUpperCase();\n  switch (upper) {\n    case 'NONE':\n      return 'NONE';\n    case 'MINIMAL':\n      return 'MINIMAL';\n    case 'LOW':\n      return 'LOW';\n    case 'MEDIUM':\n      return 'MEDIUM';\n    case 'HIGH':\n      return 'HIGH';\n    default:\n      return 'MEDIUM'; // default fallback\n  }\n}\n\n// =============================================================================\n// Thinking Types (Cohere API Format)\n// =============================================================================\n\n/**\n * Thinking/reasoning type for Cohere API format models.\n * These string values match OCI SDK's CohereThinkingV2.Type enum.\n */\nexport type OCIThinkingType = 'ENABLED' | 'DISABLED';\n\n/**\n * Thinking configuration for Cohere models.\n * Structure matches OCI SDK's CohereThinkingV2 interface.\n */\nexport interface OCIThinkingConfig {\n  type: OCIThinkingType;\n  tokenBudget?: number;\n}\n\n/**\n * Creates a thinking configuration for Cohere models.\n */\nexport function createThinkingConfig(enabled: boolean, tokenBudget?: number): OCIThinkingConfig {\n  return {\n    type: enabled ? 'ENABLED' : 'DISABLED',\n    tokenBudget,\n  };\n}\n\n// =============================================================================\n// Token Usage Types\n// =============================================================================\n\n/**\n * Detailed breakdown of completion tokens.\n */\nexport interface OCICompletionTokensDetails {\n  /** Tokens used for reasoning/thinking */\n  reasoningTokens?: number;\n  /** Prediction tokens that were accepted */\n  acceptedPredictionTokens?: number;\n  /** Prediction tokens that were rejected */\n  rejectedPredictionTokens?: number;\n}\n\n/**\n * Full usage statistics from OCI response.\n */\nexport interface OCIUsageStats {\n  promptTokens?: number;\n  completionTokens?: number;\n  completionTokensDetails?: OCICompletionTokensDetails;\n}\n\n// =============================================================================\n// Type Guards\n// =============================================================================\n\n/**\n * Type guard for OCIApiFormat.\n */\nexport function isValidApiFormat(value: unknown): value is OCIApiFormat {\n  return value === 'GENERIC' || value === 'COHERE' || value === 'COHEREV2';\n}\n","import type {\n  LanguageModelV3,\n  LanguageModelV3CallOptions,\n  LanguageModelV3GenerateResult,\n  LanguageModelV3StreamPart,\n  LanguageModelV3StreamResult,\n  SharedV3Warning,\n  LanguageModelV3FinishReason,\n  LanguageModelV3Usage,\n  LanguageModelV3Content,\n} from '@ai-sdk/provider';\nimport { NoSuchModelError } from '@ai-sdk/provider';\nimport { GenerativeAiInferenceClient, models as OCIModel } from 'oci-generativeaiinference';\nimport { Region } from 'oci-common';\nimport type { OCIConfig, RequestOptions } from '../types';\nimport { isValidModelId, getModelMetadata, supportsReasoning, supportsVision } from './registry';\nimport { convertToOCIMessages } from './converters/messages';\nimport type { OCIMessage } from './converters/messages';\nimport { convertToCohereFormat } from './converters/cohere-messages';\nimport { convertToOCITools, convertToOCIToolChoice, supportsToolCalling } from './converters/tools';\nimport { parseSSEStream } from '../shared/streaming/sse-parser';\nimport { createAuthProvider, getRegion, getCompartmentId } from '../auth/index.js';\nimport { handleOCIError } from '../shared/errors/index.js';\nimport { withRetry, withTimeout, isRetryableError } from '../shared/utils/index.js';\nimport {\n  getOCIProviderOptions,\n  resolveCompartmentId,\n  resolveEndpoint,\n  resolveServingMode,\n} from '../shared/provider-options';\nimport { resolveRequestOptions } from '../shared/request-options';\nimport {\n  type OCIApiFormat,\n  toOCIReasoningEffort,\n  createThinkingConfig,\n} from '../shared/oci-sdk-types';\n\ntype ChatRequest =\n  | OCIModel.GenericChatRequest\n  | OCIModel.CohereChatRequest\n  | OCIModel.CohereChatRequestV2;\n\nexport class OCILanguageModel implements LanguageModelV3 {\n  readonly specificationVersion = 'v3';\n  readonly provider = 'oci-genai';\n  readonly defaultObjectGenerationMode = 'tool';\n  readonly supportedUrls: Record<string, RegExp[]> = {};\n  private _client?: GenerativeAiInferenceClient;\n\n  constructor(\n    public readonly modelId: string,\n    private readonly config: OCIConfig\n  ) {\n    if (!isValidModelId(modelId)) {\n      throw new NoSuchModelError({\n        modelId,\n        modelType: 'languageModel',\n      });\n    }\n  }\n\n  private async getClient(endpointOverride?: string): Promise<GenerativeAiInferenceClient> {\n    const resolvedEndpoint = resolveEndpoint(this.config.endpoint, endpointOverride);\n\n    if (!this._client || (endpointOverride && endpointOverride !== this.config.endpoint)) {\n      try {\n        const authProvider = await createAuthProvider(this.config);\n        const regionId = getRegion(this.config);\n\n        const client = new GenerativeAiInferenceClient({\n          authenticationDetailsProvider: authProvider,\n        });\n\n        client.region = Region.fromRegionId(regionId);\n\n        if (resolvedEndpoint) {\n          client.endpoint = resolvedEndpoint;\n        }\n\n        if (!endpointOverride || endpointOverride === this.config.endpoint) {\n          this._client = client;\n        }\n\n        return client;\n      } catch (error) {\n        const message =\n          error instanceof Error ? error.message : 'Unknown error during client initialization';\n        throw new Error(\n          `Failed to initialize OCI client: ${message}. ` +\n            `Check your OCI configuration (config file, credentials, region).`\n        );\n      }\n    }\n    return this._client;\n  }\n\n  private getRequestOptions(perRequestOptions?: RequestOptions): Required<RequestOptions> {\n    return resolveRequestOptions(this.config.requestOptions, perRequestOptions);\n  }\n\n  private getApiFormat(hasImages: boolean = false): OCIApiFormat {\n    const metadata = getModelMetadata(this.modelId);\n    if (metadata?.family === 'cohere') {\n      // Upgrade to COHEREV2 for vision-capable models when images are present\n      // COHERE V1 format silently drops images, V2 supports them properly\n      if (hasImages && metadata.capabilities.vision) {\n        return 'COHEREV2';\n      }\n      return 'COHERE';\n    }\n    return 'GENERIC';\n  }\n\n  private async executeWithResilience<T>(\n    operation: () => Promise<T>,\n    operationName: string,\n    requestOptions?: RequestOptions\n  ): Promise<T> {\n    const options = this.getRequestOptions(requestOptions);\n    const withTimeoutOperation = (): Promise<T> =>\n      withTimeout(operation(), options.timeoutMs, operationName);\n\n    if (options.retry.enabled) {\n      return withRetry(withTimeoutOperation, {\n        maxRetries: options.retry.maxRetries,\n        baseDelayMs: options.retry.baseDelayMs,\n        maxDelayMs: options.retry.maxDelayMs,\n        isRetryable: isRetryableError,\n      });\n    }\n\n    return withTimeoutOperation();\n  }\n\n  async doGenerate(options: LanguageModelV3CallOptions): Promise<LanguageModelV3GenerateResult> {\n    const { stream, response, request } = await this.doStream(options);\n    const reader = stream.getReader();\n    const warnings: SharedV3Warning[] = [];\n    const content: LanguageModelV3Content[] = [];\n    let usage: LanguageModelV3Usage = {\n      inputTokens: {\n        total: 0,\n        noCache: undefined,\n        cacheRead: undefined,\n        cacheWrite: undefined,\n      },\n      outputTokens: {\n        total: 0,\n        text: undefined,\n        reasoning: undefined,\n      },\n    };\n    let finishReason: LanguageModelV3FinishReason = {\n      unified: 'other',\n      raw: 'initializing',\n    };\n    let providerMetadata: Record<string, any> | undefined;\n\n    try {\n      while (true) {\n        const { done, value } = await reader.read();\n        if (done) break;\n\n        switch (value.type) {\n          case 'stream-start':\n            if (value.warnings) {\n              warnings.push(...value.warnings);\n            }\n            break;\n          case 'text-delta': {\n            const last = content[content.length - 1];\n            if (last?.type === 'text') {\n              last.text += value.delta;\n            } else {\n              content.push({ type: 'text', text: value.delta });\n            }\n            break;\n          }\n          case 'reasoning-delta': {\n            const last = content[content.length - 1];\n            if (last?.type === 'reasoning') {\n              last.text += value.delta;\n            } else {\n              content.push({ type: 'reasoning', text: value.delta });\n            }\n            break;\n          }\n          case 'tool-call':\n            content.push({\n              type: 'tool-call',\n              toolCallId: value.toolCallId,\n              toolName: value.toolName,\n              input: value.input,\n            });\n            break;\n          case 'finish':\n            finishReason = value.finishReason;\n            usage = value.usage;\n            providerMetadata = value.providerMetadata;\n            break;\n          case 'error':\n            throw value.error;\n        }\n      }\n    } finally {\n      reader.releaseLock();\n    }\n\n    return {\n      content,\n      usage,\n      finishReason,\n      request,\n      response,\n      warnings,\n      providerMetadata,\n    };\n  }\n\n  async doStream(options: LanguageModelV3CallOptions): Promise<LanguageModelV3StreamResult> {\n    const messages: OCIMessage[] = convertToOCIMessages(options.prompt);\n    const ociOptions = getOCIProviderOptions(options.providerOptions);\n    const client = await this.getClient(ociOptions?.endpoint);\n    const compartmentId = resolveCompartmentId(\n      getCompartmentId(this.config),\n      ociOptions?.compartmentId\n    );\n\n    // Check for images early - needed for API format selection\n    const hasImages = messages.some((m) => m.content.some((c) => c.type === 'IMAGE'));\n    const apiFormat = this.getApiFormat(hasImages);\n    const warnings: SharedV3Warning[] = [];\n\n    if (options.responseFormat?.type === 'json') {\n      warnings.push({\n        type: 'unsupported',\n        feature: 'responseFormat.json',\n        details: 'OCI response format JSON is not supported in this provider.',\n      });\n    }\n\n    const modelSupportsTools = supportsToolCalling(this.modelId);\n    const modelSupportsReasoning = supportsReasoning(this.modelId);\n    const hasTools = options.tools && options.tools.length > 0;\n    const functionTools = hasTools ? options.tools!.filter((t) => t.type === 'function') : [];\n\n    // Add tools warning for unsupported models (matching doGenerate)\n    if (hasTools && !modelSupportsTools) {\n      warnings.push({\n        type: 'unsupported',\n        feature: 'tools',\n        details: `Model ${this.modelId} does not support tool calling. Supported: Llama 3.1+, Cohere Command R/R+, Grok, Gemini.`,\n      });\n    }\n\n    // Add reasoning model validation (matching doGenerate)\n    if (ociOptions?.reasoningEffort && !modelSupportsReasoning) {\n      warnings.push({\n        type: 'unsupported',\n        feature: 'reasoningEffort',\n        details: `Model ${this.modelId} does not support reasoning. Use a reasoning model like xai.grok-4-1-fast-reasoning or cohere.command-a-reasoning-08-2025.`,\n      });\n    }\n\n    if (ociOptions?.thinking && !modelSupportsReasoning) {\n      warnings.push({\n        type: 'unsupported',\n        feature: 'thinking',\n        details: `Model ${this.modelId} does not support thinking/reasoning. Use a reasoning model like cohere.command-a-reasoning-08-2025.`,\n      });\n    }\n\n    // Vision support validation\n    const modelSupportsVision = supportsVision(this.modelId);\n\n    if (hasImages && !modelSupportsVision) {\n      warnings.push({\n        type: 'unsupported',\n        feature: 'vision',\n        details: `Model ${this.modelId} does not support image input. Use a vision model like meta.llama-3.2-90b-vision-instruct, google.gemini-2.5-flash, or cohere.command-a-vision.`,\n      });\n    }\n\n    // Cohere V1 format silently drops images - warn the user\n    // Note: vision-capable Cohere models are automatically upgraded to COHEREV2 format\n    if (hasImages && apiFormat === 'COHERE') {\n      warnings.push({\n        type: 'unsupported',\n        feature: 'vision',\n        details: `Cohere V1 API format does not support images. Images in your prompt will be ignored. Use a vision-capable model like cohere.command-a-vision which uses the Cohere V2 format.`,\n      });\n    }\n\n    try {\n      const commonParams = {\n        maxTokens: options.maxOutputTokens ? Math.min(options.maxOutputTokens, 4000) : undefined,\n        temperature: options.temperature,\n        topP: options.topP,\n        topK: options.topK ? Math.min(options.topK, 40) : undefined,\n        isStream: true,\n      };\n\n      const toolParams =\n        modelSupportsTools && functionTools.length > 0\n          ? {\n              tools: convertToOCITools(functionTools, apiFormat),\n              ...(options.toolChoice\n                ? { toolChoice: convertToOCIToolChoice(options.toolChoice) }\n                : {}),\n            }\n          : {};\n\n      let chatRequest: ChatRequest;\n      if (apiFormat === 'COHEREV2') {\n        chatRequest = {\n          apiFormat,\n          messages: messages.map((m) => {\n            const content: OCIModel.CohereContentV2[] = m.content.map((c) => {\n              if (c.type === 'IMAGE') {\n                return {\n                  type: 'IMAGE_URL',\n                  imageUrl: c.imageUrl as OCIModel.CohereImageUrlV2,\n                } as OCIModel.CohereImageContentV2;\n              }\n              return { type: 'TEXT', text: c.text ?? '' } as OCIModel.CohereTextContentV2;\n            });\n            return {\n              role: m.role,\n              content,\n            } as OCIModel.CohereMessageV2;\n          }),\n          ...commonParams,\n          ...toolParams,\n        } as OCIModel.CohereChatRequestV2;\n      } else if (apiFormat === 'COHERE') {\n        const cohereFormat = convertToCohereFormat(messages);\n        chatRequest = {\n          apiFormat,\n          ...cohereFormat,\n          ...commonParams,\n          ...toolParams,\n          // Cohere requires isForceSingleStep=true when tool results are present\n          // This ensures multi-step tool use works correctly\n          ...(cohereFormat.hasToolResults ? { isForceSingleStep: true } : {}),\n        } as OCIModel.CohereChatRequest;\n      } else {\n        chatRequest = {\n          apiFormat,\n          messages: messages.map((m) => ({\n            role: m.role,\n            content: m.content as OCIModel.ChatContent[],\n            toolCalls: m.toolCalls,\n            toolCallId: m.toolCallId,\n          })) as OCIModel.Message[],\n          ...commonParams,\n          ...toolParams,\n          stop: options.stopSequences,\n        } as OCIModel.GenericChatRequest;\n      }\n\n      if (ociOptions?.reasoningEffort && apiFormat === 'GENERIC') {\n        const genericReq = chatRequest as OCIModel.GenericChatRequest;\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment -- OCI SDK type mismatch\n        genericReq.reasoningEffort = toOCIReasoningEffort(ociOptions.reasoningEffort) as any;\n      }\n\n      if (ociOptions?.thinking && (apiFormat === 'COHEREV2' || apiFormat === 'COHERE')) {\n        const cohereReq = chatRequest as OCIModel.CohereChatRequestV2;\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment -- OCI SDK type mismatch\n        cohereReq.thinking = createThinkingConfig(true, ociOptions.tokenBudget) as any;\n      }\n\n      if (options.seed !== undefined) chatRequest.seed = options.seed;\n\n      const response = (await this.executeWithResilience<unknown>(\n        () =>\n          client.chat({\n            chatDetails: {\n              compartmentId,\n              servingMode: resolveServingMode(\n                this.modelId,\n                this.config.servingMode,\n                ociOptions?.servingMode\n              ),\n              chatRequest,\n            },\n          }),\n        'OCI chat stream',\n        ociOptions?.requestOptions\n      )) as {\n        body?: ReadableStream<Uint8Array>;\n        headers?: { entries(): IterableIterator<[string, string]> };\n      };\n\n      // response can be ReadableStream (Browser/new SDK) or Response object (Node/Fetch polyfill)\n      // Some mocks might just return the stream directly.\n      const streamInput = response.body ?? (response as unknown as ReadableStream<Uint8Array>);\n\n      if (!streamInput) {\n        throw new Error('No stream received from OCI.');\n      }\n\n      const stream = parseSSEStream(streamInput, {\n        includeRawChunks: options.includeRawChunks,\n      });\n\n      const headers = response.headers ? Object.fromEntries(response.headers.entries()) : undefined;\n\n      return {\n        stream: new ReadableStream<LanguageModelV3StreamPart>({\n          async start(controller) {\n            controller.enqueue({ type: 'stream-start', warnings });\n\n            let hasText = false;\n            let hasReasoning = false;\n            const textId = `text-${Date.now()}`;\n            const reasoningId = `reasoning-${Date.now()}`;\n\n            try {\n              for await (const part of stream) {\n                switch (part.type) {\n                  case 'text-delta':\n                    if (!hasText) {\n                      controller.enqueue({ type: 'text-start', id: textId });\n                      hasText = true;\n                    }\n                    controller.enqueue({\n                      type: 'text-delta',\n                      delta: part.textDelta,\n                      id: textId,\n                    });\n                    break;\n                  case 'reasoning-delta':\n                    if (!hasReasoning) {\n                      controller.enqueue({ type: 'reasoning-start', id: reasoningId });\n                      hasReasoning = true;\n                    }\n                    controller.enqueue({\n                      type: 'reasoning-delta',\n                      delta: part.reasoningDelta,\n                      id: reasoningId,\n                    });\n                    break;\n                  case 'tool-call':\n                    controller.enqueue({\n                      type: 'tool-call',\n                      toolCallId: part.toolCallId,\n                      toolName: part.toolName,\n                      input: part.input,\n                    });\n                    break;\n                  case 'finish':\n                    if (hasText) {\n                      controller.enqueue({ type: 'text-end', id: textId });\n                    }\n                    if (hasReasoning) {\n                      controller.enqueue({ type: 'reasoning-end', id: reasoningId });\n                    }\n                    controller.enqueue({\n                      type: 'finish',\n                      finishReason: part.finishReason,\n                      usage: {\n                        inputTokens: {\n                          total: part.usage.promptTokens,\n                          noCache: undefined,\n                          cacheRead: undefined,\n                          cacheWrite: undefined,\n                        },\n                        outputTokens: {\n                          total: part.usage.completionTokens,\n                          text:\n                            part.usage.reasoningTokens !== undefined\n                              ? part.usage.completionTokens - part.usage.reasoningTokens\n                              : part.usage.completionTokens,\n                          reasoning: part.usage.reasoningTokens,\n                        },\n                      },\n                      providerMetadata: {\n                        oci: { requestId: headers?.['opc-request-id'] },\n                      },\n                    });\n                    break;\n                  case 'raw':\n                    controller.enqueue({ type: 'raw', rawValue: part.rawValue });\n                    break;\n                }\n              }\n            } catch (error) {\n              // Log stream errors for debugging and monitoring\n              console.error('[OCI Stream] Error during stream processing:', error);\n              controller.enqueue({ type: 'error', error });\n            } finally {\n              controller.close();\n            }\n          },\n        }),\n        request: { body: JSON.stringify(messages) },\n        response: {\n          headers,\n        },\n      };\n    } catch (error) {\n      throw handleOCIError(error);\n    }\n  }\n}\n","export interface EmbeddingModelMetadata {\n  id: string;\n  name: string;\n  family: 'cohere';\n  dimensions: 384 | 1024;\n  maxTextsPerBatch: number;\n  maxTokensPerText: number;\n}\n\nexport const EMBEDDING_MODELS: EmbeddingModelMetadata[] = [\n  {\n    id: 'cohere.embed-multilingual-v3.0',\n    name: 'Cohere Embed Multilingual v3.0',\n    family: 'cohere',\n    dimensions: 1024,\n    maxTextsPerBatch: 96,\n    maxTokensPerText: 512,\n  },\n  {\n    id: 'cohere.embed-english-v3.0',\n    name: 'Cohere Embed English v3.0',\n    family: 'cohere',\n    dimensions: 1024,\n    maxTextsPerBatch: 96,\n    maxTokensPerText: 512,\n  },\n  {\n    id: 'cohere.embed-english-light-v3.0',\n    name: 'Cohere Embed English Light v3.0',\n    family: 'cohere',\n    dimensions: 384,\n    maxTextsPerBatch: 96,\n    maxTokensPerText: 512,\n  },\n];\n\nexport function isValidEmbeddingModelId(modelId: string): boolean {\n  return EMBEDDING_MODELS.some((m) => m.id === modelId);\n}\n\nexport function getEmbeddingModelMetadata(modelId: string): EmbeddingModelMetadata | undefined {\n  return EMBEDDING_MODELS.find((m) => m.id === modelId);\n}\n\nexport function getAllEmbeddingModels(): EmbeddingModelMetadata[] {\n  return EMBEDDING_MODELS;\n}\n","import type {\n  EmbeddingModelV3,\n  EmbeddingModelV3CallOptions,\n  EmbeddingModelV3Result,\n} from '@ai-sdk/provider';\nimport { NoSuchModelError, TooManyEmbeddingValuesForCallError } from '@ai-sdk/provider';\nimport { GenerativeAiInferenceClient, models as ociModels } from 'oci-generativeaiinference';\nimport { Region } from 'oci-common';\nimport { createAuthProvider, getCompartmentId, getRegion } from '../auth';\nimport { isValidEmbeddingModelId } from './registry';\nimport type { OCIEmbeddingSettings, RequestOptions } from '../types';\nimport { handleOCIError } from '../shared/errors';\nimport { withRetry, withTimeout, isRetryableError } from '../shared/utils';\nimport {\n  getOCIProviderOptions,\n  resolveCompartmentId,\n  resolveEndpoint,\n  resolveServingMode,\n} from '../shared/provider-options';\nimport { resolveRequestOptions } from '../shared/request-options';\n\ntype Truncate = ociModels.EmbedTextDetails.Truncate;\ntype InputType = ociModels.EmbedTextDetails.InputType;\n\nexport class OCIEmbeddingModel implements EmbeddingModelV3 {\n  readonly specificationVersion = 'v3';\n  readonly provider = 'oci-genai';\n  readonly maxEmbeddingsPerCall = 96;\n  readonly supportsParallelCalls = true;\n\n  private _client?: GenerativeAiInferenceClient;\n\n  constructor(\n    readonly modelId: string,\n    private config: OCIEmbeddingSettings\n  ) {\n    if (!isValidEmbeddingModelId(modelId)) {\n      throw new NoSuchModelError({\n        modelId,\n        modelType: 'embeddingModel',\n      });\n    }\n  }\n\n  private async getClient(endpointOverride?: string): Promise<GenerativeAiInferenceClient> {\n    const resolvedEndpoint = resolveEndpoint(this.config.endpoint, endpointOverride);\n\n    if (!this._client || (endpointOverride && endpointOverride !== this.config.endpoint)) {\n      const authProvider = await createAuthProvider(this.config);\n      const regionId = getRegion(this.config);\n\n      const client = new GenerativeAiInferenceClient({\n        authenticationDetailsProvider: authProvider,\n      });\n\n      // Set region using proper OCI Region API\n      client.region = Region.fromRegionId(regionId);\n\n      if (resolvedEndpoint) {\n        client.endpoint = resolvedEndpoint;\n      }\n\n      if (!endpointOverride || endpointOverride === this.config.endpoint) {\n        this._client = client;\n      }\n\n      return client;\n    }\n\n    return this._client;\n  }\n\n  private getRequestOptions(\n    perRequestOptions?: OCIEmbeddingSettings['requestOptions']\n  ): Required<RequestOptions> {\n    return resolveRequestOptions(this.config.requestOptions, perRequestOptions);\n  }\n\n  private async executeWithResilience<T>(\n    operation: () => Promise<T>,\n    operationName: string,\n    requestOptions?: OCIEmbeddingSettings['requestOptions']\n  ): Promise<T> {\n    const options = this.getRequestOptions(requestOptions);\n\n    const withTimeoutOperation = (): Promise<T> =>\n      withTimeout(operation(), options.timeoutMs, operationName);\n\n    if (options.retry.enabled) {\n      return withRetry(withTimeoutOperation, {\n        maxRetries: options.retry.maxRetries,\n        baseDelayMs: options.retry.baseDelayMs,\n        maxDelayMs: options.retry.maxDelayMs,\n        isRetryable: isRetryableError,\n      });\n    }\n\n    return withTimeoutOperation();\n  }\n\n  async doEmbed(options: EmbeddingModelV3CallOptions): Promise<EmbeddingModelV3Result> {\n    const { values } = options;\n\n    // Validate batch size\n    if (values.length > this.maxEmbeddingsPerCall) {\n      throw new TooManyEmbeddingValuesForCallError({\n        provider: this.provider,\n        modelId: this.modelId,\n        maxEmbeddingsPerCall: this.maxEmbeddingsPerCall,\n        values,\n      });\n    }\n\n    const ociOptions = getOCIProviderOptions(options.providerOptions);\n    const client = await this.getClient(ociOptions?.endpoint);\n    const compartmentId = resolveCompartmentId(\n      getCompartmentId(this.config),\n      ociOptions?.compartmentId\n    );\n\n    try {\n      const response = await this.executeWithResilience(\n        () =>\n          client.embedText({\n            embedTextDetails: {\n              servingMode: resolveServingMode(\n                this.modelId,\n                this.config.servingMode,\n                ociOptions?.servingMode\n              ),\n              compartmentId,\n              inputs: values,\n              truncate: (this.config.truncate ?? 'END') as Truncate,\n              inputType: (this.config.inputType ?? 'SEARCH_DOCUMENT') as InputType,\n            },\n          }),\n        'OCI embed request',\n        ociOptions?.requestOptions\n      );\n\n      const embeddings = response.embedTextResult.embeddings;\n      const usage = response.embedTextResult.usage;\n      const tokenEstimate = values.reduce((sum, text) => sum + Math.ceil(text.length / 4), 0);\n\n      return {\n        embeddings,\n        usage: {\n          tokens: usage?.promptTokens ?? usage?.totalTokens ?? tokenEstimate,\n        },\n        providerMetadata: {\n          oci: {\n            requestId: response.opcRequestId,\n            modelId: response.embedTextResult.modelId ?? this.modelId,\n          },\n        },\n        response: {\n          headers: response.opcRequestId ? { 'opc-request-id': response.opcRequestId } : undefined,\n          body: response,\n        },\n        warnings: [],\n      };\n    } catch (error) {\n      throw handleOCIError(error);\n    }\n  }\n}\n","export interface SpeechModelMetadata {\n  id: string;\n  name: string;\n  family: 'oci-speech';\n  modelName: string;\n  supportedFormats: ('mp3' | 'ogg' | 'pcm')[];\n  maxTextLength: number;\n  defaultVoice?: string;\n  supportedLanguages: string[];\n}\n\n/**\n * TTS_2_NATURAL supported languages (9 languages)\n */\nexport const TTS_2_NATURAL_LANGUAGES = [\n  'en-US',\n  'en-GB',\n  'es-ES',\n  'pt-BR',\n  'hi-IN',\n  'fr-FR',\n  'it-IT',\n  'ja-JP',\n  'cmn-CN',\n] as const;\n\n/**\n * TTS_1_STANDARD supported languages\n */\nexport const TTS_1_STANDARD_LANGUAGES = ['en-US'] as const;\n\nexport const SPEECH_MODELS: SpeechModelMetadata[] = [\n  {\n    id: 'TTS_2_NATURAL',\n    name: 'OCI TTS Natural',\n    family: 'oci-speech',\n    modelName: 'TTS_2_NATURAL',\n    supportedFormats: ['mp3', 'ogg', 'pcm'],\n    maxTextLength: 5000,\n    supportedLanguages: [...TTS_2_NATURAL_LANGUAGES],\n  },\n  {\n    id: 'TTS_1_STANDARD',\n    name: 'OCI TTS Standard',\n    family: 'oci-speech',\n    modelName: 'TTS_1_STANDARD',\n    supportedFormats: ['mp3', 'ogg', 'pcm'],\n    maxTextLength: 5000,\n    supportedLanguages: [...TTS_1_STANDARD_LANGUAGES],\n  },\n];\n\nexport function isValidSpeechModelId(modelId: string): boolean {\n  return SPEECH_MODELS.some((m) => m.id === modelId);\n}\n\nexport function getSpeechModelMetadata(modelId: string): SpeechModelMetadata | undefined {\n  return SPEECH_MODELS.find((m) => m.id === modelId);\n}\n\nexport function getAllSpeechModels(): SpeechModelMetadata[] {\n  return SPEECH_MODELS;\n}\n\n/**\n * Voice metadata for TTS models\n */\nexport interface VoiceMetadata {\n  id: string;\n  name: string;\n  language: string;\n  model: 'TTS_2_NATURAL' | 'TTS_1_STANDARD';\n}\n\n/**\n * Available voices for TTS models\n */\nconst AVAILABLE_VOICES: VoiceMetadata[] = [\n  // TTS_2_NATURAL voices\n  { id: 'en-US-AriaNeural', name: 'Aria (US English)', language: 'en-US', model: 'TTS_2_NATURAL' },\n  { id: 'en-US-GuyNeural', name: 'Guy (US English)', language: 'en-US', model: 'TTS_2_NATURAL' },\n  {\n    id: 'en-GB-LibbyNeural',\n    name: 'Libby (UK English)',\n    language: 'en-GB',\n    model: 'TTS_2_NATURAL',\n  },\n  { id: 'en-GB-RyanNeural', name: 'Ryan (UK English)', language: 'en-GB', model: 'TTS_2_NATURAL' },\n  { id: 'es-ES-AlvaroNeural', name: 'Alvaro (Spanish)', language: 'es-ES', model: 'TTS_2_NATURAL' },\n  {\n    id: 'pt-BR-FranciscaNeural',\n    name: 'Francisca (Portuguese BR)',\n    language: 'pt-BR',\n    model: 'TTS_2_NATURAL',\n  },\n  { id: 'fr-FR-DeniseNeural', name: 'Denise (French)', language: 'fr-FR', model: 'TTS_2_NATURAL' },\n  {\n    id: 'it-IT-IsabellaNeural',\n    name: 'Isabella (Italian)',\n    language: 'it-IT',\n    model: 'TTS_2_NATURAL',\n  },\n  {\n    id: 'ja-JP-NanamiNeural',\n    name: 'Nanami (Japanese)',\n    language: 'ja-JP',\n    model: 'TTS_2_NATURAL',\n  },\n  {\n    id: 'cmn-CN-XiaoxuanNeural',\n    name: 'Xiaoxuan (Mandarin)',\n    language: 'cmn-CN',\n    model: 'TTS_2_NATURAL',\n  },\n  // TTS_1_STANDARD voices\n  {\n    id: 'en-US-Standard-A',\n    name: 'Standard A (US English)',\n    language: 'en-US',\n    model: 'TTS_1_STANDARD',\n  },\n];\n\nexport function getAllVoices(): VoiceMetadata[] {\n  return AVAILABLE_VOICES;\n}\n","import { AIServiceSpeechClient, models } from 'oci-aispeech';\nimport { Region } from 'oci-common';\nimport type { SharedV3Warning, SharedV2Headers, JSONObject } from '@ai-sdk/provider';\nimport { NoSuchModelError } from '@ai-sdk/provider';\nimport { createAuthProvider, getRegion, getCompartmentId } from '../auth';\nimport { getSpeechModelMetadata, isValidSpeechModelId } from './registry';\nimport type { OCISpeechSettings } from '../types';\nimport type { SpeechModelV3, SpeechModelV3CallOptions } from '@ai-sdk/provider';\nimport { handleOCIError } from '../shared/errors';\nimport {\n  getOCIProviderOptions,\n  resolveCompartmentId,\n  resolveEndpoint,\n} from '../shared/provider-options';\n\nexport class OCISpeechModel implements SpeechModelV3 {\n  readonly specificationVersion = 'v3';\n  readonly provider = 'oci-genai';\n  private readonly voice: string;\n  private readonly _config: OCISpeechSettings;\n  private _client?: AIServiceSpeechClient;\n\n  constructor(\n    readonly modelId: string,\n    config: OCISpeechSettings\n  ) {\n    if (!isValidSpeechModelId(modelId)) {\n      throw new NoSuchModelError({\n        modelId,\n        modelType: 'speechModel',\n      });\n    }\n    const metadata = getSpeechModelMetadata(modelId);\n    const defaultVoice = metadata?.defaultVoice;\n    this.voice = config.voice ?? defaultVoice ?? 'en-US-AriaNeural';\n    this._config = config;\n  }\n\n  private async getClient(endpointOverride?: string): Promise<AIServiceSpeechClient> {\n    const resolvedEndpoint = resolveEndpoint(this._config.endpoint, endpointOverride);\n\n    if (!this._client || (endpointOverride && endpointOverride !== this._config.endpoint)) {\n      const authProvider = await createAuthProvider(this._config);\n      const region = getRegion(this._config);\n\n      const client = new AIServiceSpeechClient({\n        authenticationDetailsProvider: authProvider,\n      });\n\n      client.region = Region.fromRegionId(region);\n\n      if (resolvedEndpoint) {\n        client.endpoint = resolvedEndpoint;\n      }\n\n      if (!endpointOverride || endpointOverride === this._config.endpoint) {\n        this._client = client;\n      }\n\n      return client;\n    }\n\n    return this._client;\n  }\n\n  getVoice(): string {\n    return this.voice;\n  }\n\n  async doGenerate(options: SpeechModelV3CallOptions): Promise<{\n    audio: string | Uint8Array;\n    warnings: SharedV3Warning[];\n    request?: { body?: unknown };\n    response: { timestamp: Date; modelId: string; headers?: SharedV2Headers; body?: unknown };\n    providerMetadata?: Record<string, JSONObject>;\n  }> {\n    const startTime = new Date();\n    const { text } = options;\n    const warnings: SharedV3Warning[] = [];\n\n    if (options.instructions) {\n      warnings.push({\n        type: 'unsupported',\n        feature: 'instructions',\n        details: 'OCI speech does not support instruction prompts.',\n      });\n    }\n\n    if (options.speed !== undefined) {\n      warnings.push({\n        type: 'unsupported',\n        feature: 'speed',\n        details: 'OCI speech does not support speed adjustments.',\n      });\n    }\n\n    if (options.language) {\n      warnings.push({\n        type: 'unsupported',\n        feature: 'language',\n        details: 'OCI speech does not support language override per request.',\n      });\n    }\n\n    const metadata = getSpeechModelMetadata(this.modelId);\n    if (!metadata) throw new Error('Invalid model metadata');\n\n    if (text.length > metadata.maxTextLength) {\n      throw new Error(\n        'Text length (' + text.length + ') exceeds maximum allowed (' + metadata.maxTextLength + ')'\n      );\n    }\n\n    const ociOptions = getOCIProviderOptions(options.providerOptions);\n    const client = await this.getClient(ociOptions?.endpoint);\n    const compartmentId = resolveCompartmentId(\n      getCompartmentId(this._config),\n      ociOptions?.compartmentId\n    );\n    const voice = options.voice ?? this.voice;\n\n    // Map format to OCI output format enum\n    const outputFormat = this.mapOutputFormat(options.outputFormat ?? this._config.format);\n\n    // Build synthesize speech request using proper OCI SDK types\n    const synthesizeSpeechDetails: models.SynthesizeSpeechDetails = {\n      text,\n      isStreamEnabled: false,\n      compartmentId,\n      configuration: {\n        modelFamily: 'ORACLE',\n        modelDetails: {\n          modelName: metadata.modelName,\n          voiceId: voice,\n        },\n        speechSettings: {\n          outputFormat,\n        },\n      },\n    };\n\n    try {\n      const response = await client.synthesizeSpeech({\n        synthesizeSpeechDetails,\n      });\n\n      // Convert response stream to Uint8Array\n      const audioData = await this.streamToUint8Array(response.value);\n\n      return {\n        audio: audioData,\n        warnings,\n        request: {\n          body: synthesizeSpeechDetails,\n        },\n        response: {\n          timestamp: startTime,\n          modelId: this.modelId,\n          headers: response.opcRequestId ? { 'opc-request-id': response.opcRequestId } : {},\n        },\n        providerMetadata: {\n          oci: {\n            compartmentId,\n            voice,\n            format: (options.outputFormat ?? this._config.format) || 'mp3',\n            requestId: response.opcRequestId,\n          },\n        },\n      };\n    } catch (error) {\n      throw handleOCIError(error);\n    }\n  }\n\n  /**\n   * Map user-friendly format names to OCI OutputFormat enum\n   */\n  private mapOutputFormat(format?: string): models.TtsOracleSpeechSettings.OutputFormat {\n    switch (format) {\n      case 'wav':\n      case 'pcm':\n        return models.TtsOracleSpeechSettings.OutputFormat.Pcm;\n      case 'ogg':\n        return models.TtsOracleSpeechSettings.OutputFormat.Ogg;\n      case 'mp3':\n      default:\n        return models.TtsOracleSpeechSettings.OutputFormat.Mp3;\n    }\n  }\n\n  /**\n   * Convert a Web Streams API ReadableStream or Node.js stream to Uint8Array\n   */\n  private async streamToUint8Array(stream: any): Promise<Uint8Array> {\n    // Check if it's a Web Streams API ReadableStream\n    if (stream && typeof stream.getReader === 'function') {\n      return this.webStreamToUint8Array(stream);\n    }\n\n    // Otherwise, treat as Node.js stream\n    return this.nodeStreamToUint8Array(stream);\n  }\n\n  /**\n   * Convert Web Streams API ReadableStream to Uint8Array\n   */\n  private async webStreamToUint8Array(stream: ReadableStream): Promise<Uint8Array> {\n    const reader = stream.getReader();\n    const chunks: Uint8Array[] = [];\n\n    try {\n      while (true) {\n        const { done, value } = await reader.read();\n        if (done) break;\n        if (value) chunks.push(value);\n      }\n\n      // Calculate total length and combine chunks\n      const totalLength = chunks.reduce((acc, chunk) => acc + chunk.length, 0);\n      const result = new Uint8Array(totalLength);\n      let offset = 0;\n      for (const chunk of chunks) {\n        result.set(chunk, offset);\n        offset += chunk.length;\n      }\n      return result;\n    } finally {\n      reader.releaseLock();\n    }\n  }\n\n  /**\n   * Convert Node.js readable stream to Uint8Array\n   */\n  private async nodeStreamToUint8Array(stream: NodeJS.ReadableStream): Promise<Uint8Array> {\n    const chunks: Buffer[] = [];\n\n    return new Promise((resolve, reject) => {\n      stream.on('data', (chunk: Buffer) => {\n        chunks.push(chunk);\n      });\n\n      stream.on('end', () => {\n        const buffer = Buffer.concat(chunks);\n        resolve(new Uint8Array(buffer));\n      });\n\n      stream.on('error', (error: Error) => {\n        reject(error);\n      });\n    });\n  }\n}\n","export interface RerankingModelMetadata {\n  id: string;\n  name: string;\n  family: 'cohere';\n  maxDocuments: number;\n  maxQueryLength: number;\n  supportsMultilingual: boolean;\n}\n\nexport const RERANKING_MODELS: RerankingModelMetadata[] = [\n  {\n    id: 'cohere.rerank-v3.5',\n    name: 'Cohere Rerank v3.5',\n    family: 'cohere',\n    maxDocuments: 1000,\n    maxQueryLength: 2048,\n    supportsMultilingual: true,\n  },\n];\n\nexport function isValidRerankingModelId(modelId: string): boolean {\n  return RERANKING_MODELS.some((m) => m.id === modelId);\n}\n\nexport function getRerankingModelMetadata(modelId: string): RerankingModelMetadata | undefined {\n  return RERANKING_MODELS.find((m) => m.id === modelId);\n}\n\nexport function getAllRerankingModels(): RerankingModelMetadata[] {\n  return RERANKING_MODELS;\n}\n","import type {\n  RerankingModelV3,\n  RerankingModelV3CallOptions,\n  JSONObject,\n  SharedV3Warning,\n} from '@ai-sdk/provider';\nimport { InvalidArgumentError, NoSuchModelError } from '@ai-sdk/provider';\nimport { GenerativeAiInferenceClient } from 'oci-generativeaiinference';\nimport { Region } from 'oci-common';\nimport { createAuthProvider, getCompartmentId, getRegion } from '../auth';\nimport { getRerankingModelMetadata, isValidRerankingModelId } from './registry';\nimport type { OCIRerankingSettings, RequestOptions } from '../types';\nimport { handleOCIError } from '../shared/errors';\nimport { withRetry, withTimeout, isRetryableError } from '../shared/utils';\nimport {\n  getOCIProviderOptions,\n  resolveCompartmentId,\n  resolveEndpoint,\n  resolveServingMode,\n} from '../shared/provider-options';\nimport { resolveRequestOptions } from '../shared/request-options';\n\nexport class OCIRerankingModel implements RerankingModelV3 {\n  readonly specificationVersion = 'v3';\n  readonly provider = 'oci-genai';\n\n  private _client?: GenerativeAiInferenceClient;\n\n  constructor(\n    readonly modelId: string,\n    private config: OCIRerankingSettings\n  ) {\n    if (!isValidRerankingModelId(modelId)) {\n      throw new NoSuchModelError({\n        modelId,\n        modelType: 'rerankingModel',\n      });\n    }\n  }\n\n  private async getClient(endpointOverride?: string): Promise<GenerativeAiInferenceClient> {\n    const resolvedEndpoint = resolveEndpoint(this.config.endpoint, endpointOverride);\n\n    if (!this._client || (endpointOverride && endpointOverride !== this.config.endpoint)) {\n      const authProvider = await createAuthProvider(this.config);\n      const regionId = getRegion(this.config);\n\n      const client = new GenerativeAiInferenceClient({\n        authenticationDetailsProvider: authProvider,\n      });\n\n      // Set region using proper OCI Region API\n      client.region = Region.fromRegionId(regionId);\n\n      if (resolvedEndpoint) {\n        client.endpoint = resolvedEndpoint;\n      }\n\n      if (!endpointOverride || endpointOverride === this.config.endpoint) {\n        this._client = client;\n      }\n\n      return client;\n    }\n\n    return this._client;\n  }\n\n  private getRequestOptions(perRequestOptions?: RequestOptions): Required<RequestOptions> {\n    return resolveRequestOptions(this.config.requestOptions, perRequestOptions);\n  }\n\n  private async executeWithResilience<T>(\n    operation: () => Promise<T>,\n    operationName: string,\n    requestOptions?: RequestOptions\n  ): Promise<T> {\n    const options = this.getRequestOptions(requestOptions);\n\n    const withTimeoutOperation = (): Promise<T> =>\n      withTimeout(operation(), options.timeoutMs, operationName);\n\n    if (options.retry.enabled) {\n      return withRetry(withTimeoutOperation, {\n        maxRetries: options.retry.maxRetries,\n        baseDelayMs: options.retry.baseDelayMs,\n        maxDelayMs: options.retry.maxDelayMs,\n        isRetryable: isRetryableError,\n      });\n    }\n\n    return withTimeoutOperation();\n  }\n\n  async doRerank(options: RerankingModelV3CallOptions): Promise<{\n    ranking: Array<{\n      index: number;\n      relevanceScore: number;\n    }>;\n    providerMetadata?: Record<string, JSONObject>;\n    warnings?: SharedV3Warning[];\n    response?: {\n      id?: string;\n      timestamp?: Date;\n      modelId?: string;\n      headers?: Record<string, string>;\n      body?: unknown;\n    };\n  }> {\n    const { query, documents, topN } = options;\n\n    if (documents.type !== 'text') {\n      throw new InvalidArgumentError({\n        argument: 'documents',\n        message: `OCI reranking only supports text documents, got: ${documents.type}`,\n      });\n    }\n\n    const documentTexts = documents.values;\n    const metadata = getRerankingModelMetadata(this.modelId);\n\n    if (metadata && documentTexts.length > metadata.maxDocuments) {\n      throw new Error(\n        `Document count (${documentTexts.length}) exceeds maximum allowed (${metadata.maxDocuments})`\n      );\n    }\n\n    const ociOptions = getOCIProviderOptions(options.providerOptions);\n    const client = await this.getClient(ociOptions?.endpoint);\n    const compartmentId = resolveCompartmentId(\n      getCompartmentId(this.config),\n      ociOptions?.compartmentId\n    );\n    const warnings: SharedV3Warning[] = [];\n\n    try {\n      const response = await this.executeWithResilience<any>(\n        () =>\n          (client as any).rerankText({\n            rerankTextDetails: {\n              servingMode: resolveServingMode(\n                this.modelId,\n                this.config.servingMode,\n                ociOptions?.servingMode\n              ),\n              compartmentId,\n              input: query,\n              documents: documentTexts,\n              topN: topN ?? this.config.topN,\n              isEcho: this.config.returnDocuments ?? false,\n            },\n          }),\n        'OCI rerank request',\n        ociOptions?.requestOptions\n      );\n\n      const ranking = response.rerankTextResult.documentRanks.map(\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        (rank: any) => ({\n          index: rank.index ?? 0,\n          relevanceScore: rank.relevanceScore ?? 0,\n        })\n      );\n\n      return {\n        ranking,\n        warnings,\n        providerMetadata: {\n          oci: {\n            requestId: response.opcRequestId,\n            modelId: response.rerankTextResult.modelId ?? this.modelId,\n          },\n        },\n        response: {\n          id: response.rerankTextResult.id,\n          modelId: response.rerankTextResult.modelId,\n          headers: response.opcRequestId ? { 'opc-request-id': response.opcRequestId } : undefined,\n          body: response,\n        },\n      };\n    } catch (error) {\n      throw handleOCIError(error);\n    }\n  }\n}\n","export interface TranscriptionModelMetadata {\n  id: string;\n  name: string;\n  family: 'oci-speech';\n  modelType: 'ORACLE' | 'WHISPER_MEDIUM' | 'WHISPER_LARGE_V2';\n  maxLanguages: number;\n  supportsCustomVocabulary: boolean;\n  supportedFormats: string[];\n  maxFileSizeMB: number;\n}\n\nexport const TRANSCRIPTION_MODELS: TranscriptionModelMetadata[] = [\n  {\n    id: 'ORACLE',\n    name: 'OCI Speech Oracle',\n    family: 'oci-speech',\n    modelType: 'ORACLE',\n    maxLanguages: 10,\n    supportsCustomVocabulary: true,\n    supportedFormats: ['wav', 'mp3', 'flac', 'ogg'],\n    maxFileSizeMB: 2048,\n  },\n  {\n    id: 'WHISPER_MEDIUM',\n    name: 'OCI Speech Whisper Medium',\n    family: 'oci-speech',\n    modelType: 'WHISPER_MEDIUM',\n    maxLanguages: 50,\n    supportsCustomVocabulary: false,\n    supportedFormats: ['wav', 'mp3', 'flac', 'ogg', 'm4a', 'webm'],\n    maxFileSizeMB: 2048,\n  },\n  {\n    id: 'WHISPER_LARGE_V2',\n    name: 'OCI Speech Whisper Large V2',\n    family: 'oci-speech',\n    modelType: 'WHISPER_LARGE_V2',\n    maxLanguages: 50,\n    supportsCustomVocabulary: false,\n    supportedFormats: ['wav', 'mp3', 'flac', 'ogg', 'm4a', 'webm'],\n    maxFileSizeMB: 2048,\n  },\n];\n\n/**\n * Supported languages for OCI Speech Oracle model (locale-specific)\n */\nexport const ORACLE_LANGUAGES = [\n  'en-US', // English (US)\n  'es-ES', // Spanish (Spain)\n  'pt-BR', // Portuguese (Brazil)\n  'en-GB', // English (UK)\n  'en-AU', // English (Australia)\n  'en-IN', // English (India)\n  'hi-IN', // Hindi\n  'fr-FR', // French\n  'de-DE', // German\n  'it-IT', // Italian\n] as const;\n\n/**\n * Supported languages for Whisper models (locale-agnostic)\n * Whisper supports 50+ languages; these are the most common.\n */\nexport const WHISPER_LANGUAGES = [\n  'en', // English\n  'es', // Spanish\n  'pt', // Portuguese\n  'fr', // French\n  'de', // German\n  'it', // Italian\n  'ja', // Japanese\n  'ko', // Korean\n  'zh', // Chinese\n  'nl', // Dutch\n  'pl', // Polish\n  'ru', // Russian\n  'tr', // Turkish\n  'hi', // Hindi\n  'ar', // Arabic\n] as const;\n\nexport type OracleLanguage = (typeof ORACLE_LANGUAGES)[number];\nexport type WhisperLanguage = (typeof WHISPER_LANGUAGES)[number];\n\nexport function isValidTranscriptionModelId(modelId: string): boolean {\n  return TRANSCRIPTION_MODELS.some((m) => m.id === modelId);\n}\n\nexport function getTranscriptionModelMetadata(\n  modelId: string\n): TranscriptionModelMetadata | undefined {\n  return TRANSCRIPTION_MODELS.find((m) => m.id === modelId);\n}\n\nexport function getAllTranscriptionModels(): TranscriptionModelMetadata[] {\n  return TRANSCRIPTION_MODELS;\n}\n\nexport function getOracleLanguages(): readonly string[] {\n  return ORACLE_LANGUAGES;\n}\n\nexport function getWhisperLanguages(): readonly string[] {\n  return WHISPER_LANGUAGES;\n}\n\nexport function getSupportedLanguages(): readonly string[] {\n  return [...ORACLE_LANGUAGES, ...WHISPER_LANGUAGES];\n}\n\nexport type SupportedLanguage = OracleLanguage | WhisperLanguage;\n","/* eslint-disable @typescript-eslint/no-unsafe-assignment, @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-explicit-any */\nimport { ObjectStorageClient } from 'oci-objectstorage';\nimport { Region } from 'oci-common';\nimport type { OCIConfig } from '../../types';\nimport { createAuthProvider, getRegion } from '../../auth';\n\n/**\n * Upload audio data to OCI Object Storage for transcription processing.\n * OCI Speech service requires audio files to be in Object Storage.\n *\n * @param config - OCI configuration with auth details\n * @param bucketName - Target bucket name\n * @param objectName - Object name/path in the bucket\n * @param audioData - Audio bytes to upload\n * @returns Object Storage URI for the uploaded file\n */\nexport async function uploadAudioToObjectStorage(\n  config: OCIConfig,\n  bucketName: string,\n  objectName: string,\n  audioData: Uint8Array,\n  contentType?: string\n): Promise<{ namespaceName: string; bucketName: string; objectName: string }> {\n  const authProvider = await createAuthProvider(config);\n  const region = getRegion(config);\n\n  const client = new ObjectStorageClient({\n    authenticationDetailsProvider: authProvider,\n  });\n  client.region = Region.fromRegionId(region);\n\n  // Get namespace for the tenancy\n  const namespaceResponse = await client.getNamespace({});\n  const namespaceName = namespaceResponse.value;\n\n  // Upload the audio file\n  await client.putObject({\n    namespaceName,\n    bucketName,\n    objectName,\n    putObjectBody: audioData,\n    contentLength: audioData.byteLength,\n    contentType: contentType ?? 'audio/wav',\n  });\n\n  return { namespaceName, bucketName, objectName };\n}\n\n/**\n * Delete an object from OCI Object Storage.\n * Used for cleanup after transcription completes.\n *\n * @param config - OCI configuration with auth details\n * @param namespaceName - Object Storage namespace\n * @param bucketName - Bucket name\n * @param objectName - Object name to delete\n */\nexport async function deleteFromObjectStorage(\n  config: OCIConfig,\n  namespaceName: string,\n  bucketName: string,\n  objectName: string\n): Promise<void> {\n  const authProvider = await createAuthProvider(config);\n  const region = getRegion(config);\n\n  const client = new ObjectStorageClient({\n    authenticationDetailsProvider: authProvider,\n  });\n  client.region = Region.fromRegionId(region);\n\n  await client.deleteObject({\n    namespaceName,\n    bucketName,\n    objectName,\n  });\n}\n\n/**\n * Generate a unique object name for audio uploads.\n * Format: audio-{timestamp}-{random}.wav\n */\nexport function generateAudioObjectName(): string {\n  const timestamp = Date.now();\n  const random = Math.random().toString(36).substring(2, 8);\n  return `audio-${timestamp}-${random}.wav`;\n}\n\n/**\n * Token object from OCI Speech transcription result.\n */\ninterface TranscriptionToken {\n  token: string;\n  startTime: number;\n  endTime: number;\n  confidence?: number;\n}\n\n/**\n * Segment representing a group of consecutive tokens.\n */\ninterface TranscriptionSegment {\n  text: string;\n  startSecond: number;\n  endSecond: number;\n}\n\n/**\n * Transcription result returned from downloadTranscriptionResult.\n */\nexport interface TranscriptionResult {\n  text: string;\n  segments: TranscriptionSegment[];\n  confidence?: number;\n  languageCode?: string;\n}\n\n/**\n * Group tokens into segments based on time gaps.\n * Tokens separated by > 1 second are put in separate segments.\n *\n * @param tokens - Array of token objects with timing information\n * @returns Array of segments with text and timing\n */\nfunction groupTokensIntoSegments(tokens: TranscriptionToken[]): TranscriptionSegment[] {\n  if (!tokens || tokens.length === 0) {\n    return [];\n  }\n\n  const segments: TranscriptionSegment[] = [];\n  let currentSegment: TranscriptionToken[] = [tokens[0]];\n\n  for (let i = 1; i < tokens.length; i++) {\n    const prevToken = tokens[i - 1];\n    const currentToken = tokens[i];\n\n    // Check if there's a gap > 1 second between tokens\n    const gap = currentToken.startTime - prevToken.endTime;\n\n    if (gap > 1.0) {\n      // Gap exceeds threshold, finish current segment and start new one\n      segments.push({\n        text: currentSegment.map((t) => t.token).join(' '),\n        startSecond: currentSegment[0].startTime,\n        endSecond: currentSegment[currentSegment.length - 1].endTime,\n      });\n      currentSegment = [currentToken];\n    } else {\n      // Gap is within threshold, add to current segment\n      currentSegment.push(currentToken);\n    }\n  }\n\n  // Add the last segment\n  if (currentSegment.length > 0) {\n    segments.push({\n      text: currentSegment.map((t) => t.token).join(' '),\n      startSecond: currentSegment[0].startTime,\n      endSecond: currentSegment[currentSegment.length - 1].endTime,\n    });\n  }\n\n  return segments;\n}\n\n/**\n * Download transcription result from OCI Object Storage.\n * Parses OCI Speech JSON format and converts tokens to segments.\n *\n * @param config - OCI configuration with auth details\n * @param namespaceName - Object Storage namespace\n * @param bucketName - Bucket name\n * @param objectName - Object name (JSON transcription result file)\n * @returns Structured transcription result with text, segments, and metadata\n */\nexport async function downloadTranscriptionResult(\n  config: OCIConfig,\n  namespaceName: string,\n  bucketName: string,\n  objectName: string\n): Promise<TranscriptionResult> {\n  const authProvider = await createAuthProvider(config);\n  const region = getRegion(config);\n\n  const client = new ObjectStorageClient({\n    authenticationDetailsProvider: authProvider,\n  });\n  client.region = Region.fromRegionId(region);\n\n  try {\n    // Download the object\n    const response = await client.getObject({\n      namespaceName,\n      bucketName,\n      objectName,\n    });\n\n    // Stream response to string to handle large files efficiently\n    const responseStream = response.value as NodeJS.ReadableStream;\n    const chunks: Buffer[] = [];\n\n    // Collect stream data\n    await new Promise<void>((resolve, reject) => {\n      responseStream.on('data', (chunk: Buffer) => {\n        chunks.push(chunk);\n      });\n\n      responseStream.on('end', () => {\n        resolve();\n      });\n\n      responseStream.on('error', (error: Error) => {\n        reject(new Error(`Stream read error: ${error.message}`));\n      });\n    });\n\n    // Parse the JSON content\n    const jsonString = Buffer.concat(chunks).toString('utf-8');\n    let speechResult: any;\n\n    try {\n      speechResult = JSON.parse(jsonString);\n    } catch (parseError) {\n      throw new Error(\n        `Failed to parse transcription JSON: ${parseError instanceof Error ? parseError.message : String(parseError)}`\n      );\n    }\n\n    // Extract transcription data from OCI Speech response\n    const transcription = speechResult.transcription;\n    if (!transcription) {\n      throw new Error('Missing transcription field in JSON response');\n    }\n\n    // Extract the main transcript text\n    const text = transcription.transcript || '';\n\n    // Extract tokens if available\n    const tokens: TranscriptionToken[] = [];\n    if (transcription.tokens && Array.isArray(transcription.tokens)) {\n      for (const token of transcription.tokens) {\n        if (\n          token.token &&\n          typeof token.startTime === 'number' &&\n          typeof token.endTime === 'number'\n        ) {\n          tokens.push({\n            token: token.token,\n            startTime: token.startTime,\n            endTime: token.endTime,\n            confidence: token.confidence,\n          });\n        }\n      }\n    }\n\n    // Group tokens into segments\n    const segments = groupTokensIntoSegments(tokens);\n\n    // Extract optional metadata\n    const confidence = transcription.confidence;\n    const languageCode = transcription.languageCode;\n\n    return {\n      text,\n      segments,\n      confidence,\n      languageCode,\n    };\n  } catch (error) {\n    if (error instanceof Error && error.message.includes('Missing transcription field')) {\n      throw error;\n    }\n    if (error instanceof Error && error.message.includes('Failed to parse')) {\n      throw error;\n    }\n    if (error instanceof Error && error.message.includes('Stream read error')) {\n      throw error;\n    }\n    throw new Error(\n      `Failed to download transcription result: ${error instanceof Error ? error.message : String(error)}`\n    );\n  }\n}\n","import { AIServiceSpeechClient, models } from 'oci-aispeech';\nimport { Region } from 'oci-common';\nimport { createAuthProvider, getCompartmentId, getRegion } from '../auth';\nimport { NoSuchModelError } from '@ai-sdk/provider';\nimport { getTranscriptionModelMetadata, isValidTranscriptionModelId } from './registry';\nimport {\n  uploadAudioToObjectStorage,\n  deleteFromObjectStorage,\n  generateAudioObjectName,\n  downloadTranscriptionResult,\n} from '../shared/storage/object-storage';\nimport type { OCITranscriptionSettings } from '../types';\nimport type {\n  SharedV3Warning,\n  JSONObject,\n  TranscriptionModelV3,\n  TranscriptionModelV3CallOptions,\n} from '@ai-sdk/provider';\nimport { handleOCIError } from '../shared/errors';\nimport {\n  getOCIProviderOptions,\n  resolveCompartmentId,\n  resolveEndpoint,\n} from '../shared/provider-options';\n\ninterface TranscriptionOutput {\n  text: string;\n  segments: Array<{\n    text: string;\n    startSecond: number;\n    endSecond: number;\n  }>;\n  language: string | undefined;\n  durationInSeconds: number | undefined;\n  warnings: SharedV3Warning[];\n  request?: {\n    body?: string;\n  };\n  response: {\n    timestamp: Date;\n    modelId: string;\n    headers?: Record<string, string>;\n  };\n  providerMetadata?: Record<string, JSONObject>;\n}\n\nexport class OCITranscriptionModel implements TranscriptionModelV3 {\n  readonly specificationVersion = 'v3';\n  readonly provider = 'oci-genai';\n\n  private _client?: AIServiceSpeechClient;\n\n  constructor(\n    readonly modelId: string,\n    private config: OCITranscriptionSettings\n  ) {\n    if (isValidTranscriptionModelId(modelId) === false) {\n      throw new NoSuchModelError({\n        modelId,\n        modelType: 'transcriptionModel',\n      });\n    }\n  }\n\n  private async getClient(endpointOverride?: string): Promise<AIServiceSpeechClient> {\n    const resolvedEndpoint = resolveEndpoint(this.config.endpoint, endpointOverride);\n\n    if (!this._client || (endpointOverride && endpointOverride !== this.config.endpoint)) {\n      const authProvider = await createAuthProvider(this.config);\n      const region = getRegion(this.config);\n\n      const client = new AIServiceSpeechClient({\n        authenticationDetailsProvider: authProvider,\n      });\n\n      client.region = Region.fromRegionId(region);\n\n      if (resolvedEndpoint) {\n        client.endpoint = resolvedEndpoint;\n      }\n\n      if (!endpointOverride || endpointOverride === this.config.endpoint) {\n        this._client = client;\n      }\n\n      return client;\n    }\n\n    return this._client;\n  }\n\n  async doGenerate(options: TranscriptionModelV3CallOptions): Promise<TranscriptionOutput> {\n    return this.doTranscribe(options);\n  }\n\n  async doTranscribe(options: TranscriptionModelV3CallOptions): Promise<TranscriptionOutput> {\n    const startTime = new Date();\n    const warnings: SharedV3Warning[] = [];\n\n    // Convert audio to Uint8Array if it's a base64 string\n    let audioData: Uint8Array;\n    if (typeof options.audio === 'string') {\n      audioData = new Uint8Array(Buffer.from(options.audio, 'base64'));\n    } else {\n      audioData = options.audio;\n    }\n\n    // Validate audio size (2GB max)\n    const maxSizeBytes = 2 * 1024 * 1024 * 1024;\n    if (audioData.byteLength > maxSizeBytes) {\n      throw new Error(\n        `Audio file size (${(audioData.byteLength / 1024 / 1024).toFixed(1)}MB) ` +\n          `exceeds maximum allowed (2048MB)`\n      );\n    }\n\n    const ociOptions = getOCIProviderOptions(options.providerOptions);\n    const client = await this.getClient(ociOptions?.endpoint);\n    const compartmentId = resolveCompartmentId(\n      getCompartmentId(this.config),\n      ociOptions?.compartmentId\n    );\n    const metadata = getTranscriptionModelMetadata(this.modelId);\n\n    // Collect warning if vocabulary used with Whisper\n    if (\n      metadata?.modelType !== 'ORACLE' &&\n      this.config.vocabulary &&\n      this.config.vocabulary.length > 0\n    ) {\n      warnings.push({\n        type: 'other',\n        message: 'Custom vocabulary is not supported by Whisper model. It will be ignored.',\n      });\n    }\n\n    // Get bucket name for audio uploads\n    const bucketName = this.config.transcriptionBucket || 'oci-speech-transcription';\n    const objectName = generateAudioObjectName();\n\n    // Upload audio to Object Storage\n    let uploadedLocation: { namespaceName: string; bucketName: string; objectName: string };\n    try {\n      uploadedLocation = await uploadAudioToObjectStorage(\n        this.config,\n        bucketName,\n        objectName,\n        audioData,\n        options.mediaType\n      );\n    } catch (error) {\n      const message = error instanceof Error ? error.message : 'Unknown error';\n      throw new Error(`Failed to upload audio to Object Storage: ${message}`);\n    }\n\n    try {\n      // Map language code to enum\n      const languageCode = this.mapLanguageCode(this.config.language);\n\n      // Create transcription job with inline input location\n      const createJobRequest = {\n        createTranscriptionJobDetails: {\n          compartmentId,\n          displayName: `Transcription-${Date.now()}`,\n          modelDetails: {\n            modelType: metadata?.modelType || 'ORACLE',\n            languageCode,\n          },\n          inputLocation: {\n            locationType: 'OBJECT_LIST_INLINE_INPUT_LOCATION',\n            objectLocations: [\n              {\n                namespaceName: uploadedLocation.namespaceName,\n                bucketName: uploadedLocation.bucketName,\n                objectNames: [uploadedLocation.objectName],\n              },\n            ],\n          },\n          outputLocation: {\n            namespaceName: uploadedLocation.namespaceName,\n            bucketName: bucketName,\n            prefix: `results-${Date.now()}`,\n          },\n        },\n      };\n\n      const jobResponse = await client.createTranscriptionJob(createJobRequest);\n      const jobId = jobResponse.transcriptionJob.id;\n\n      // Poll for job completion and get transcript\n      const { text, taskId, segments } = await this.pollForCompletion(\n        client,\n        jobId,\n        bucketName,\n        uploadedLocation.namespaceName,\n        `results-${Date.now()}`\n      );\n\n      return {\n        text,\n        segments,\n        language: this.config.language || undefined,\n        durationInSeconds: undefined,\n        warnings,\n        request: {\n          body: JSON.stringify({ audioSize: audioData.byteLength, mediaType: options.mediaType }),\n        },\n        response: {\n          timestamp: startTime,\n          modelId: this.modelId,\n          headers: jobResponse.opcRequestId ? { 'opc-request-id': jobResponse.opcRequestId } : {},\n        },\n        providerMetadata: {\n          oci: {\n            compartmentId,\n            modelType: metadata?.modelType || 'ORACLE',\n            jobId,\n            taskId,\n            requestId: jobResponse.opcRequestId,\n          },\n        },\n      };\n    } catch (error) {\n      throw handleOCIError(error);\n    } finally {\n      // Cleanup: delete uploaded audio file\n      try {\n        await deleteFromObjectStorage(\n          this.config,\n          uploadedLocation.namespaceName,\n          uploadedLocation.bucketName,\n          uploadedLocation.objectName\n        );\n      } catch {\n        // Silently ignore cleanup errors\n      }\n    }\n  }\n\n  /**\n   * Map language string to OCI LanguageCode enum\n   */\n  private mapLanguageCode(\n    language?: string\n  ): models.TranscriptionModelDetails.LanguageCode | undefined {\n    if (!language) return models.TranscriptionModelDetails.LanguageCode.EnUs;\n\n    // Map common language codes to OCI enum values\n    const mapping: Record<string, models.TranscriptionModelDetails.LanguageCode> = {\n      'en-US': models.TranscriptionModelDetails.LanguageCode.EnUs,\n      'es-ES': models.TranscriptionModelDetails.LanguageCode.EsEs,\n      'pt-BR': models.TranscriptionModelDetails.LanguageCode.PtBr,\n      'en-GB': models.TranscriptionModelDetails.LanguageCode.EnGb,\n      'en-AU': models.TranscriptionModelDetails.LanguageCode.EnAu,\n      'en-IN': models.TranscriptionModelDetails.LanguageCode.EnIn,\n      'hi-IN': models.TranscriptionModelDetails.LanguageCode.HiIn,\n      'fr-FR': models.TranscriptionModelDetails.LanguageCode.FrFr,\n      'de-DE': models.TranscriptionModelDetails.LanguageCode.DeDe,\n      'it-IT': models.TranscriptionModelDetails.LanguageCode.ItIt,\n      en: models.TranscriptionModelDetails.LanguageCode.En,\n      es: models.TranscriptionModelDetails.LanguageCode.Es,\n      fr: models.TranscriptionModelDetails.LanguageCode.Fr,\n      de: models.TranscriptionModelDetails.LanguageCode.De,\n      it: models.TranscriptionModelDetails.LanguageCode.It,\n      auto: models.TranscriptionModelDetails.LanguageCode.Auto,\n    };\n\n    return mapping[language] || models.TranscriptionModelDetails.LanguageCode.EnUs;\n  }\n\n  private async pollForCompletion(\n    client: AIServiceSpeechClient,\n    jobId: string,\n    outputBucket: string,\n    outputNamespace: string,\n    outputPrefix: string\n  ): Promise<{\n    text: string;\n    taskId: string;\n    segments: Array<{ text: string; startSecond: number; endSecond: number }>;\n  }> {\n    const maxAttempts = 60;\n    const pollIntervalMs = 5000;\n\n    for (let attempt = 0; attempt < maxAttempts; attempt++) {\n      const jobResponse = await client.getTranscriptionJob({\n        transcriptionJobId: jobId,\n      });\n\n      const state = jobResponse.transcriptionJob.lifecycleState;\n\n      if (state === models.TranscriptionJob.LifecycleState.Succeeded) {\n        // List tasks to get the task ID\n        const tasksResponse = await client.listTranscriptionTasks({\n          transcriptionJobId: jobId,\n        });\n\n        const firstTask = tasksResponse.transcriptionTaskCollection?.items?.[0];\n        if (!firstTask) {\n          throw new Error('No transcription tasks found in job');\n        }\n\n        // Get full task details to retrieve output file location\n        let taskDetails;\n        try {\n          const taskResponse = await client.getTranscriptionTask({\n            transcriptionJobId: jobId,\n            transcriptionTaskId: firstTask.id,\n          });\n          taskDetails = taskResponse.transcriptionTask;\n        } catch (error) {\n          throw new Error(\n            `Failed to get transcription task details: ${error instanceof Error ? error.message : 'Unknown error'}`\n          );\n        }\n\n        // Determine the output file name\n        let outputFileName: string;\n\n        // If task has outputLocation, use it; otherwise use fallback naming\n        const taskOutputLocation = (taskDetails as { outputLocation?: string }).outputLocation;\n        if (taskOutputLocation) {\n          // outputLocation is typically a string containing the full path\n          // Format is usually \"{prefix}/{input_filename}.json\"\n          outputFileName = taskOutputLocation;\n        } else {\n          // Fallback: construct filename from prefix and task input\n          // Get the input object names from the input location\n          const inputObjectNames =\n            (taskDetails.inputLocation as { objectNames?: string[] })?.objectNames || [];\n          const inputName = inputObjectNames[0] || `task-${firstTask.id}`;\n          const baseName = inputName.replace(/\\.[^.]*$/, ''); // Remove extension\n          outputFileName = `${outputPrefix}/${baseName}.json`;\n        }\n\n        // Download and parse the transcription result from Object Storage\n        let result;\n        try {\n          result = await downloadTranscriptionResult(\n            this.config,\n            outputNamespace,\n            outputBucket,\n            outputFileName\n          );\n        } catch (error) {\n          throw new Error(\n            `Failed to download transcription result: ${error instanceof Error ? error.message : 'Unknown error'}`\n          );\n        }\n\n        return {\n          text: result.text,\n          taskId: firstTask.id,\n          segments: result.segments,\n        };\n      }\n\n      if (state === models.TranscriptionJob.LifecycleState.Failed) {\n        throw new Error(\n          `Transcription job failed: ${jobResponse.transcriptionJob.lifecycleDetails || 'Unknown error'}`\n        );\n      }\n\n      await new Promise((resolve) => setTimeout(resolve, pollIntervalMs));\n    }\n\n    throw new Error('Transcription job timed out after 5 minutes');\n  }\n}\n","/**\n * Cross-Platform WebSocket Adapter\n *\n * Provides a unified WebSocket interface that works in both Node.js and browser\n * environments. Uses the native WebSocket API which is available in:\n * - All modern browsers\n * - Node.js 18+ (global WebSocket)\n * - Deno, Bun, and other modern runtimes\n */\n\n/**\n * WebSocket ready state constants.\n * Matches the native WebSocket.readyState values.\n */\nexport const WebSocketReadyState = {\n  CONNECTING: 0,\n  OPEN: 1,\n  CLOSING: 2,\n  CLOSED: 3,\n} as const;\n\nexport type WebSocketReadyState = (typeof WebSocketReadyState)[keyof typeof WebSocketReadyState];\n\n/**\n * Events emitted by the WebSocket adapter.\n */\nexport interface WebSocketAdapterEvents {\n  open: () => void;\n  message: (data: string | ArrayBuffer) => void;\n  close: (code: number, reason: string) => void;\n  error: (error: Error) => void;\n}\n\n/**\n * Options for creating a WebSocket connection.\n */\nexport interface WebSocketAdapterOptions {\n  /** Connection timeout in milliseconds */\n  connectionTimeoutMs?: number;\n  /** Custom headers for the WebSocket handshake (Node.js only) */\n  headers?: Record<string, string>;\n}\n\n/**\n * Type guard to check if we're in a Node.js environment with 'ws' package.\n * This handles the case where native WebSocket isn't available.\n */\nfunction isNodeWithoutNativeWS(): boolean {\n  return (\n    typeof process !== 'undefined' &&\n    process.versions?.node !== undefined &&\n    typeof globalThis.WebSocket === 'undefined'\n  );\n}\n\n/**\n * Cross-platform WebSocket adapter.\n *\n * This adapter provides a consistent interface regardless of the environment:\n * - In browsers: Uses native WebSocket\n * - In Node.js 18+: Uses native global WebSocket\n * - In older Node.js: Falls back to 'ws' package if available\n *\n * @example\n * ```typescript\n * const ws = new WebSocketAdapter('wss://example.com/ws');\n *\n * ws.on('open', () => console.log('Connected!'));\n * ws.on('message', (data) => console.log('Received:', data));\n * ws.on('error', (err) => console.error('Error:', err));\n * ws.on('close', (code, reason) => console.log('Closed:', code, reason));\n *\n * // Send text\n * ws.send('Hello, server!');\n *\n * // Send binary\n * ws.send(new Uint8Array([1, 2, 3]));\n *\n * // Close connection\n * ws.close();\n * ```\n */\nexport class WebSocketAdapter {\n  private ws: WebSocket | null = null;\n  private listeners: Map<string, Set<(...args: unknown[]) => void>> = new Map();\n  private connectionTimeout: ReturnType<typeof setTimeout> | null = null;\n  private _readyState: WebSocketReadyState = WebSocketReadyState.CONNECTING;\n\n  /**\n   * Create a new WebSocket connection.\n   *\n   * @param url - Secure WebSocket URL (wss://)\n   * @param options - Connection options\n   * @throws Error if WebSocket is not available in the environment\n   */\n  constructor(\n    private readonly url: string,\n    private readonly options: WebSocketAdapterOptions = {}\n  ) {\n    this.connect();\n  }\n\n  /**\n   * Get the current connection state.\n   */\n  get readyState(): WebSocketReadyState {\n    return this.ws?.readyState ?? this._readyState;\n  }\n\n  /**\n   * Check if the connection is open and ready to send data.\n   */\n  get isOpen(): boolean {\n    return this.readyState === WebSocketReadyState.OPEN;\n  }\n\n  /**\n   * Check if the connection is in the process of connecting.\n   */\n  get isConnecting(): boolean {\n    return this.readyState === WebSocketReadyState.CONNECTING;\n  }\n\n  /**\n   * Check if the connection is closed or closing.\n   */\n  get isClosed(): boolean {\n    return (\n      this.readyState === WebSocketReadyState.CLOSED ||\n      this.readyState === WebSocketReadyState.CLOSING\n    );\n  }\n\n  /**\n   * Register an event listener.\n   *\n   * @param event - Event name ('open', 'message', 'close', 'error')\n   * @param callback - Callback function\n   */\n  on<K extends keyof WebSocketAdapterEvents>(event: K, callback: WebSocketAdapterEvents[K]): void {\n    if (!this.listeners.has(event)) {\n      this.listeners.set(event, new Set());\n    }\n    this.listeners.get(event)!.add(callback as (...args: unknown[]) => void);\n  }\n\n  /**\n   * Remove an event listener.\n   *\n   * @param event - Event name\n   * @param callback - Callback function to remove\n   */\n  off<K extends keyof WebSocketAdapterEvents>(event: K, callback: WebSocketAdapterEvents[K]): void {\n    this.listeners.get(event)?.delete(callback as (...args: unknown[]) => void);\n  }\n\n  /**\n   * Send data through the WebSocket.\n   *\n   * @param data - String, ArrayBuffer, or Uint8Array to send\n   * @throws Error if connection is not open\n   */\n  send(data: string | ArrayBuffer | Uint8Array): void {\n    if (!this.ws || this.ws.readyState !== WebSocketReadyState.OPEN) {\n      throw new Error('WebSocket is not connected');\n    }\n\n    // Convert Uint8Array to ArrayBuffer for consistent handling\n    if (data instanceof Uint8Array) {\n      this.ws.send(data.buffer.slice(data.byteOffset, data.byteOffset + data.byteLength));\n    } else {\n      this.ws.send(data);\n    }\n  }\n\n  /**\n   * Close the WebSocket connection.\n   *\n   * @param code - Status code (default: 1000 = normal closure)\n   * @param reason - Human-readable reason for closing\n   */\n  close(code = 1000, reason = 'Normal closure'): void {\n    this.clearConnectionTimeout();\n\n    if (this.ws) {\n      this._readyState = WebSocketReadyState.CLOSING;\n      try {\n        this.ws.close(code, reason);\n      } catch {\n        // Ignore close errors\n      }\n      this.ws = null;\n    }\n\n    this._readyState = WebSocketReadyState.CLOSED;\n  }\n\n  /**\n   * Establish the WebSocket connection.\n   */\n  private async connect(): Promise<void> {\n    this._readyState = WebSocketReadyState.CONNECTING;\n\n    // Set up connection timeout\n    const timeoutMs = this.options.connectionTimeoutMs ?? 30000;\n    this.connectionTimeout = setTimeout(() => {\n      this.emit('error', new Error(`Connection timeout after ${timeoutMs}ms`));\n      this.close(1006, 'Connection timeout');\n    }, timeoutMs);\n\n    try {\n      // Create WebSocket - use native or polyfill\n      this.ws = await this.createWebSocket();\n\n      // Handle binary data as ArrayBuffer\n      this.ws.binaryType = 'arraybuffer';\n\n      // Set up event handlers\n      this.ws.onopen = () => {\n        this.clearConnectionTimeout();\n        this._readyState = WebSocketReadyState.OPEN;\n        this.emit('open');\n      };\n\n      this.ws.onmessage = (event: MessageEvent) => {\n        this.emit('message', event.data);\n      };\n\n      this.ws.onclose = (event: CloseEvent) => {\n        this.clearConnectionTimeout();\n        this._readyState = WebSocketReadyState.CLOSED;\n        this.emit('close', event.code, event.reason || '');\n      };\n\n      this.ws.onerror = (_event: Event) => {\n        // WebSocket errors don't provide details for security reasons\n        // The actual error info comes through the close event\n        this.emit('error', new Error('WebSocket error'));\n      };\n    } catch (error) {\n      this.clearConnectionTimeout();\n      this._readyState = WebSocketReadyState.CLOSED;\n      this.emit('error', error instanceof Error ? error : new Error(String(error)));\n    }\n  }\n\n  /**\n   * Create the appropriate WebSocket instance for the current environment.\n   */\n  private async createWebSocket(): Promise<WebSocket> {\n    // Check if native WebSocket is available (browsers, Node.js 18+, Deno, Bun)\n    if (typeof globalThis.WebSocket !== 'undefined') {\n      return new globalThis.WebSocket(this.url);\n    }\n\n    // For older Node.js environments, try to use 'ws' package\n    if (isNodeWithoutNativeWS()) {\n      try {\n        // Dynamic import to avoid bundling issues\n        const { default: WS } = await import('ws');\n        return new WS(this.url, {\n          headers: this.options.headers,\n        }) as unknown as WebSocket;\n      } catch {\n        throw new Error(\n          'WebSocket not available. Please use Node.js 18+ or install the \"ws\" package.'\n        );\n      }\n    }\n\n    throw new Error('WebSocket not available in this environment');\n  }\n\n  /**\n   * Emit an event to all registered listeners.\n   */\n  private emit<K extends keyof WebSocketAdapterEvents>(\n    event: K,\n    ...args: Parameters<WebSocketAdapterEvents[K]>\n  ): void {\n    const callbacks = this.listeners.get(event);\n    if (callbacks) {\n      for (const callback of callbacks) {\n        try {\n          callback(...args);\n        } catch (error) {\n          // Use separate arguments to avoid format string injection\n          console.error('Error in WebSocket handler:', event, error);\n        }\n      }\n    }\n  }\n\n  /**\n   * Clear the connection timeout timer.\n   */\n  private clearConnectionTimeout(): void {\n    if (this.connectionTimeout) {\n      clearTimeout(this.connectionTimeout);\n      this.connectionTimeout = null;\n    }\n  }\n}\n","/**\n * OCI Realtime Speech Types\n *\n * TypeScript interfaces for real-time speech transcription using OCI's\n * WebSocket-based realtime speech service.\n */\n\nimport type { OCIConfig } from '../types';\n\n// ============================================================================\n// Audio Configuration\n// ============================================================================\n\n/**\n * Supported audio encodings for realtime transcription.\n * Maps to OCI's RealtimeParameters.encoding options.\n */\nexport type RealtimeAudioEncoding =\n  | 'audio/raw;rate=16000' // 16kHz PCM (default, recommended)\n  | 'audio/raw;rate=8000' // 8kHz PCM\n  | 'audio/raw;rate=8000;codec=mulaw' // 8kHz -law\n  | 'audio/raw;rate=8000;codec=alaw'; // 8kHz A-law\n\n/**\n * Stability level for partial transcription results.\n * Higher stability means more confident partial results but slower updates.\n */\nexport type PartialResultStability = 'NONE' | 'LOW' | 'MEDIUM' | 'HIGH';\n\n/**\n * Model domain for specialized transcription contexts.\n */\nexport type RealtimeModelDomain = 'GENERIC' | 'MEDICAL';\n\n/**\n * Punctuation mode for transcription output.\n */\nexport type RealtimePunctuation = 'NONE' | 'SPOKEN' | 'AUTO';\n\n/**\n * Model types available for realtime transcription.\n */\nexport type RealtimeModelType = 'ORACLE' | 'WHISPER';\n\n// ============================================================================\n// Settings and Configuration\n// ============================================================================\n\n/**\n * Settings for realtime transcription sessions.\n * Extends OCIConfig with realtime-specific options.\n */\nexport interface OCIRealtimeSettings extends OCIConfig {\n  /**\n   * Audio encoding format.\n   * @default 'audio/raw;rate=16000'\n   */\n  encoding?: RealtimeAudioEncoding;\n\n  /**\n   * Language code for transcription.\n   * - Oracle model: locale-specific (e.g., 'en-US', 'es-ES', 'de-DE')\n   * - Whisper model: language-only (e.g., 'en', 'es', 'de', or 'auto' for detection)\n   * @default 'en-US'\n   */\n  language?: string;\n\n  /**\n   * Transcription model to use.\n   * @default 'ORACLE'\n   */\n  model?: RealtimeModelType;\n\n  /**\n   * Model domain for specialized contexts.\n   * @default 'GENERIC'\n   */\n  modelDomain?: RealtimeModelDomain;\n\n  /**\n   * Enable partial (interim) transcription results.\n   * When enabled, you receive incremental results as speech is processed.\n   * @default true\n   */\n  partialResults?: boolean;\n\n  /**\n   * Stability level for partial results.\n   * Higher stability = more confident but slower partial updates.\n   * Only supported for Oracle model.\n   * @default 'MEDIUM'\n   */\n  partialResultStability?: PartialResultStability;\n\n  /**\n   * Silence threshold for partial results (milliseconds).\n   * Only supported for Oracle model.\n   */\n  partialSilenceThresholdMs?: number;\n\n  /**\n   * Silence threshold for final results (milliseconds).\n   * Only supported for Oracle model.\n   */\n  finalSilenceThresholdMs?: number;\n\n  /**\n   * Enable acknowledgment messages for audio chunks.\n   * @default false\n   */\n  ackEnabled?: boolean;\n\n  /**\n   * Punctuation mode for transcription output.\n   * @default 'AUTO'\n   */\n  punctuation?: RealtimePunctuation;\n\n  /**\n   * Custom vocabulary words to improve recognition.\n   * Only supported for Oracle model with customizations.\n   */\n  customizations?: Array<{\n    customizationId: string;\n    weight?: number;\n  }>;\n\n  /**\n   * Ignore invalid customizations instead of failing.\n   * @default true\n   */\n  ignoreInvalidCustomizations?: boolean;\n\n  /**\n   * WebSocket connection timeout (milliseconds).\n   * @default 30000\n   */\n  connectionTimeoutMs?: number;\n\n  /**\n   * Enable automatic reconnection on connection loss.\n   * @default true\n   */\n  autoReconnect?: boolean;\n\n  /**\n   * Maximum reconnection attempts.\n   * @default 3\n   */\n  maxReconnectAttempts?: number;\n}\n\n// ============================================================================\n// Transcription Results\n// ============================================================================\n\n/**\n * Individual word/token from transcription with timing info.\n */\nexport interface TranscriptionToken {\n  /** The transcribed word or punctuation */\n  token: string;\n  /** Start time in milliseconds */\n  startTimeMs: number;\n  /** End time in milliseconds */\n  endTimeMs: number;\n  /** Confidence score (0-1) */\n  confidence: number;\n  /** Token type (word, punctuation, etc.) */\n  type?: string;\n}\n\n/**\n * A single transcription result (partial or final).\n */\nexport interface RealtimeTranscriptionResult {\n  /** Transcribed text */\n  text: string;\n  /** Whether this is a final (complete) result or partial (interim) */\n  isFinal: boolean;\n  /** Confidence score (0-1) */\n  confidence: number;\n  /** Start time in milliseconds */\n  startTimeMs: number;\n  /** End time in milliseconds */\n  endTimeMs: number;\n  /** Trailing silence in milliseconds */\n  trailingSilenceMs: number;\n  /** Individual tokens with timing */\n  tokens: TranscriptionToken[];\n  /** Session ID for tracking */\n  sessionId?: string;\n  /** Result sequence number */\n  sequenceNumber?: number;\n}\n\n// ============================================================================\n// Event Types\n// ============================================================================\n\n/**\n * Events emitted by the realtime transcription session.\n */\nexport interface RealtimeTranscriptionEvents {\n  /** Emitted when a partial (interim) transcription is received */\n  partial: (result: RealtimeTranscriptionResult) => void;\n  /** Emitted when a final transcription is received */\n  final: (result: RealtimeTranscriptionResult) => void;\n  /** Alias for 'final' - matches AI SDK pattern */\n  result: (result: RealtimeTranscriptionResult) => void;\n  /** Emitted when WebSocket connection is established */\n  connected: (sessionId: string) => void;\n  /** Emitted when connection is closed */\n  disconnected: (reason?: string) => void;\n  /** Emitted when an error occurs */\n  error: (error: Error) => void;\n  /** Emitted when audio acknowledgment is received (if ackEnabled) */\n  audioAck: (details: AudioAckDetails) => void;\n  /** Emitted when attempting to reconnect */\n  reconnecting: (attempt: number, maxAttempts: number) => void;\n}\n\n/**\n * Audio acknowledgment details.\n */\nexport interface AudioAckDetails {\n  /** Number of audio frames acknowledged */\n  frameCount: number;\n  /** Timestamp of acknowledgment */\n  timestamp: number;\n}\n\n// ============================================================================\n// Connection State\n// ============================================================================\n\n/**\n * Current state of the realtime connection.\n */\nexport type RealtimeConnectionState =\n  | 'disconnected'\n  | 'connecting'\n  | 'authenticating'\n  | 'connected'\n  | 'reconnecting'\n  | 'error'\n  | 'closed';\n\n/**\n * Session information for an active realtime transcription.\n */\nexport interface RealtimeSessionInfo {\n  /** OCI session ID */\n  sessionId: string;\n  /** Compartment OCID */\n  compartmentId: string;\n  /** Connection state */\n  state: RealtimeConnectionState;\n  /** Connection establishment time */\n  connectedAt?: Date;\n  /** Total audio duration sent (ms) */\n  audioDurationMs: number;\n  /** Number of results received */\n  resultCount: number;\n}\n\n// ============================================================================\n// WebSocket Messages (Internal)\n// ============================================================================\n\n/**\n * Base WebSocket message structure.\n */\nexport interface RealtimeMessageBase {\n  event: string;\n  sessionId?: string;\n}\n\n/**\n * Authentication message sent to initiate session.\n */\nexport interface RealtimeAuthMessage extends RealtimeMessageBase {\n  event: 'AUTHENTICATE';\n  authenticationType: 'TOKEN';\n  token: string;\n  realtimeModelDetails?: {\n    domain?: RealtimeModelDomain;\n    languageCode?: string;\n  };\n  customizations?: Array<{\n    customizationId: string;\n    weight?: number;\n  }>;\n  parameters?: {\n    encoding?: string;\n    isAckEnabled?: boolean;\n    partialSilenceThresholdInMs?: number;\n    finalSilenceThresholdInMs?: number;\n    stabilizePartialResults?: PartialResultStability;\n    modelType?: RealtimeModelType;\n    modelDomain?: RealtimeModelDomain;\n    languageCode?: string;\n    punctuation?: RealtimePunctuation;\n  };\n}\n\n/**\n * Connection acknowledgment from server.\n */\nexport interface RealtimeConnectMessage extends RealtimeMessageBase {\n  event: 'CONNECT';\n  sessionId: string;\n}\n\n/**\n * Transcription result message from server.\n */\nexport interface RealtimeResultMessage extends RealtimeMessageBase {\n  event: 'RESULT';\n  transcriptions: Array<{\n    transcription: string;\n    isFinal: boolean;\n    startTimeInMs: number;\n    endTimeInMs: number;\n    confidence: number;\n    trailingSilence: number;\n    tokens: Array<{\n      token: string;\n      startTimeInMs: number;\n      endTimeInMs: number;\n      confidence: number;\n      type?: string;\n    }>;\n  }>;\n}\n\n/**\n * Audio acknowledgment message from server.\n */\nexport interface RealtimeAckMessage extends RealtimeMessageBase {\n  event: 'ACKAUDIO';\n  audioDetails: {\n    frameCount: number;\n  };\n}\n\n/**\n * Error message from server.\n */\nexport interface RealtimeErrorMessage extends RealtimeMessageBase {\n  event: 'ERROR';\n  code: string;\n  message: string;\n}\n\n/**\n * Request for final results before closing.\n */\nexport interface RealtimeSendFinalMessage extends RealtimeMessageBase {\n  event: 'SEND_FINAL_RESULT';\n}\n\n/**\n * Union of all possible server messages.\n */\nexport type RealtimeServerMessage =\n  | RealtimeConnectMessage\n  | RealtimeResultMessage\n  | RealtimeAckMessage\n  | RealtimeErrorMessage;\n\n// ============================================================================\n// Error Types\n// ============================================================================\n\n/**\n * Error codes specific to realtime transcription.\n */\nexport type RealtimeErrorCode =\n  | 'CONNECTION_FAILED'\n  | 'AUTHENTICATION_FAILED'\n  | 'CONNECTION_LOST'\n  | 'RECONNECTION_FAILED'\n  | 'INVALID_AUDIO'\n  | 'SESSION_EXPIRED'\n  | 'RATE_LIMITED'\n  | 'INTERNAL_ERROR';\n\n/**\n * Custom error for realtime transcription failures.\n */\nexport class RealtimeError extends Error {\n  constructor(\n    message: string,\n    public readonly code: RealtimeErrorCode,\n    public readonly cause?: Error\n  ) {\n    super(message);\n    this.name = 'RealtimeError';\n  }\n}\n","/**\n * OCI Realtime Client\n *\n * Manages WebSocket connections to OCI's realtime speech service.\n * Handles JWT token authentication and connection lifecycle.\n */\n\nimport { AIServiceSpeechClient } from 'oci-aispeech';\nimport * as common from 'oci-common';\nimport { WebSocketAdapter } from './WebSocketAdapter';\nimport type {\n  OCIRealtimeSettings,\n  RealtimeConnectionState,\n  RealtimeServerMessage,\n  RealtimeAuthMessage,\n  RealtimeConnectMessage,\n  RealtimeErrorMessage,\n} from './types';\nimport { RealtimeError } from './types';\nimport { OCIConfig } from '../types';\n\n/**\n * Events emitted by the realtime client.\n */\nexport interface RealtimeClientEvents {\n  /** Connection state changed */\n  stateChange: (state: RealtimeConnectionState) => void;\n  /** Authenticated and ready */\n  authenticated: (sessionId: string) => void;\n  /** Message received from server */\n  message: (message: RealtimeServerMessage) => void;\n  /** Connection error */\n  error: (error: Error) => void;\n  /** Connection closed */\n  closed: (code: number, reason: string) => void;\n}\n\n/**\n * Default OCI realtime speech regions and their endpoints.\n */\nconst REALTIME_ENDPOINTS: Record<string, string> = {\n  'us-phoenix-1': 'wss://realtime.aiservice.us-phoenix-1.oci.oraclecloud.com',\n  'us-ashburn-1': 'wss://realtime.aiservice.us-ashburn-1.oci.oraclecloud.com',\n  'eu-frankfurt-1': 'wss://realtime.aiservice.eu-frankfurt-1.oci.oraclecloud.com',\n  'uk-london-1': 'wss://realtime.aiservice.uk-london-1.oci.oraclecloud.com',\n  'ap-tokyo-1': 'wss://realtime.aiservice.ap-tokyo-1.oci.oraclecloud.com',\n  'ap-osaka-1': 'wss://realtime.aiservice.ap-osaka-1.oci.oraclecloud.com',\n  'ap-sydney-1': 'wss://realtime.aiservice.ap-sydney-1.oci.oraclecloud.com',\n  'ap-mumbai-1': 'wss://realtime.aiservice.ap-mumbai-1.oci.oraclecloud.com',\n  'ca-toronto-1': 'wss://realtime.aiservice.ca-toronto-1.oci.oraclecloud.com',\n  'sa-saopaulo-1': 'wss://realtime.aiservice.sa-saopaulo-1.oci.oraclecloud.com',\n};\n\n/**\n * Get the WebSocket endpoint for a region.\n */\nfunction getRealtimeEndpoint(region: string): string {\n  const endpoint = REALTIME_ENDPOINTS[region];\n  if (!endpoint) {\n    // Fall back to constructing the endpoint\n    return `wss://realtime.aiservice.${region}.oci.oraclecloud.com`;\n  }\n  return endpoint;\n}\n\n/**\n * OCI Realtime Client - manages WebSocket connections to OCI Speech service.\n *\n * This client handles:\n * - JWT token creation via OCI Speech API\n * - WebSocket connection management\n * - Authentication message exchange\n * - Reconnection with exponential backoff\n *\n * @example\n * ```typescript\n * const client = new OCIRealtimeClient({\n *   region: 'us-phoenix-1',\n *   compartmentId: 'ocid1.compartment...',\n * });\n *\n * client.on('authenticated', (sessionId) => {\n *   console.log('Connected with session:', sessionId);\n * });\n *\n * client.on('message', (msg) => {\n *   if (msg.event === 'RESULT') {\n *     console.log('Transcription:', msg.transcriptions);\n *   }\n * });\n *\n * await client.connect({\n *   language: 'en-US',\n *   model: 'ORACLE',\n * });\n *\n * // Send audio data\n * client.sendAudio(audioChunk);\n *\n * // Close when done\n * await client.close();\n * ```\n */\nexport class OCIRealtimeClient {\n  private ws: WebSocketAdapter | null = null;\n  private speechClient: AIServiceSpeechClient | null = null;\n  private sessionToken: string | null = null;\n  private sessionId: string | null = null;\n  private listeners: Map<string, Set<(...args: unknown[]) => void>> = new Map();\n  private _state: RealtimeConnectionState = 'disconnected';\n  private reconnectAttempts = 0;\n  private reconnectTimer: ReturnType<typeof setTimeout> | null = null;\n\n  constructor(private readonly config: OCIConfig) {}\n\n  /**\n   * Get the current connection state.\n   */\n  get state(): RealtimeConnectionState {\n    return this._state;\n  }\n\n  /**\n   * Get the current session ID (available after authentication).\n   */\n  get currentSessionId(): string | null {\n    return this.sessionId;\n  }\n\n  /**\n   * Check if the client is connected and authenticated.\n   */\n  get isConnected(): boolean {\n    return this._state === 'connected' && this.ws?.isOpen === true;\n  }\n\n  /**\n   * Register an event listener.\n   */\n  on<K extends keyof RealtimeClientEvents>(event: K, callback: RealtimeClientEvents[K]): void {\n    if (!this.listeners.has(event)) {\n      this.listeners.set(event, new Set());\n    }\n    this.listeners.get(event)!.add(callback as (...args: unknown[]) => void);\n  }\n\n  /**\n   * Remove an event listener.\n   */\n  off<K extends keyof RealtimeClientEvents>(event: K, callback: RealtimeClientEvents[K]): void {\n    this.listeners.get(event)?.delete(callback as (...args: unknown[]) => void);\n  }\n\n  /**\n   * Connect to the OCI realtime speech service.\n   *\n   * @param settings - Realtime transcription settings\n   * @throws RealtimeError if connection fails\n   */\n  async connect(settings: OCIRealtimeSettings = {}): Promise<void> {\n    if (this._state === 'connected' || this._state === 'connecting') {\n      throw new Error('Already connected or connecting');\n    }\n\n    this.setState('connecting');\n\n    try {\n      // Initialize OCI Speech client if needed\n      if (!this.speechClient) {\n        this.speechClient = await this.createSpeechClient();\n      }\n\n      // Get compartment ID\n      const compartmentId = settings.compartmentId ?? this.config.compartmentId;\n      if (!compartmentId) {\n        throw new Error('compartmentId is required for realtime transcription');\n      }\n\n      // Create session token\n      this.sessionToken = await this.createSessionToken(compartmentId);\n\n      // Determine WebSocket endpoint\n      const region = settings.region ?? this.config.region ?? 'us-phoenix-1';\n      const wsEndpoint = getRealtimeEndpoint(region);\n\n      // Create WebSocket connection\n      this.ws = new WebSocketAdapter(wsEndpoint, {\n        connectionTimeoutMs: settings.connectionTimeoutMs ?? 30000,\n      });\n\n      // Set up WebSocket event handlers\n      this.setupWebSocketHandlers(settings);\n\n      // Wait for connection to open\n      await this.waitForOpen();\n\n      // Send authentication message\n      this.setState('authenticating');\n      this.sendAuthMessage(settings);\n\n      // Wait for authentication response\n      await this.waitForAuthentication();\n\n      this.reconnectAttempts = 0;\n    } catch (error) {\n      this.setState('error');\n      const err = error instanceof Error ? error : new Error(String(error));\n      this.emit('error', err);\n      throw err;\n    }\n  }\n\n  /**\n   * Send audio data to the service.\n   *\n   * @param audio - Audio data as Uint8Array or ArrayBuffer\n   * @throws Error if not connected\n   */\n  sendAudio(audio: Uint8Array | ArrayBuffer): void {\n    if (!this.isConnected || !this.ws) {\n      throw new Error('Not connected to realtime service');\n    }\n\n    this.ws.send(audio);\n  }\n\n  /**\n   * Request final results and close the session gracefully.\n   */\n  async requestFinalResult(): Promise<void> {\n    if (!this.isConnected || !this.ws) {\n      return;\n    }\n\n    const message = JSON.stringify({\n      event: 'SEND_FINAL_RESULT',\n    });\n\n    this.ws.send(message);\n  }\n\n  /**\n   * Close the WebSocket connection.\n   *\n   * @param code - Close code (default: 1000)\n   * @param reason - Close reason\n   */\n  async close(code = 1000, reason = 'Normal closure'): Promise<void> {\n    this.clearReconnectTimer();\n\n    if (this.ws) {\n      // Request final result before closing\n      try {\n        await this.requestFinalResult();\n        // Give server a moment to send final results\n        await new Promise((resolve) => setTimeout(resolve, 100));\n      } catch {\n        // Ignore errors during final result request\n      }\n\n      this.ws.close(code, reason);\n      this.ws = null;\n    }\n\n    this.sessionToken = null;\n    this.sessionId = null;\n    this.setState('closed');\n  }\n\n  /**\n   * Create the OCI Speech client with proper authentication.\n   */\n  private async createSpeechClient(): Promise<AIServiceSpeechClient> {\n    const authMethod = this.config.auth ?? 'config_file';\n\n    let authProvider: common.AuthenticationDetailsProvider;\n\n    switch (authMethod) {\n      case 'instance_principal':\n        authProvider =\n          await new common.InstancePrincipalsAuthenticationDetailsProviderBuilder().build();\n        break;\n\n      case 'resource_principal':\n        authProvider = await common.ResourcePrincipalAuthenticationDetailsProvider.builder();\n        break;\n\n      case 'config_file':\n      default: {\n        const configPath = this.config.configPath ?? common.ConfigFileReader.DEFAULT_FILE_PATH;\n        const profile = this.config.profile ?? 'DEFAULT';\n        authProvider = new common.ConfigFileAuthenticationDetailsProvider(configPath, profile);\n        break;\n      }\n    }\n\n    const client = new AIServiceSpeechClient({ authenticationDetailsProvider: authProvider });\n\n    // Set region if specified\n    const region = this.config.region ?? 'us-phoenix-1';\n    client.regionId = region;\n\n    return client;\n  }\n\n  /**\n   * Create a session token for WebSocket authentication.\n   */\n  private async createSessionToken(compartmentId: string): Promise<string> {\n    if (!this.speechClient) {\n      throw new Error('Speech client not initialized');\n    }\n\n    const response = await this.speechClient.createRealtimeSessionToken({\n      createRealtimeSessionTokenDetails: {\n        compartmentId,\n      },\n    });\n\n    return response.realtimeSessionToken.token;\n  }\n\n  /**\n   * Set up WebSocket event handlers.\n   */\n  private setupWebSocketHandlers(settings: OCIRealtimeSettings): void {\n    if (!this.ws) return;\n\n    this.ws.on('message', (data) => {\n      this.handleMessage(data);\n    });\n\n    this.ws.on('close', (code, reason) => {\n      this.handleClose(code, reason, settings);\n    });\n\n    this.ws.on('error', (error) => {\n      this.emit('error', error);\n    });\n  }\n\n  /**\n   * Wait for the WebSocket to open.\n   */\n  private waitForOpen(): Promise<void> {\n    return new Promise((resolve, reject) => {\n      if (!this.ws) {\n        reject(new Error('WebSocket not created'));\n        return;\n      }\n\n      if (this.ws.isOpen) {\n        resolve();\n        return;\n      }\n\n      const onOpen = () => {\n        cleanup();\n        resolve();\n      };\n\n      const onError = (error: Error) => {\n        cleanup();\n        reject(error);\n      };\n\n      const onClose = (_code: number, reason: string) => {\n        cleanup();\n        reject(new Error('Connection closed: ' + (reason || 'Unknown reason')));\n      };\n\n      const cleanup = () => {\n        this.ws?.off('open', onOpen);\n        this.ws?.off('error', onError);\n        this.ws?.off('close', onClose);\n      };\n\n      this.ws.on('open', onOpen);\n      this.ws.on('error', onError);\n      this.ws.on('close', onClose);\n    });\n  }\n\n  /**\n   * Wait for authentication to complete.\n   */\n  private waitForAuthentication(): Promise<void> {\n    return new Promise((resolve, reject) => {\n      const timeoutMs = 10000;\n      let resolved = false;\n\n      const timeout = setTimeout(() => {\n        if (!resolved) {\n          resolved = true;\n          cleanup();\n          reject(new Error('Authentication timeout'));\n        }\n      }, timeoutMs);\n\n      const onAuthenticated = () => {\n        if (!resolved) {\n          resolved = true;\n          cleanup();\n          resolve();\n        }\n      };\n\n      const onError = (error: Error) => {\n        if (!resolved) {\n          resolved = true;\n          cleanup();\n          reject(error);\n        }\n      };\n\n      const cleanup = () => {\n        clearTimeout(timeout);\n        this.off('authenticated', onAuthenticated);\n        this.off('error', onError);\n      };\n\n      this.on('authenticated', onAuthenticated);\n      this.on('error', onError);\n    });\n  }\n\n  /**\n   * Send the authentication message to the server.\n   */\n  private sendAuthMessage(settings: OCIRealtimeSettings): void {\n    if (!this.ws || !this.sessionToken) {\n      throw new Error('WebSocket or session token not available');\n    }\n\n    const authMessage: RealtimeAuthMessage = {\n      event: 'AUTHENTICATE',\n      authenticationType: 'TOKEN',\n      token: this.sessionToken,\n      realtimeModelDetails: {\n        domain: settings.modelDomain ?? 'GENERIC',\n        languageCode: settings.language ?? 'en-US',\n      },\n      customizations: settings.customizations,\n      parameters: {\n        encoding: settings.encoding ?? 'audio/raw;rate=16000',\n        isAckEnabled: settings.ackEnabled ?? false,\n        partialSilenceThresholdInMs: settings.partialSilenceThresholdMs,\n        finalSilenceThresholdInMs: settings.finalSilenceThresholdMs,\n        stabilizePartialResults: settings.partialResultStability ?? 'MEDIUM',\n        modelType: settings.model ?? 'ORACLE',\n        modelDomain: settings.modelDomain ?? 'GENERIC',\n        languageCode: settings.language ?? 'en-US',\n        punctuation: settings.punctuation ?? 'AUTO',\n      },\n    };\n\n    this.ws.send(JSON.stringify(authMessage));\n  }\n\n  /**\n   * Handle incoming WebSocket messages.\n   */\n  private handleMessage(data: string | ArrayBuffer): void {\n    // Only handle text messages (JSON)\n    if (typeof data !== 'string') {\n      return;\n    }\n\n    try {\n      const message = JSON.parse(data) as RealtimeServerMessage;\n\n      switch (message.event) {\n        case 'CONNECT':\n          this.handleConnectMessage(message);\n          break;\n\n        case 'RESULT':\n          this.emit('message', message);\n          break;\n\n        case 'ACKAUDIO':\n          this.emit('message', message);\n          break;\n\n        case 'ERROR':\n          this.handleErrorMessage(message);\n          break;\n\n        default:\n          // Unknown message type - emit anyway for extensibility\n          this.emit('message', message);\n      }\n    } catch {\n      // Ignore JSON parse errors - might be binary data\n    }\n  }\n\n  /**\n   * Handle connection acknowledgment message.\n   */\n  private handleConnectMessage(message: RealtimeConnectMessage): void {\n    this.sessionId = message.sessionId;\n    this.setState('connected');\n    this.emit('authenticated', message.sessionId);\n    this.emit('message', message);\n  }\n\n  /**\n   * Handle error message from server.\n   */\n  private handleErrorMessage(message: RealtimeErrorMessage): void {\n    const error = new RealtimeError(message.message, message.code as RealtimeError['code']);\n    this.emit('error', error);\n    this.emit('message', message);\n  }\n\n  /**\n   * Handle WebSocket close event.\n   */\n  private handleClose(code: number, reason: string, settings: OCIRealtimeSettings): void {\n    this.emit('closed', code, reason);\n\n    // Check if we should reconnect\n    const autoReconnect = settings.autoReconnect ?? true;\n    const maxAttempts = settings.maxReconnectAttempts ?? 3;\n    const wasConnected = this._state === 'connected';\n\n    if (autoReconnect && wasConnected && code !== 1000 && this.reconnectAttempts < maxAttempts) {\n      this.attemptReconnect(settings);\n    } else {\n      this.setState('disconnected');\n    }\n  }\n\n  /**\n   * Attempt to reconnect with exponential backoff.\n   */\n  private attemptReconnect(settings: OCIRealtimeSettings): void {\n    this.reconnectAttempts++;\n    this.setState('reconnecting');\n\n    // Exponential backoff: 1s, 2s, 4s, 8s...\n    const delay = Math.min(1000 * Math.pow(2, this.reconnectAttempts - 1), 30000);\n\n    this.reconnectTimer = setTimeout(async () => {\n      try {\n        this.ws = null;\n        this.sessionToken = null;\n        await this.connect(settings);\n      } catch {\n        // Reconnection failed - will be handled by close event\n      }\n    }, delay);\n  }\n\n  /**\n   * Clear the reconnection timer.\n   */\n  private clearReconnectTimer(): void {\n    if (this.reconnectTimer) {\n      clearTimeout(this.reconnectTimer);\n      this.reconnectTimer = null;\n    }\n  }\n\n  /**\n   * Set connection state and emit event.\n   */\n  private setState(state: RealtimeConnectionState): void {\n    if (this._state !== state) {\n      this._state = state;\n      this.emit('stateChange', state);\n    }\n  }\n\n  /**\n   * Emit an event to all registered listeners.\n   */\n  private emit<K extends keyof RealtimeClientEvents>(\n    event: K,\n    ...args: Parameters<RealtimeClientEvents[K]>\n  ): void {\n    const callbacks = this.listeners.get(event);\n    if (callbacks) {\n      for (const callback of callbacks) {\n        try {\n          callback(...args);\n        } catch (error) {\n          // Use separate arguments for safe logging\n          console.error('Error in realtime client handler:', event, error);\n        }\n      }\n    }\n  }\n}\n","/**\n * OCI Realtime Transcription Session\n *\n * High-level API for real-time speech transcription using OCI's\n * WebSocket-based realtime speech service.\n *\n * Supports both event-based and async iterator patterns.\n */\n\nimport { OCIRealtimeClient } from './OCIRealtimeClient';\nimport {\n  RealtimeError,\n  type OCIRealtimeSettings,\n  type RealtimeTranscriptionResult,\n  type RealtimeTranscriptionEvents,\n  type RealtimeConnectionState,\n  type RealtimeSessionInfo,\n  type RealtimeResultMessage,\n  type TranscriptionToken,\n  type RealtimeErrorCode,\n} from './types';\nimport type { OCIConfig } from '../types';\n\n/**\n * Create a RealtimeError with proper typing.\n */\nfunction createRealtimeError(\n  message: string,\n  code: RealtimeErrorCode,\n  cause?: Error\n): RealtimeError {\n  return new RealtimeError(message, code, cause);\n}\n\n/**\n * Convert OCI transcription result to our normalized format.\n */\nfunction normalizeTranscriptionResult(\n  ociResult: RealtimeResultMessage['transcriptions'][0],\n  sessionId?: string,\n  sequenceNumber?: number\n): RealtimeTranscriptionResult {\n  return {\n    text: ociResult.transcription,\n    isFinal: ociResult.isFinal,\n    confidence: ociResult.confidence,\n    startTimeMs: ociResult.startTimeInMs,\n    endTimeMs: ociResult.endTimeInMs,\n    trailingSilenceMs: ociResult.trailingSilence,\n    tokens: ociResult.tokens.map(\n      (t): TranscriptionToken => ({\n        token: t.token,\n        startTimeMs: t.startTimeInMs,\n        endTimeMs: t.endTimeInMs,\n        confidence: t.confidence,\n        type: t.type,\n      })\n    ),\n    sessionId,\n    sequenceNumber,\n  };\n}\n\n/**\n * OCI Realtime Transcription Session\n *\n * Provides a high-level API for real-time speech-to-text transcription.\n * Supports both event-based and async iterator patterns for flexibility.\n *\n * @example Event-based API\n * ```typescript\n * const session = new OCIRealtimeTranscription({\n *   region: 'us-phoenix-1',\n *   compartmentId: 'ocid1.compartment...',\n * });\n *\n * session.on('partial', (result) => {\n *   console.log('Partial:', result.text);\n * });\n *\n * session.on('final', (result) => {\n *   console.log('Final:', result.text);\n * });\n *\n * await session.connect();\n * session.sendAudio(audioChunk);\n * await session.close();\n * ```\n *\n * @example Async Iterator API\n * ```typescript\n * const session = new OCIRealtimeTranscription(config);\n * await session.connect();\n *\n * // Stream audio from microphone or file\n * streamAudioTo(session);\n *\n * // Process results as they arrive\n * for await (const result of session) {\n *   console.log(result.isFinal ? 'FINAL:' : 'PARTIAL:', result.text);\n * }\n * ```\n *\n * @example With transcribe() helper\n * ```typescript\n * const session = new OCIRealtimeTranscription(config);\n *\n * for await (const result of session.transcribe(audioStream)) {\n *   console.log(result.text);\n * }\n * ```\n */\nexport class OCIRealtimeTranscription implements AsyncIterable<RealtimeTranscriptionResult> {\n  private client: OCIRealtimeClient;\n  private settings: OCIRealtimeSettings;\n  private listeners: Map<string, Set<(...args: unknown[]) => void>> = new Map();\n  private resultQueue: RealtimeTranscriptionResult[] = [];\n  private resultResolvers: Array<(value: IteratorResult<RealtimeTranscriptionResult>) => void> = [];\n  private iteratorDone = false;\n  private resultSequence = 0;\n  private audioDurationMs = 0;\n  private resultCount = 0;\n  private connectedAt: Date | null = null;\n\n  /**\n   * Create a new realtime transcription session.\n   *\n   * @param config - Base OCI configuration\n   * @param settings - Realtime-specific settings (merged with config)\n   */\n  constructor(config: OCIConfig, settings: OCIRealtimeSettings = {}) {\n    this.settings = { ...config, ...settings };\n    this.client = new OCIRealtimeClient(config);\n    this.setupClientHandlers();\n  }\n\n  /**\n   * Get the current connection state.\n   */\n  get state(): RealtimeConnectionState {\n    return this.client.state;\n  }\n\n  /**\n   * Check if the session is connected and ready.\n   */\n  get isConnected(): boolean {\n    return this.client.isConnected;\n  }\n\n  /**\n   * Get session information.\n   */\n  get sessionInfo(): RealtimeSessionInfo {\n    return {\n      sessionId: this.client.currentSessionId ?? '',\n      compartmentId: this.settings.compartmentId ?? '',\n      state: this.state,\n      connectedAt: this.connectedAt ?? undefined,\n      audioDurationMs: this.audioDurationMs,\n      resultCount: this.resultCount,\n    };\n  }\n\n  /**\n   * Register an event listener.\n   *\n   * @param event - Event name\n   * @param callback - Callback function\n   */\n  on<K extends keyof RealtimeTranscriptionEvents>(\n    event: K,\n    callback: RealtimeTranscriptionEvents[K]\n  ): this {\n    if (!this.listeners.has(event)) {\n      this.listeners.set(event, new Set());\n    }\n    this.listeners.get(event)!.add(callback as (...args: unknown[]) => void);\n    return this;\n  }\n\n  /**\n   * Remove an event listener.\n   *\n   * @param event - Event name\n   * @param callback - Callback function\n   */\n  off<K extends keyof RealtimeTranscriptionEvents>(\n    event: K,\n    callback: RealtimeTranscriptionEvents[K]\n  ): this {\n    this.listeners.get(event)?.delete(callback as (...args: unknown[]) => void);\n    return this;\n  }\n\n  /**\n   * Connect to the realtime transcription service.\n   *\n   * @param settings - Optional settings to override the constructor settings\n   */\n  async connect(settings?: Partial<OCIRealtimeSettings>): Promise<void> {\n    const mergedSettings = { ...this.settings, ...settings };\n    this.settings = mergedSettings;\n\n    try {\n      await this.client.connect(mergedSettings);\n      this.connectedAt = new Date();\n      this.emit('connected', this.client.currentSessionId ?? '');\n    } catch (error) {\n      const realtimeError = createRealtimeError(\n        'Failed to connect to realtime service',\n        'CONNECTION_FAILED',\n        error instanceof Error ? error : undefined\n      );\n      this.emit('error', realtimeError);\n      throw realtimeError;\n    }\n  }\n\n  /**\n   * Send audio data to the transcription service.\n   *\n   * @param audio - Audio data as Uint8Array, ArrayBuffer, or Buffer\n   * @param durationMs - Optional duration in milliseconds for tracking\n   */\n  sendAudio(audio: Uint8Array | ArrayBuffer, durationMs?: number): void {\n    if (!this.isConnected) {\n      throw createRealtimeError('Not connected to realtime service', 'CONNECTION_FAILED');\n    }\n\n    this.client.sendAudio(audio);\n\n    // Track audio duration for session info\n    if (durationMs !== undefined) {\n      this.audioDurationMs += durationMs;\n    } else {\n      // Estimate based on 16kHz 16-bit mono audio (default encoding)\n      const byteLength = audio instanceof ArrayBuffer ? audio.byteLength : audio.byteLength;\n      this.audioDurationMs += (byteLength / 32000) * 1000; // 16kHz * 2 bytes = 32000 bytes/sec\n    }\n  }\n\n  /**\n   * Request final transcription results.\n   * Call this when you've finished sending audio.\n   */\n  async requestFinalResult(): Promise<void> {\n    await this.client.requestFinalResult();\n  }\n\n  /**\n   * Close the transcription session.\n   *\n   * @param waitForFinal - Wait for final results before closing (default: true)\n   */\n  async close(waitForFinal = true): Promise<void> {\n    if (waitForFinal && this.isConnected) {\n      // Request final result and wait briefly for response\n      await this.requestFinalResult();\n      await new Promise((resolve) => setTimeout(resolve, 500));\n    }\n\n    await this.client.close();\n    this.markIteratorDone();\n    this.emit('disconnected', 'Session closed');\n  }\n\n  /**\n   * Transcribe an audio stream using the async iterator pattern.\n   *\n   * This method handles connecting, streaming audio, and closing.\n   *\n   * @param audioSource - Async iterable of audio chunks\n   * @param settings - Optional settings override\n   * @yields Transcription results as they arrive\n   *\n   * @example\n   * ```typescript\n   * async function* getAudioChunks() {\n   *   // Yield audio chunks from microphone, file, etc.\n   *   yield new Uint8Array([...]);\n   * }\n   *\n   * for await (const result of session.transcribe(getAudioChunks())) {\n   *   console.log(result.text);\n   * }\n   * ```\n   */\n  async *transcribe(\n    audioSource: AsyncIterable<Uint8Array | ArrayBuffer>,\n    settings?: Partial<OCIRealtimeSettings>\n  ): AsyncGenerator<RealtimeTranscriptionResult> {\n    // Connect if not already connected\n    if (!this.isConnected) {\n      await this.connect(settings);\n    }\n\n    // Start consuming audio in the background\n    const audioPromise = this.consumeAudioSource(audioSource);\n\n    // Yield results as they arrive\n    try {\n      for await (const result of this) {\n        yield result;\n      }\n    } finally {\n      // Ensure audio consumption is complete\n      await audioPromise;\n    }\n  }\n\n  /**\n   * Implement AsyncIterable for for-await-of support.\n   */\n  [Symbol.asyncIterator](): AsyncIterator<RealtimeTranscriptionResult> {\n    return {\n      next: () => this.nextResult(),\n    };\n  }\n\n  /**\n   * Get the next transcription result.\n   * Used internally by the async iterator.\n   */\n  private nextResult(): Promise<IteratorResult<RealtimeTranscriptionResult>> {\n    // Check if we have queued results\n    if (this.resultQueue.length > 0) {\n      const result = this.resultQueue.shift()!;\n      return Promise.resolve({ value: result, done: false });\n    }\n\n    // Check if iteration is complete\n    if (this.iteratorDone) {\n      return Promise.resolve({ value: undefined as never, done: true });\n    }\n\n    // Wait for the next result\n    return new Promise((resolve) => {\n      this.resultResolvers.push(resolve);\n    });\n  }\n\n  /**\n   * Add a result to the queue or resolve a waiting promise.\n   */\n  private enqueueResult(result: RealtimeTranscriptionResult): void {\n    if (this.resultResolvers.length > 0) {\n      const resolve = this.resultResolvers.shift()!;\n      resolve({ value: result, done: false });\n    } else {\n      this.resultQueue.push(result);\n    }\n  }\n\n  /**\n   * Mark the iterator as done and resolve any waiting promises.\n   */\n  private markIteratorDone(): void {\n    this.iteratorDone = true;\n    while (this.resultResolvers.length > 0) {\n      const resolve = this.resultResolvers.shift()!;\n      resolve({ value: undefined as never, done: true });\n    }\n  }\n\n  /**\n   * Consume audio from an async iterable source.\n   */\n  private async consumeAudioSource(\n    audioSource: AsyncIterable<Uint8Array | ArrayBuffer>\n  ): Promise<void> {\n    try {\n      for await (const chunk of audioSource) {\n        if (!this.isConnected) {\n          break;\n        }\n        this.sendAudio(chunk);\n      }\n\n      // Request final result when audio source is exhausted\n      if (this.isConnected) {\n        await this.requestFinalResult();\n      }\n    } catch (error) {\n      this.emit('error', error instanceof Error ? error : new Error(String(error)));\n    }\n  }\n\n  /**\n   * Set up event handlers for the underlying client.\n   */\n  private setupClientHandlers(): void {\n    this.client.on('message', (message) => {\n      if (message.event === 'RESULT') {\n        this.handleResultMessage(message);\n      } else if (message.event === 'ACKAUDIO') {\n        this.emit('audioAck', {\n          frameCount:\n            (message as { audioDetails?: { frameCount?: number } }).audioDetails?.frameCount ?? 0,\n          timestamp: Date.now(),\n        });\n      }\n    });\n\n    this.client.on('stateChange', (state) => {\n      if (state === 'reconnecting') {\n        this.emit('reconnecting', 1, this.settings.maxReconnectAttempts ?? 3);\n      }\n    });\n\n    this.client.on('error', (error) => {\n      this.emit('error', error);\n    });\n\n    this.client.on('closed', (code, reason) => {\n      this.markIteratorDone();\n      if (code !== 1000) {\n        this.emit('disconnected', reason || 'Connection lost');\n      }\n    });\n  }\n\n  /**\n   * Handle transcription result messages.\n   */\n  private handleResultMessage(message: RealtimeResultMessage): void {\n    for (const transcription of message.transcriptions) {\n      this.resultSequence++;\n      this.resultCount++;\n\n      const result = normalizeTranscriptionResult(\n        transcription,\n        this.client.currentSessionId ?? undefined,\n        this.resultSequence\n      );\n\n      // Emit appropriate events\n      if (result.isFinal) {\n        this.emit('final', result);\n        this.emit('result', result);\n      } else {\n        this.emit('partial', result);\n      }\n\n      // Add to iterator queue\n      this.enqueueResult(result);\n    }\n  }\n\n  /**\n   * Emit an event to all registered listeners.\n   */\n  private emit<K extends keyof RealtimeTranscriptionEvents>(\n    event: K,\n    ...args: Parameters<RealtimeTranscriptionEvents[K]>\n  ): void {\n    const callbacks = this.listeners.get(event);\n    if (callbacks) {\n      for (const callback of callbacks) {\n        try {\n          callback(...args);\n        } catch (error) {\n          // Use separate arguments for safe logging\n          console.error('Error in transcription handler:', event, error);\n        }\n      }\n    }\n  }\n}\n","import {\n  ProviderV3,\n  LanguageModelV3,\n  EmbeddingModelV3,\n  ImageModelV3,\n  TranscriptionModelV3,\n  SpeechModelV3,\n  RerankingModelV3,\n  NoSuchModelError,\n} from '@ai-sdk/provider';\nimport { OCILanguageModel } from './language-models/OCILanguageModel';\nimport { MODEL_CATALOG } from './language-models/registry';\nimport { OCIEmbeddingModel } from './embedding-models/OCIEmbeddingModel';\nimport { OCISpeechModel } from './speech-models/OCISpeechModel';\nimport { OCIRerankingModel } from './reranking-models/OCIRerankingModel';\nimport { OCITranscriptionModel } from './transcription-models/OCITranscriptionModel';\nimport { OCIRealtimeTranscription } from './realtime/OCIRealtimeTranscription';\nimport type {\n  OCIConfig,\n  OCILanguageModelSettings,\n  OCIEmbeddingSettings,\n  OCISpeechSettings,\n  OCITranscriptionSettings,\n  OCIRerankingSettings,\n} from './types';\nimport type { OCIRealtimeSettings } from './realtime/types';\n\n/**\n * OCI GenAI Provider implementing ProviderV3 interface.\n *\n * Supports:\n * - Language Models (16+ models including Cohere, Llama, Grok, Gemini)\n * - Embeddings (coming in Plan 2)\n * - Speech/TTS (coming in Plan 3)\n * - Transcription/STT (coming in Plan 4)\n * - Reranking (coming in Plan 5)\n */\nexport class OCIGenAIProvider implements ProviderV3 {\n  readonly specificationVersion = 'v3' as const;\n\n  constructor(private readonly config: OCIConfig = {}) {}\n\n  get models(): Record<string, any> {\n    const models: Record<string, any> = {};\n    for (const model of MODEL_CATALOG) {\n      models[model.id] = {\n        modelId: model.id,\n        ...model,\n      };\n    }\n    return models;\n  }\n\n  /**\n   * Create a language model instance for chat/completion.\n   *\n   * @param modelId - OCI model identifier (e.g., 'cohere.command-r-plus')\n   * @param settings - Optional model-specific settings that override provider config\n   * @returns Language model instance\n   *\n   * @example\n   * ```typescript\n   * const provider = new OCIGenAIProvider({ region: 'eu-frankfurt-1' });\n   * const model = provider.languageModel('cohere.command-r-plus');\n   * ```\n   */\n  languageModel(modelId: string, settings?: OCILanguageModelSettings): LanguageModelV3 {\n    const mergedConfig: OCIConfig = { ...this.config, ...settings };\n    return new OCILanguageModel(modelId, mergedConfig);\n  }\n\n  /**\n   * Create a language model instance for chat/completion.\n   * Alias for `languageModel`.\n   *\n   * @param modelId - OCI model identifier\n   * @param settings - Optional model-specific settings\n   */\n  chat(modelId: string, settings?: OCILanguageModelSettings): LanguageModelV3 {\n    return this.languageModel(modelId, settings);\n  }\n\n  /**\n   * Create an embedding model instance.\n   *\n   * @param modelId - OCI embedding model identifier (e.g., 'cohere.embed-multilingual-v3.0')\n   * @param settings - Optional model-specific settings that override provider config\n   * @returns Embedding model instance\n   *\n   * @example\n   * ```typescript\n   * const provider = new OCIGenAIProvider({ region: 'eu-frankfurt-1' });\n   * const model = provider.embeddingModel('cohere.embed-multilingual-v3.0');\n   * ```\n   */\n  embeddingModel(modelId: string, settings?: OCIEmbeddingSettings): EmbeddingModelV3 {\n    const mergedConfig: OCIConfig = { ...this.config, ...settings };\n    return new OCIEmbeddingModel(modelId, mergedConfig);\n  }\n\n  /**\n   * Image generation is not supported by OCI GenAI.\n   *\n   * @throws {NoSuchModelError} Always throws - OCI does not provide image generation\n   */\n  imageModel(modelId: string): ImageModelV3 {\n    throw new NoSuchModelError({\n      modelId,\n      modelType: 'imageModel',\n      message: 'OCI does not provide image generation models.',\n    });\n  }\n\n  /**\n   * Create a transcription model instance (STT).\n   *\n   * @throws {NoSuchModelError} Not yet implemented - coming in Plan 4\n   */\n  transcriptionModel(modelId: string, settings?: OCITranscriptionSettings): TranscriptionModelV3 {\n    const mergedConfig: OCIConfig = { ...this.config, ...settings };\n    return new OCITranscriptionModel(modelId, mergedConfig);\n  }\n\n  /**\n   * Create a speech model instance (TTS).\n   *\n   * @param modelId - OCI speech model identifier (e.g., 'TTS_2_NATURAL')\n   * @param settings - Optional model-specific settings that override provider config\n   * @returns Speech model instance\n   *\n   * @example\n   * ```typescript\n   * const provider = new OCIGenAIProvider({ region: 'us-phoenix-1' });\n   * const model = provider.speechModel('TTS_2_NATURAL');\n   * ```\n   */\n  speechModel(modelId: string, settings?: OCISpeechSettings): SpeechModelV3 {\n    const mergedConfig: OCIConfig = { ...this.config, ...settings };\n    return new OCISpeechModel(modelId, mergedConfig);\n  }\n\n  /**\n   * Create a reranking model instance.\n   *\n   * @param modelId - OCI reranking model identifier (e.g., 'cohere.rerank-v3.5')\n   * @param settings - Optional model-specific settings that override provider config\n   * @returns Reranking model instance\n   *\n   * @example\n   * ```typescript\n   * const provider = new OCIGenAIProvider({ region: 'eu-frankfurt-1' });\n   * const model = provider.rerankingModel('cohere.rerank-v3.5');\n   * ```\n   */\n  rerankingModel(modelId: string, settings?: OCIRerankingSettings): RerankingModelV3 {\n    const mergedConfig: OCIConfig = { ...this.config, ...settings };\n    return new OCIRerankingModel(modelId, mergedConfig);\n  }\n\n  /**\n   * Create a realtime transcription session for low-latency streaming STT.\n   *\n   * Unlike the batch `transcriptionModel()`, this uses OCI's WebSocket-based\n   * realtime speech service for sub-second latency streaming transcription.\n   *\n   * @param settings - Realtime transcription settings\n   * @returns Realtime transcription session\n   *\n   * @example Event-based API\n   * ```typescript\n   * const session = oci.realtimeTranscription({\n   *   language: 'en-US',\n   *   model: 'ORACLE',\n   * });\n   *\n   * session.on('partial', (result) => console.log('Partial:', result.text));\n   * session.on('final', (result) => console.log('Final:', result.text));\n   *\n   * await session.connect();\n   * session.sendAudio(audioChunk);\n   * await session.close();\n   * ```\n   *\n   * @example Async Iterator API\n   * ```typescript\n   * const session = oci.realtimeTranscription({ language: 'en-US' });\n   *\n   * for await (const result of session.transcribe(audioStream)) {\n   *   console.log(result.isFinal ? 'FINAL:' : 'PARTIAL:', result.text);\n   * }\n   * ```\n   */\n  realtimeTranscription(settings?: OCIRealtimeSettings): OCIRealtimeTranscription {\n    return new OCIRealtimeTranscription(this.config, settings);\n  }\n}\n","/**\n * OCI Generative AI Provider for Vercel AI SDK\n *\n * Complete ProviderV3 implementation supporting:\n * - Language Models (16+ models including Cohere, Llama, Grok, Gemini)\n * - Embeddings (coming in v0.2.0)\n * - Speech/Transcription (coming in v0.3.0)\n * - Reranking (coming in v0.4.0)\n *\n * @example\n * ```typescript\n * import { oci, createOCI } from '@acedergren/oci-genai-provider';\n *\n * // Use default provider instance\n * const model = oci.languageModel('cohere.command-r-plus');\n *\n * // Or create custom provider\n * const provider = createOCI({ region: 'eu-frankfurt-1' });\n * const customModel = provider.languageModel('meta.llama-3.3-70b-instruct');\n * ```\n */\n\nimport { OCIGenAIProvider } from './provider';\nimport type { OCIConfig } from './types';\n\n// ============================================================================\n// Provider Exports\n// ============================================================================\n\nexport { OCIGenAIProvider } from './provider';\n\n/**\n * Create a new OCI provider instance with custom configuration.\n *\n * @param config - Optional provider configuration\n * @returns OCI provider instance implementing ProviderV3\n *\n * @example\n * ```typescript\n * const provider = createOCI({\n *   region: 'eu-frankfurt-1',\n *   compartmentId: 'ocid1.compartment...',\n * });\n *\n * const model = provider.languageModel('cohere.command-r-plus');\n * ```\n */\nexport function createOCI(config: OCIConfig = {}): OCIGenAIProvider {\n  return new OCIGenAIProvider(config);\n}\n\n/**\n * Default OCI provider instance.\n * Uses environment variables or OCI config file for configuration.\n *\n * @example\n * ```typescript\n * import { oci } from '@acedergren/oci-genai-provider';\n *\n * const model = oci.languageModel('cohere.command-r-plus');\n * const embedding = oci.embeddingModel('cohere.embed-multilingual-v3.0'); // Coming soon\n * ```\n */\nexport const oci = createOCI();\n\n// ============================================================================\n// Type Exports\n// ============================================================================\n\nexport type {\n  OCIConfig,\n  OCIAuthMethod,\n  OCILanguageModelSettings,\n  OCIEmbeddingSettings,\n  OCISpeechSettings,\n  OCITranscriptionSettings,\n  OCIRerankingSettings,\n  OCIRealtimeSettings,\n  ModelMetadata,\n  RequestOptions,\n  OCIGenAIRegion,\n} from './types';\n\n// ============================================================================\n// Language Model Exports\n// ============================================================================\n\nexport { OCILanguageModel } from './language-models/OCILanguageModel';\nexport {\n  isValidModelId,\n  getModelMetadata,\n  getAllModels,\n  getModelsByFamily,\n  getModelsByRegion,\n  getCodingRecommendedModels,\n  isCodingSuitable,\n  supportsReasoning,\n  supportsVision,\n  getVisionModels,\n} from './language-models/registry';\n\n// ============================================================================\n// Embedding Model Exports\n// ============================================================================\n\nexport { OCIEmbeddingModel } from './embedding-models/OCIEmbeddingModel';\nexport {\n  getEmbeddingModelMetadata,\n  isValidEmbeddingModelId,\n  getAllEmbeddingModels,\n} from './embedding-models/registry';\nexport type { EmbeddingModelMetadata } from './embedding-models/registry';\n\n// ============================================================================\n// Transcription Model Exports\nexport { OCITranscriptionModel } from './transcription-models/OCITranscriptionModel';\nexport {\n  getTranscriptionModelMetadata,\n  isValidTranscriptionModelId,\n  getAllTranscriptionModels,\n  getSupportedLanguages,\n} from './transcription-models/registry';\nexport type {\n  TranscriptionModelMetadata,\n  SupportedLanguage,\n} from './transcription-models/registry';\n\n// Reranking Model Exports\n// ============================================================================\n\nexport { OCIRerankingModel } from './reranking-models/OCIRerankingModel';\nexport {\n  getRerankingModelMetadata,\n  isValidRerankingModelId,\n  getAllRerankingModels,\n} from './reranking-models/registry';\nexport type { RerankingModelMetadata } from './reranking-models/registry';\n\n// ============================================================================\n// Speech Model Exports (TTS)\n// ============================================================================\n\nexport { OCISpeechModel } from './speech-models/OCISpeechModel';\nexport {\n  getSpeechModelMetadata,\n  isValidSpeechModelId,\n  getAllSpeechModels,\n  getAllVoices,\n} from './speech-models/registry';\nexport type { SpeechModelMetadata } from './speech-models/registry';\n\n// ============================================================================\n// Error Exports\n// ============================================================================\n\nexport {\n  OCIGenAIError,\n  NetworkError,\n  RateLimitError,\n  AuthenticationError,\n  ModelNotFoundError,\n  isRetryableStatusCode,\n  handleOCIError,\n} from './shared/errors';\n\nexport type {\n  OCIGenAIErrorOptions,\n  NetworkErrorOptions,\n  RateLimitErrorOptions,\n  AuthenticationErrorOptions,\n} from './shared/errors';\n\n// ============================================================================\n// Utility Exports\n// ============================================================================\n\nexport { withRetry, withTimeout, TimeoutError, isRetryableError } from './shared/utils';\n\nexport type { RetryOptions } from './shared/utils';\n\n// ============================================================================\n// Validation Schema Exports\n// ============================================================================\n\nexport {\n  CompartmentIdSchema,\n  RegionSchema,\n  ConfigProfileSchema,\n  ServingModeSchema,\n  EndpointIdSchema,\n  OCIProviderSettingsSchema,\n  ModelIdSchema,\n  OCIChatModelIdSchema,\n  validateProviderSettings,\n  parseProviderSettings,\n  OCIProviderOptionsSchema,\n  parseProviderOptions,\n} from './shared/schemas';\n\nexport type {\n  OCIProviderSettingsInput,\n  OCIProviderSettingsValidated,\n  OCIChatModelId,\n  OCIProviderOptions,\n  OCIProviderOptionsInput,\n} from './shared/schemas';\n\n// ============================================================================\n// Realtime Transcription Exports (Streaming STT)\n// ============================================================================\n\nexport {\n  OCIRealtimeTranscription,\n  OCIRealtimeClient,\n  WebSocketAdapter,\n  WebSocketReadyState,\n} from './realtime';\n\nexport type {\n  // Settings\n  RealtimeAudioEncoding,\n  PartialResultStability,\n  RealtimeModelDomain,\n  RealtimePunctuation,\n  RealtimeModelType,\n  // Results\n  RealtimeTranscriptionResult,\n  TranscriptionToken,\n  // Events\n  RealtimeTranscriptionEvents,\n  RealtimeClientEvents,\n  AudioAckDetails,\n  // State\n  RealtimeConnectionState,\n  RealtimeSessionInfo,\n  // Errors\n  RealtimeErrorCode,\n  RealtimeError,\n} from './realtime';\n"]}